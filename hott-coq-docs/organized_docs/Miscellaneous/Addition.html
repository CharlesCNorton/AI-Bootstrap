<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Addition</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Addition</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span> <span class="id" title="var">HoTT.Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Spaces.No.Core</span> <span class="id" title="var">HoTT.Spaces.No.Negation</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">surreal_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1550"></a><h1 class="section">Addition of surreal numbers</h1>

<div class="paragraph"> </div>

 Addition requires the option sorts to be closed under finite sums. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">HasAddition</span> (<span class="id" title="var">S</span> : <span class="id" title="var">OptionSort</span>) :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">empty_options</span> : <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">Empty</span> <span class="id" title="var">Empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">sum_options</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> (<span class="id" title="var">L</span> + <span class="id" title="var">L'</span>) (<span class="id" title="var">R</span> + <span class="id" title="var">R'</span>)<br/>
&nbsp;&nbsp;}.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">empty_options</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">sum_options</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">hasaddition_maxsort</span> : <span class="id" title="var">HasAddition</span> <span class="id" title="var">MaxSort</span><br/>
&nbsp;&nbsp;:= { <span class="id" title="var">empty_options</span> := <span class="id" title="var">tt</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sum_options</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tt</span> }.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">hasaddition_ordsort</span> : <span class="id" title="var">HasAddition</span> <span class="id" title="var">OrdSort</span><br/>
&nbsp;&nbsp;:= { <span class="id" title="var">empty_options</span> := <span class="id" title="var">idmap</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">sum_options</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> =&gt; <span class="id" title="var">sum_ind</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> }.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">hasaddition_decsort</span> : <span class="id" title="var">HasAddition</span> <span class="id" title="var">DecSort</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">insort_decsort</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> [? ?] [? ?]; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Addition</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="var">Univalence</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Universe</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">S</span> : <span class="id" title="var">OptionSort@</span>{<span class="id" title="var">i</span>}} `{<span class="id" title="var">HasAddition</span> <span class="id" title="var">S</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">No</span> := <span class="id" title="var">GenNo</span> <span class="id" title="var">S</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Inner</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">L</span> <span class="id" title="var">R</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">Sx</span> : <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xL</span> : <span class="id" title="var">L</span> -&gt; <span class="id" title="var">No</span>) (<span class="id" title="var">xR</span> : <span class="id" title="var">R</span> -&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xcut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> : <span class="id" title="var">L</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>), <span class="id" title="var">xL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">xR</span> <span class="id" title="var">r</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">A</span> := {<span class="id" title="var">g</span> : <span class="id" title="var">No</span> -&gt; <span class="id" title="var">No</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>, <span class="id" title="var">x</span> &lt;= <span class="id" title="var">y</span> -&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span> &lt;= <span class="id" title="var">g</span> <span class="id" title="var">y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> -&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">g</span> <span class="id" title="var">y</span>)}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">xL_plus</span> : <span class="id" title="var">L</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">xR_plus</span> : <span class="id" title="var">R</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xL_lt_xR_plus</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> : <span class="id" title="var">L</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">No</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).1 <span class="id" title="var">x</span> &lt; (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).1 <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_inner</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: { <span class="id" title="var">g</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">y</span> : <span class="id" title="var">No</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">x_plus_y</span> : <span class="id" title="var">No</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, (<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).1 <span class="id" title="var">y</span> &lt; <span class="id" title="var">x_plus_y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>, <span class="id" title="var">x_plus_y</span> &lt; (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).1 <span class="id" title="var">y</span>) } &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">No</span>, <span class="id" title="var">y</span> &lt;= <span class="id" title="var">z</span> -&gt; (<span class="id" title="var">g</span> <span class="id" title="var">y</span>).1 &lt;= (<span class="id" title="var">g</span> <span class="id" title="var">z</span>).1) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">No</span>, <span class="id" title="var">y</span> &lt;  <span class="id" title="var">z</span> -&gt; (<span class="id" title="var">g</span> <span class="id" title="var">y</span>).1 &lt;  (<span class="id" title="var">g</span> <span class="id" title="var">z</span>).1) }.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">No_ind_package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; { <span class="id" title="var">x_plus_y</span> : <span class="id" title="var">No</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, (<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).1 <span class="id" title="var">y</span> &lt; <span class="id" title="var">x_plus_y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>, <span class="id" title="var">x_plus_y</span> &lt; (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).1 <span class="id" title="var">y</span>) })<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="var">z</span>.1 &lt;= <span class="id" title="var">w</span>.1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="var">z</span>.1 &lt; <span class="id" title="var">w</span>.1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">x_plus_yL</span> <span class="id" title="var">x_plus_yR</span> <span class="id" title="var">x_plus_yL_lt_yR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">L''</span> := <span class="id" title="var">L</span> + <span class="id" title="var">L'</span>). <span class="id" title="tactic">pose</span> (<span class="id" title="var">R''</span> := <span class="id" title="var">R</span> + <span class="id" title="var">R'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">zL</span> := <span class="id" title="var">sum_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; (<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).1 {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span> }})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; (<span class="id" title="var">x_plus_yL</span> <span class="id" title="var">l</span>).1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">L''</span> -&gt; <span class="id" title="var">No</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">zR</span> := <span class="id" title="var">sum_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).1 {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span> }})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; (<span class="id" title="var">x_plus_yR</span> <span class="id" title="var">r</span>).1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">R''</span> -&gt; <span class="id" title="var">No</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">zcut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>:<span class="id" title="var">L''</span>) (<span class="id" title="var">r</span>:<span class="id" title="var">R''</span>), <span class="id" title="var">zL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">zR</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">l</span>|<span class="id" title="var">l</span>] [<span class="id" title="var">r</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">apply</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">transitivity</span> ((<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).1 (<span class="id" title="var">yR</span> <span class="id" title="var">r</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).2), <span class="id" title="var">lt_ropt</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">exact</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">x_plus_yR</span> <span class="id" title="var">r</span>).2 <span class="id" title="var">l</span>) ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">transitivity</span> ((<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).1 (<span class="id" title="var">yL</span> <span class="id" title="var">l</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">exact</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">x_plus_yL</span> <span class="id" title="var">l</span>).2 <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).2), <span class="id" title="var">lt_lopt</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">apply</span> <span class="id" title="var">x_plus_yL_lt_yR</span> ]). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L''</span> <span class="id" title="var">R''</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">sum_options</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> ({{ <span class="id" title="var">zL</span> | <span class="id" title="var">zR</span> // <span class="id" title="var">zcut</span> }}); <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_lopt</span> <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> (<span class="id" title="var">inl</span> <span class="id" title="var">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_ropt</span> <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> (<span class="id" title="var">inl</span> <span class="id" title="var">r</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> [<span class="id" title="var">a</span> ?] [<span class="id" title="var">b</span> ?] <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_sigma</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_sigma_hprop</span>, <span class="id" title="var">path_No</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_const</span>; <span class="id" title="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">x_plus_yL</span> <span class="id" title="var">x_plus_yR</span> <span class="id" title="var">x_plus_yL_lt_yR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">L''</span> <span class="id" title="var">R''</span> ? <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> <span class="id" title="var">x_plus_zL</span> <span class="id" title="var">x_plus_zR</span> <span class="id" title="var">x_plus_zL_lt_zR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">yL_lt_z</span> <span class="id" title="var">x_plus_yL_lt_z</span> <span class="id" title="var">y_lt_zR</span> <span class="id" title="var">x_plus_y_lt_zR</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lr</span>; [ <span class="id" title="tactic">intros</span> [<span class="id" title="var">l</span>|<span class="id" title="var">l</span>] | <span class="id" title="tactic">intros</span> [<span class="id" title="var">r</span>|<span class="id" title="var">r</span>] ]; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">refine</span> (<span class="id" title="var">le_lt_trans</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).2 <span class="id" title="var">_</span> {{ <span class="id" title="var">zL</span> | <span class="id" title="var">zR</span> // <span class="id" title="var">zcut</span>}} <span class="id" title="var">_</span>) <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lr</span>; <span class="id" title="tactic">assumption</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_lopt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">inl</span> <span class="id" title="var">l</span>)) ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">exact</span> (<span class="id" title="var">x_plus_yL_lt_z</span> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_le_trans</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fst</span> (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).2 {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span>}} <span class="id" title="var">_</span> <span class="id" title="var">_</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_ropt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">inl</span> <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lr</span>; <span class="id" title="tactic">assumption</span>) ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">exact</span> (<span class="id" title="var">x_plus_y_lt_zR</span> <span class="id" title="var">r</span>) ] ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">x_plus_yL</span> <span class="id" title="var">x_plus_yR</span> <span class="id" title="var">x_plus_yL_lt_yR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">L''</span> <span class="id" title="var">R''</span> ? <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> <span class="id" title="var">x_plus_zL</span> <span class="id" title="var">x_plus_zR</span> <span class="id" title="var">x_plus_zL_lt_zR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">l</span> <span class="id" title="var">y_le_zL</span> <span class="id" title="var">x_plus_y_le_zL</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">inr</span> <span class="id" title="var">l</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">x_plus_y_le_zL</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">x_plus_yL</span> <span class="id" title="var">x_plus_yR</span> <span class="id" title="var">x_plus_yL_lt_yR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">L''</span> <span class="id" title="var">R''</span> ? <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> <span class="id" title="var">x_plus_zL</span> <span class="id" title="var">x_plus_zR</span> <span class="id" title="var">x_plus_zL_lt_zR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">r</span> <span class="id" title="var">yR_le_z</span> <span class="id" title="var">x_plus_yR_le_z</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_r</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">inr</span> <span class="id" title="var">r</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">x_plus_yR_le_z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We now prove a computation law for <span class="inlinecode"><span class="id" title="var">plus_inner</span></span>.  It holds definitionally, so we would like to prove it with just <span class="inlinecode">:=</span> <span class="inlinecode">1</span> and then rewrite along it later, as we did above.  However, there is a subtlety in that the output should be a surreal defined by a cut, which in particular includes a proof of cut-ness, and that proof is rather long, so we would not like to see it in the type of this lemma.  Thus, instead we assert only that there *exists* some proof of cut-ness and an equality. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_inner_cut</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">L'</span> <span class="id" title="var">R'</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">Sy</span> : <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">yL</span> : <span class="id" title="var">L'</span> -&gt; <span class="id" title="var">No</span>) (<span class="id" title="var">yR</span> : <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ycut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> : <span class="id" title="var">L'</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R'</span>), <span class="id" title="var">yL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">yR</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">let</span> <span class="id" title="var">L''</span> := <span class="id" title="var">L</span> + <span class="id" title="var">L'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">R''</span> := <span class="id" title="var">R</span> + <span class="id" title="var">R'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">zL</span> := <span class="id" title="var">sum_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; (<span class="id" title="var">xL_plus</span> <span class="id" title="var">l</span>).1 {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span> }})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; (<span class="id" title="var">plus_inner</span>.1 (<span class="id" title="var">yL</span> <span class="id" title="var">l</span>)).1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">L''</span> -&gt; <span class="id" title="var">No</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">zR</span> := <span class="id" title="var">sum_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; (<span class="id" title="var">xR_plus</span> <span class="id" title="var">r</span>).1 {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span> }})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; (<span class="id" title="var">plus_inner</span>.1 (<span class="id" title="var">yR</span> <span class="id" title="var">r</span>)).1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">R''</span> -&gt; <span class="id" title="var">No</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Sz</span> := <span class="id" title="var">sum_options</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">zcut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>:<span class="id" title="var">L''</span>) (<span class="id" title="var">r</span>:<span class="id" title="var">R''</span>), <span class="id" title="var">zL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">zR</span> <span class="id" title="var">r</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">plus_inner</span>.1 {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span> }}).1 = (@<span class="id" title="var">No_cut</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Sz</span> <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) }.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
</div>

<div class="doc">
Now we tell Coq that we want the equality to be definitional, and let it figure out what the proof of cut-ness has to be. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
</div>

<div class="doc">
Adding <span class="inlinecode"><span class="id" title="var">rel_hnf</span></span> here speeds things up considerably, possibly because it puts the terms in a form where the evar can be instantiated without unfolding or reduction, preventing backtracking across the evar instantiation. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rel_hnf</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Inner</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_outer</span><br/>
&nbsp;&nbsp;: { <span class="id" title="var">f</span> : <span class="id" title="var">No</span> -&gt; { <span class="id" title="var">g</span> : <span class="id" title="var">No</span> -&gt; <span class="id" title="var">No</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt;= <span class="id" title="var">y</span> -&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span> &lt;= <span class="id" title="var">g</span> <span class="id" title="var">y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt;  <span class="id" title="var">y</span> -&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span> &lt;  <span class="id" title="var">g</span> <span class="id" title="var">y</span>) } &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt;= <span class="id" title="var">y</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>, (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).1 <span class="id" title="var">z</span> &lt;= (<span class="id" title="var">f</span> <span class="id" title="var">y</span>).1 <span class="id" title="var">z</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt;  <span class="id" title="var">y</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>, (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).1 <span class="id" title="var">z</span> &lt;  (<span class="id" title="var">f</span> <span class="id" title="var">y</span>).1 <span class="id" title="var">z</span>) }.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">No_rec_package</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">g</span> : <span class="id" title="var">No</span> -&gt; <span class="id" title="var">No</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt;= <span class="id" title="var">y</span> -&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span> &lt;= <span class="id" title="var">g</span> <span class="id" title="var">y</span>) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt;  <span class="id" title="var">y</span> -&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span> &lt;  <span class="id" title="var">g</span> <span class="id" title="var">y</span>) }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">g</span>.1 <span class="id" title="var">x</span> &lt;= <span class="id" title="var">h</span>.1 <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">g</span>.1 <span class="id" title="var">x</span> &lt;  <span class="id" title="var">h</span>.1 <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> <span class="id" title="var">Sx</span> <span class="id" title="var">xL</span> <span class="id" title="var">xR</span> <span class="id" title="var">xcut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">g</span> := <span class="id" title="var">plus_inner</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; (<span class="id" title="var">g</span>.1 <span class="id" title="var">y</span>).1) ; (<span class="id" title="var">g</span>.2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">g</span> ?] [<span class="id" title="var">h</span> ?] <span class="id" title="var">p</span> <span class="id" title="var">q</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_sigma_hprop</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_arrow</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_No</span>; [ <span class="id" title="tactic">apply</span> <span class="id" title="var">p</span> | <span class="id" title="tactic">apply</span> <span class="id" title="var">q</span> ] ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> ? <span class="id" title="var">xL</span> <span class="id" title="var">xR</span> <span class="id" title="var">xcut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">yL_plus</span> <span class="id" title="var">yR_plus</span> <span class="id" title="var">yL_lt_yR_plus</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">xL_lt_y</span> <span class="id" title="var">xL_lt_y_plus</span> <span class="id" title="var">x_lt_yR</span> <span class="id" title="var">x_lt_yR_plus</span> <span class="id" title="var">z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">lazy</span> <span class="id" title="keyword">beta</span> <span class="id" title="keyword">zeta</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> [<span class="id" title="var">pr1</span>] <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">No_ind_hprop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L''</span> <span class="id" title="var">R''</span> ? <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> <span class="id" title="var">x_le_y_plus_zL</span> <span class="id" title="var">x_le_y_plus_zR</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_inner_cut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">xzcut</span> <span class="id" title="var">p</span>]; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_inner_cut</span> <span class="id" title="var">yL_plus</span> <span class="id" title="var">yR_plus</span> <span class="id" title="var">yL_lt_yR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">yzcut</span> <span class="id" title="var">q</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lr</span>; [ <span class="id" title="tactic">intros</span> [<span class="id" title="var">l</span>|<span class="id" title="var">l</span>] | <span class="id" title="tactic">intros</span> [<span class="id" title="var">r</span>|<span class="id" title="var">r</span>] ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ </div>

<div class="doc">
x^L + z &lt; y + z 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">xL_lt_y_plus</span> <span class="id" title="var">l</span> {{ <span class="id" title="var">zL</span> | <span class="id" title="var">zR</span> // <span class="id" title="var">zcut</span> }});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xL_lt_y_plus</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">xL_lt_y_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| </div>

<div class="doc">
x + z^L &lt; y + z 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">le_lt_trans</span> (<span class="id" title="var">x_le_y_plus_zL</span> <span class="id" title="var">l</span>) <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_lopt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">inr</span> <span class="id" title="var">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| </div>

<div class="doc">
x + z &lt; y^R + z 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">x_lt_yR_plus</span> <span class="id" title="var">r</span> {{ <span class="id" title="var">zL</span> | <span class="id" title="var">zR</span> // <span class="id" title="var">zcut</span> }});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> <span class="id" title="var">x_lt_yR_plus</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">x_lt_yR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| </div>

<div class="doc">
x + z &lt; y + z^R 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_le_trans</span> <span class="id" title="var">_</span> (<span class="id" title="var">x_le_y_plus_zR</span> <span class="id" title="var">r</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_ropt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">inr</span> <span class="id" title="var">r</span>)) ]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> ? <span class="id" title="var">xL</span> <span class="id" title="var">xR</span> <span class="id" title="var">xcut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">yL_plus</span> <span class="id" title="var">yR_plus</span> <span class="id" title="var">yL_lt_yR_plus</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">x_le_yL</span> <span class="id" title="var">x_le_yL_plus</span> <span class="id" title="var">z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">lazy</span> <span class="id" title="keyword">beta</span> <span class="id" title="keyword">zeta</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> [<span class="id" title="var">pr1</span>] <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">No_ind_hprop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L''</span> <span class="id" title="var">R''</span> ? <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> <span class="id" title="var">x_le_y_plus_zL</span> <span class="id" title="var">x_le_y_plus_zR</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_inner_cut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">xzcut</span> <span class="id" title="var">p</span>]; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_inner_cut</span> <span class="id" title="var">yL_plus</span> <span class="id" title="var">yR_plus</span> <span class="id" title="var">yL_lt_yR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">yzcut</span> <span class="id" title="var">q</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">le_lt_trans</span> (<span class="id" title="var">x_le_yL_plus</span> {{ <span class="id" title="var">zL</span> | <span class="id" title="var">zR</span> // <span class="id" title="var">zcut</span> }}) <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_lopt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">inl</span> <span class="id" title="var">l</span>)) ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">abstract</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> ? <span class="id" title="var">xL</span> <span class="id" title="var">xR</span> <span class="id" title="var">xcut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">L'</span> <span class="id" title="var">R'</span> ? <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span> <span class="id" title="var">yL_plus</span> <span class="id" title="var">yR_plus</span> <span class="id" title="var">yL_lt_yR_plus</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">xR_le_y</span> <span class="id" title="var">xR_le_y_plus</span> <span class="id" title="var">z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">lazy</span> <span class="id" title="keyword">beta</span> <span class="id" title="keyword">zeta</span> <span class="id" title="tactic">in</span> *; <span class="id" title="var">cbn</span> [<span class="id" title="var">pr1</span>] <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">No_ind_hprop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">L''</span> <span class="id" title="var">R''</span> ? <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> <span class="id" title="var">x_le_y_plus_zL</span> <span class="id" title="var">x_le_y_plus_zR</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_inner_cut</span> <span class="id" title="var">xL_plus</span> <span class="id" title="var">xR_plus</span> <span class="id" title="var">xL_lt_xR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">xzcut</span> <span class="id" title="var">p</span>]; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_inner_cut</span> <span class="id" title="var">yL_plus</span> <span class="id" title="var">yR_plus</span> <span class="id" title="var">yL_lt_yR_plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">yzcut</span> <span class="id" title="var">q</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">q</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_le_trans</span> <span class="id" title="var">_</span> (<span class="id" title="var">xR_le_y_plus</span> {{ <span class="id" title="var">zL</span> | <span class="id" title="var">zR</span> // <span class="id" title="var">zcut</span> }}));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_ropt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">inl</span> <span class="id" title="var">r</span>)) ).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>) : <span class="id" title="var">No</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= (<span class="id" title="var">plus_outer</span>.1 <span class="id" title="var">x</span>).1 <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Infix</span> &quot;+" := <span class="id" title="var">plus</span> : <span class="id" title="var">surreal_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_le_l</span> (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> &lt;= <span class="id" title="var">x'</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>) &lt;= (<span class="id" title="var">x'</span> + <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">fst</span> (<span class="id" title="var">plus_outer</span>.2) <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">p</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_lt_l</span> (<span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> &lt; <span class="id" title="var">x'</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>) &lt; (<span class="id" title="var">x'</span> + <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">snd</span> (<span class="id" title="var">plus_outer</span>.2) <span class="id" title="var">x</span> <span class="id" title="var">x'</span> <span class="id" title="var">p</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_le_r</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> : <span class="id" title="var">No</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">y</span> &lt;= <span class="id" title="var">y'</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>) &lt;= (<span class="id" title="var">x</span> + <span class="id" title="var">y'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">fst</span> (<span class="id" title="var">plus_outer</span>.1 <span class="id" title="var">x</span>).2 <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="var">p</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_lt_r</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">y'</span> : <span class="id" title="var">No</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">y</span> &lt; <span class="id" title="var">y'</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>) &lt; (<span class="id" title="var">x</span> + <span class="id" title="var">y'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">snd</span> (<span class="id" title="var">plus_outer</span>.1 <span class="id" title="var">x</span>).2 <span class="id" title="var">y</span> <span class="id" title="var">y'</span> <span class="id" title="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
See the remarks above <span class="inlinecode"><span class="id" title="var">plus_inner_cut</span></span> to explain the type of this lemma. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_cut</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">L</span> <span class="id" title="var">R</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">Sx</span> : <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xL</span> : <span class="id" title="var">L</span> -&gt; <span class="id" title="var">No</span>) (<span class="id" title="var">xR</span> : <span class="id" title="var">R</span> -&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xcut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> : <span class="id" title="var">L</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>), <span class="id" title="var">xL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">xR</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">L'</span> <span class="id" title="var">R'</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">Sy</span> : <span class="id" title="var">InSort</span> <span class="id" title="var">S</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">yL</span> : <span class="id" title="var">L'</span> -&gt; <span class="id" title="var">No</span>) (<span class="id" title="var">yR</span> : <span class="id" title="var">R'</span> -&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ycut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> : <span class="id" title="var">L'</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R'</span>), <span class="id" title="var">yL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">yR</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">let</span> <span class="id" title="var">L''</span> := (<span class="id" title="var">L</span> + <span class="id" title="var">L'</span>)%<span class="id" title="keyword">type</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">R''</span> := (<span class="id" title="var">R</span> + <span class="id" title="var">R'</span>)%<span class="id" title="keyword">type</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := {{ <span class="id" title="var">xL</span> | <span class="id" title="var">xR</span> // <span class="id" title="var">xcut</span> }} <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">y</span> := {{ <span class="id" title="var">yL</span> | <span class="id" title="var">yR</span> // <span class="id" title="var">ycut</span> }} <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">zL</span> := <span class="id" title="var">sum_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; (<span class="id" title="var">xL</span> <span class="id" title="var">l</span>) + <span class="id" title="var">y</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">x</span> + (<span class="id" title="var">yL</span> <span class="id" title="var">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">L''</span> -&gt; <span class="id" title="var">No</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">zR</span> := <span class="id" title="var">sum_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">No</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; (<span class="id" title="var">xR</span> <span class="id" title="var">r</span>) + <span class="id" title="var">y</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">x</span> + (<span class="id" title="var">yR</span> <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">R''</span> -&gt; <span class="id" title="var">No</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Sz</span> := <span class="id" title="var">sum_options</span> <span class="id" title="var">L</span> <span class="id" title="var">R</span> <span class="id" title="var">L'</span> <span class="id" title="var">R'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">zcut</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>:<span class="id" title="var">L''</span>) (<span class="id" title="var">r</span>:<span class="id" title="var">R''</span>), <span class="id" title="var">zL</span> <span class="id" title="var">l</span> &lt; <span class="id" title="var">zR</span> <span class="id" title="var">r</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> + <span class="id" title="var">y</span> = @<span class="id" title="var">No_cut</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Sz</span> <span class="id" title="var">zL</span> <span class="id" title="var">zR</span> <span class="id" title="var">zcut</span> }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">plus_inner_cut</span> (<span class="id" title="var">Sx</span> := <span class="id" title="var">Sx</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">plus_outer</span>.1 (<span class="id" title="var">xL</span> <span class="id" title="var">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">plus_outer</span>.1 (<span class="id" title="var">xR</span> <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">snd</span> <span class="id" title="var">plus_outer</span>.2 (<span class="id" title="var">xL</span> <span class="id" title="var">l</span>) (<span class="id" title="var">xR</span> <span class="id" title="var">r</span>) (<span class="id" title="var">xcut</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span>.<br/>

<br/>
</div>

<div class="doc">
Because the conclusion of <span class="inlinecode"><span class="id" title="var">plus_cut</span></span> is a sigma-type whose second component is the real equality we want to rewrite along, in order to rewrite along it we have to first destruct it.  This tactic takes care of that for us. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Ltac</span> <span class="id" title="var">do_plus_cut</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span> <span class="id" title="var">ctx</span> [ {{ ?<span class="id" title="var">xL</span> | ?<span class="id" title="var">xR</span> // ?<span class="id" title="var">xcut</span> }} + {{ ?<span class="id" title="var">yL</span> | ?<span class="id" title="var">yR</span> // ?<span class="id" title="var">ycut</span> }} ] ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">xycut</span> := <span class="id" title="tactic">fresh</span> "cut" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">p</span> := <span class="id" title="tactic">fresh</span> "p" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">plus_cut</span> <span class="id" title="var">xL</span> <span class="id" title="var">xR</span> <span class="id" title="var">xcut</span> <span class="id" title="var">yL</span> <span class="id" title="var">yR</span> <span class="id" title="var">ycut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">xycut</span> <span class="id" title="var">p</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Conway proves the basic properties of arithmetic using "one-line proofs".  We can't quite do them in one line of Ltac, but the following tactic does help a lot.  Note that it is specific to addition.  It requires the caller to specify the equivalences along which to identify the indexing types for the options, as well as a rewriting tactic for evaluating those equivalences on constructors.  Unfortunately, it doesn't usually manage to finish the whole proof, since in general it can't guess how to use the inductive hypotheses.  It's usually fairly easy to finish all the cases it leaves over, but we do generally have to refer by name to the inductive hypotheses that were automatically named by <span class="inlinecode"><span class="id" title="tactic">intros</span></span> here.  I haven't thought of a good solution to that. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Opaque</span> <span class="id" title="var">No_cut</span> <span class="id" title="var">plus</span>. <span class="comment">(*&nbsp;required&nbsp;to&nbsp;make&nbsp;<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>&nbsp;fail&nbsp;quickly&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Unset</span> <span class="id" title="var">Keyed</span> <span class="id" title="var">Unification</span>. <span class="comment">(*&nbsp;shaves&nbsp;another&nbsp;second&nbsp;or&nbsp;two&nbsp;off&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Tactic Notation</span> "one_line_proof" <span class="id" title="var">uconstr</span>(<span class="id" title="var">eL</span>) <span class="id" title="var">uconstr</span>(<span class="id" title="var">eR</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">No</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">repeat_No_ind_hprop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">do_plus_cut</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">path_No_easy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">eL</span> <span class="id" title="var">eR</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : (?<span class="id" title="var">A</span> + ?<span class="id" title="var">B</span>) |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="keyword">context</span>[@<span class="id" title="var">equiv_fun</span> ?<span class="id" title="var">A</span> ?<span class="id" title="var">B</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">v</span>] ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="comment">(*&nbsp;first&nbsp;check&nbsp;that&nbsp;we&nbsp;picked&nbsp;up&nbsp;either&nbsp;<span class="inlinecode"><span class="id" title="var">eL</span></span>&nbsp;or&nbsp;<span class="inlinecode"><span class="id" title="var">eR</span></span>;&nbsp;we&nbsp;can't&nbsp;use&nbsp;<span class="inlinecode"><span class="id" title="var">unify</span></span>&nbsp;because&nbsp;it&nbsp;doesn't&nbsp;infer&nbsp;holes,&nbsp;and&nbsp;we&nbsp;can't&nbsp;Ltac-match&nbsp;on&nbsp;<span class="inlinecode"><span class="id" title="var">eL</span></span>&nbsp;/&nbsp;<span class="inlinecode"><span class="id" title="var">eR</span></span>&nbsp;because&nbsp;apparently&nbsp;matching&nbsp;on&nbsp;uconstr&nbsp;doesn't&nbsp;work&nbsp;when&nbsp;there&nbsp;are&nbsp;holes&nbsp;in&nbsp;the&nbsp;uconstr&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> [ <span class="id" title="keyword">let</span> <span class="id" title="var">unif</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="var">idpath</span> : <span class="id" title="var">e</span> = <span class="id" title="var">eL</span>) <span class="id" title="tactic">in</span> <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">let</span> <span class="id" title="var">unif</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="var">idpath</span> : <span class="id" title="var">e</span> = <span class="id" title="var">eR</span>) <span class="id" title="tactic">in</span> <span class="id" title="tactic">idtac</span> ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;assume&nbsp;that&nbsp;the&nbsp;term&nbsp;reduces&nbsp;to&nbsp;a&nbsp;constructor;&nbsp;use&nbsp;<span class="inlinecode"><span class="id" title="tactic">hnf</span></span>&nbsp;to&nbsp;get&nbsp;that&nbsp;constructor&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ef</span> := <span class="id" title="keyword">constr</span>:(@<span class="id" title="var">equiv_fun</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">e</span> <span class="id" title="var">v</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ef'</span> := (<span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ef</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">progress</span> <span class="id" title="tactic">change</span> <span class="id" title="var">ef</span> <span class="id" title="keyword">with</span> <span class="id" title="var">ef'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">cbn</span> [<span class="id" title="var">sum_ind</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;rewrite&nbsp;with&nbsp;induction&nbsp;hypotheses&nbsp;from&nbsp;<span class="inlinecode"><span class="id" title="var">repeat_No_ind_hprop</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">do_plus_cut</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" title="var">x</span> = ?<span class="id" title="var">x</span> ] =&gt; <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- ?<span class="id" title="var">a</span> + <span class="id" title="var">_</span> = ?<span class="id" title="var">a</span> + <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ |- <span class="id" title="var">_</span> + ?<span class="id" title="var">a</span> = <span class="id" title="var">_</span> + ?<span class="id" title="var">a</span> ] =&gt; <span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> + <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">e</span> : <span class="id" title="var">Empty</span> |- <span class="id" title="var">_</span> ] =&gt; <span class="id" title="tactic">elim</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">IH</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">lr</span>, <span class="id" title="var">_</span> + <span class="id" title="var">_</span> = <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">IH</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">lr</span>, <span class="id" title="var">_</span> + <span class="id" title="var">_</span> = <span class="id" title="var">_</span> + <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="tactic">first</span> [ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> | <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span> ]; <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">IH</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">lr</span> (<span class="id" title="var">y</span> : <span class="id" title="var">GenNo</span> <span class="id" title="var">_</span>), <span class="id" title="var">_</span> + <span class="id" title="var">_</span> = <span class="id" title="var">_</span> + <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="tactic">first</span> [ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> | <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span> ]; <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" title="var">IH</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">lr</span> (<span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">GenNo</span> <span class="id" title="var">_</span>), <span class="id" title="var">_</span> + <span class="id" title="var">_</span> = <span class="id" title="var">_</span> + <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="tactic">first</span> [ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span> | <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IH</span> ]; <span class="id" title="tactic">clear</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
At last we are ready to prove that the surreal numbers are a commutative monoid under addition. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_comm</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>) : <span class="id" title="var">x</span> + <span class="id" title="var">y</span> = <span class="id" title="var">y</span> + <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">one_line_proof</span> (<span class="id" title="var">equiv_sum_symm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">equiv_sum_symm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_assoc</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">No</span>) : (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>) + <span class="id" title="var">z</span> = <span class="id" title="var">x</span> + (<span class="id" title="var">y</span> + <span class="id" title="var">z</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">one_line_proof</span> (<span class="id" title="var">equiv_sum_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) (<span class="id" title="var">equiv_sum_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">one_line_proof</span> 1%<span class="id" title="var">equiv</span> 1%<span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_zero</span> (<span class="id" title="var">x</span> : <span class="id" title="var">No</span>) : <span class="id" title="var">x</span> + <span class="id" title="var">zero</span> = <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">one_line_proof</span> (<span class="id" title="var">sum_empty_r</span> <span class="id" title="var">_</span>) (<span class="id" title="var">sum_empty_r</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">zero_plus</span> (<span class="id" title="var">x</span> : <span class="id" title="var">No</span>) : <span class="id" title="var">zero</span> + <span class="id" title="var">x</span> = <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">zero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">one_line_proof</span> (<span class="id" title="var">sum_empty_l</span> <span class="id" title="var">_</span>) (<span class="id" title="var">sum_empty_l</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If we also have negation, we can prove that it gives additive inverses, so that we have an abelian group. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="var">HasNegation</span> <span class="id" title="var">S</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">plus_negate</span> (<span class="id" title="var">x</span> : <span class="id" title="var">No</span>) : <span class="id" title="var">x</span> + <span class="id" title="var">negate</span> <span class="id" title="var">x</span> = <span class="id" title="var">zero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">No</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">repeat_No_ind_hprop</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">negate_cut</span> <span class="id" title="var">xL</span> <span class="id" title="var">xR</span> <span class="id" title="var">xcut</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">nxcut</span> <span class="id" title="var">p</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">do_plus_cut</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_No</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">le_lr</span>; [ <span class="id" title="tactic">intros</span> [<span class="id" title="var">l</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span> [<span class="id" title="var">sum_ind</span>] | <span class="id" title="tactic">intros</span> [] ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHL</span>; <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">IHL</span> <span class="id" title="var">l</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IHL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_lt_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_ropt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHR</span>; <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">IHR</span> <span class="id" title="var">r</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IHR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_lt_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_ropt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">le_lr</span>; [ <span class="id" title="tactic">intros</span> [] | <span class="id" title="tactic">intros</span> [<span class="id" title="var">r</span>|<span class="id" title="var">l</span>] ]; <span class="id" title="var">cbn</span> [<span class="id" title="var">sum_ind</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHR</span>; <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">IHR</span> <span class="id" title="var">r</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IHR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_lt_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_lopt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <span class="id" title="var">zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHL</span>; <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">IHL</span> <span class="id" title="var">l</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">IHL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_lt_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">lt_lopt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">sub</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">No</span>) : <span class="id" title="var">No</span> := <span class="id" title="var">x</span> + (<span class="id" title="var">negate</span> <span class="id" title="var">y</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Infix</span> &quot;-" := <span class="id" title="var">sub</span> : <span class="id" title="var">surreal_scope</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Addition</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>