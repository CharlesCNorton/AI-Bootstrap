<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>LoopExp</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library LoopExp</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Basics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Types.Universe</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.Pos</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.BinInt.Core</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.BinInt.Spec</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.BinInt.Equiv</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">positive_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">binint_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1404"></a><h2 class="section">Exponentiation of loops</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loopexp_pos</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">Pos</span>) : (<span class="id" title="var">x</span> = <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">pos_peano_ind</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">q</span> @ <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loopexp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">BinInt</span>) : (<span class="id" title="var">x</span> = <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">match</span> <span class="id" title="var">z</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">neg</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">zero</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pos</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
TODO: One can also define <span class="inlinecode"><span class="id" title="var">loopexp</span></span> as <span class="inlinecode"><span class="id" title="var">int_iter</span></span> <span class="inlinecode">(<span class="id" title="var">equiv_concat_r</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode"><span class="id" title="var">z</span></span> <span class="inlinecode"><span class="id" title="var">idpath</span></span>.  This has slightly different computational behaviour, e.g., it sends <span class="inlinecode">1</span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">int</span></span> to <span class="inlinecode">1</span> <span class="inlinecode">@</span> <span class="inlinecode"><span class="id" title="var">p</span></span> rather than <span class="inlinecode"><span class="id" title="var">p</span></span>.  But with this definition, some of the results below become special cases of results in BinInt.Equiv, and others could be generalized to results belonging in BinInt.Equiv.  It's probably worth investigating this. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loopexp_pos_inv</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">Pos</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">n</span> = (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span>)^.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">pos_peano_ind</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>, <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">inv_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">pos_peano_ind</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>, <span class="id" title="var">concat_p_pp</span>, <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ap_loopexp_pos</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">Pos</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span>) = <span class="id" title="var">loopexp_pos</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">pos_peano_ind</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_pp</span>, <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ap_loopexp</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">BinInt</span>)<br/>
: <span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> <span class="id" title="var">z</span>) = <span class="id" title="var">loopexp</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span>| |<span class="id" title="var">n</span>]; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">loopexp_pos_inv</span>, <span class="id" title="var">ap_V</span>, <span class="id" title="var">loopexp_pos_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap_loopexp_pos</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ap_loopexp_pos</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loopexp_pos_concat</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">Pos</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span> = <span class="id" title="var">p</span> @ <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">aH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span>) @ <span class="id" title="var">p</span> = <span class="id" title="var">p</span> @ (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_pp</span>, <span class="id" title="var">aH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loopexp_pos_add</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">Pos</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>)%<span class="id" title="var">pos</span> = <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">aH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">bH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_add_1_l</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> (<span class="id" title="var">pos_succ</span> <span class="id" title="var">b</span>) @ <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">p</span> @ <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> (<span class="id" title="var">pos_succ</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">bH</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>, <span class="id" title="var">loopexp_pos_concat</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_add_1_r</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_add_succ_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> (<span class="id" title="var">a</span> + <span class="id" title="var">pos_succ</span> <span class="id" title="var">b</span>)%<span class="id" title="var">pos</span> @ <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span>) @ <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> (<span class="id" title="var">pos_succ</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">aH</span>, 2 <span class="id" title="var">concat_pp_p</span>, <span class="id" title="var">loopexp_pos_concat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loopexp_binint_pos_sub_l</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">Pos</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> (<span class="id" title="var">binint_pos_sub</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) = <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">b</span> @ <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">aH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">bH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_Vp</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">binint_pos_sub_succ_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>, <span class="id" title="var">concat_Vp</span>, <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">binint_pos_sub_succ_l</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">loopexp_pos_concat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_pp</span>, <span class="id" title="var">concat_Vp</span>, <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">binint_pos_sub_succ_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">b</span> @ <span class="id" title="var">p</span>^) @ (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> (<span class="id" title="var">binint_pos_sub</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">loopexp_pos_concat</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>, (<span class="id" title="var">concat_p_pp</span> <span class="id" title="var">p</span>^ <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_Vp</span>, <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">aH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loopexp_binint_pos_sub_r</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">Pos</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> (<span class="id" title="var">binint_pos_sub</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) = <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">aH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">bH</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_pV</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">binint_pos_sub_succ_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">p</span> @ (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">b</span> @ <span class="id" title="var">p</span>^) = <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> (<span class="id" title="var">neg</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">loopexp_pos_concat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_pp</span>, <span class="id" title="var">concat_pV</span>, <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">binint_pos_sub_succ_l</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span>) @ <span class="id" title="var">p</span>^ = <span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>, <span class="id" title="var">concat_pV</span>, <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">binint_pos_sub_succ_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> ((<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">p</span>) @ (<span class="id" title="var">loopexp_pos</span> <span class="id" title="var">p</span>^ <span class="id" title="var">b</span> @ <span class="id" title="var">p</span>^)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> (<span class="id" title="var">binint_pos_sub</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">loopexp_pos_concat</span> <span class="id" title="var">p</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>, (<span class="id" title="var">concat_p_pp</span> <span class="id" title="var">p</span> <span class="id" title="var">p</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pV</span>, <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">aH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loopexp_add</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) <span class="id" title="var">a</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) = <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span> @ <span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span>| |<span class="id" title="var">a</span>], <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span>| |<span class="id" title="var">b</span>]; <span class="id" title="tactic">trivial</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">loopexp_pos_add</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;1,6: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;2,3: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">loopexp_binint_pos_sub_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">loopexp_binint_pos_sub_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Under univalence, exponentiation of loops corresponds to iteration of autoequivalences. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_loopexp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">A</span> = <span class="id" title="var">A</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">BinInt</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">equiv_path</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span> (<span class="id" title="var">loopexp</span> <span class="id" title="var">p</span> <span class="id" title="var">z</span>) <span class="id" title="var">a</span> = <span class="id" title="var">binint_iter</span> (<span class="id" title="var">equiv_path</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span> <span class="id" title="var">p</span>) <span class="id" title="var">z</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span>| |<span class="id" title="var">n</span>]; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">using</span> <span class="id" title="var">pos_peano_ind</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">unfold</span> <span class="id" title="var">loopexp_pos</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_ind_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">unfold</span> <span class="id" title="var">pos_iter</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_peano_rec_beta_pos_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">refine</span> (<span class="id" title="var">transport_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loopexp_path_universe</span> `{<span class="id" title="var">Univalence</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> &lt;~&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">BinInt</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">transport</span> <span class="id" title="var">idmap</span> (<span class="id" title="var">loopexp</span> (<span class="id" title="var">path_universe</span> <span class="id" title="var">f</span>) <span class="id" title="var">z</span>) <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;= <span class="id" title="var">binint_iter</span> <span class="id" title="var">f</span> <span class="id" title="var">z</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">f</span>. <span class="id" title="var">equiv_intro</span> (<span class="id" title="var">equiv_path</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span>) <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">equiv_path_loopexp</span> <span class="id" title="var">p</span> <span class="id" title="var">z</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> =&gt; <span class="id" title="var">equiv_path</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span> (<span class="id" title="var">loopexp</span> <span class="id" title="var">q</span> <span class="id" title="var">z</span>) <span class="id" title="var">a</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eissect</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>