<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>premetric</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library premetric</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.abstract_algebra</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.rationals</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.orders</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.implementations.peano_naturals</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.implementations.natpair_integers</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.groups</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.integers</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.dec_fields</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.orders.dec_fields</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.orders.sum</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.rationals</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.orders.lattices</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.implementations.assume_rationals</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.tactics.ring_quote</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.tactics.ring_tac</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">NatPair.Instances</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Quoting.Instances</span>.<br/>
<span class="id" title="keyword">Generalizable Variables</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Minimization</span> <span class="id" title="var">ToSet</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Closeness@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) := <span class="id" title="var">close</span> : <span class="id" title="var">Q</span>+ -&gt; <span class="id" title="var">Relation@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Q_close@</span>{} : <span class="id" title="var">Closeness</span> <span class="id" title="var">Q</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> =&gt; - ' <span class="id" title="var">e</span> &lt; <span class="id" title="var">q</span> - <span class="id" title="var">r</span> &lt; ' <span class="id" title="var">e</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Separated</span> <span class="id" title="var">A</span> `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">separated</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, (<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) -&gt; <span class="id" title="var">x</span> = <span class="id" title="var">y</span> :&gt; <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Triangular</span> <span class="id" title="var">A</span> `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">triangular</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt; <span class="id" title="var">close</span> <span class="id" title="var">d</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">close</span> (<span class="id" title="var">e</span>+<span class="id" title="var">d</span>) <span class="id" title="var">u</span> <span class="id" title="var">w</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Rounded@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} (<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">rounded</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>, <span class="id" title="var">iff@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span>} (<span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merely@</span>{<span class="id" title="var">j</span>} (<span class="id" title="var">sig@</span>{<span class="id" title="var">UQ</span> <span class="id" title="var">j</span>} (<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">sig@</span>{<span class="id" title="var">UQ</span> <span class="id" title="var">j</span>} (<span class="id" title="keyword">fun</span> <span class="id" title="var">d'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> = <span class="id" title="var">d</span> + <span class="id" title="var">d'</span> /\ <span class="id" title="var">close</span> <span class="id" title="var">d</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>)))).<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">PreMetric@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} (<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">premetric_prop</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">A</span> (<span class="id" title="var">close</span> <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;; <span class="id" title="var">premetric_refl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;; <span class="id" title="var">premetric_symm</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Symmetric</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;; <span class="id" title="var">premetric_separated</span> : <span class="id" title="var">Separated</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;; <span class="id" title="var">premetric_triangular</span> : <span class="id" title="var">Triangular</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;; <span class="id" title="var">premetric_rounded</span> : <span class="id" title="var">Rounded@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} <span class="id" title="var">A</span> }.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="var">Existing</span> <span class="id" title="var">Instances</span><br/>
&nbsp;&nbsp;<span class="id" title="var">premetric_prop</span><br/>
&nbsp;&nbsp;<span class="id" title="var">premetric_refl</span><br/>
&nbsp;&nbsp;<span class="id" title="var">premetric_symm</span><br/>
&nbsp;&nbsp;<span class="id" title="var">premetric_separated</span><br/>
&nbsp;&nbsp;<span class="id" title="var">premetric_triangular</span><br/>
&nbsp;&nbsp;<span class="id" title="var">premetric_rounded</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">premetric_hset@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} `{<span class="id" title="var">Funext</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } `{<span class="id" title="var">PreMetric@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} <span class="id" title="var">A</span>} : <span class="id" title="var">IsHSet</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">HSet.ishset_hrel_subpaths@</span>{<span class="id" title="var">j</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>} <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)).<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">separated</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">Approximation@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">approximate</span> :&gt; <span class="id" title="var">Q</span>+ -&gt; <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;; <span class="id" title="var">approx_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">d</span> <span class="id" title="var">e</span>, <span class="id" title="var">close</span> (<span class="id" title="var">d</span>+<span class="id" title="var">e</span>) (<span class="id" title="var">approximate</span> <span class="id" title="var">d</span>) (<span class="id" title="var">approximate</span> <span class="id" title="var">e</span>) }.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">approx_eq</span> `{<span class="id" title="var">Funext</span>} `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">IsHProp</span> (<span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">approximate</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> = <span class="id" title="var">approximate</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">Ex</span>] [<span class="id" title="var">y</span> <span class="id" title="var">Ey</span>];<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_ishprop</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">IsLimit@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">x</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> : <span class="id" title="var">Q</span>+, <span class="id" title="var">close</span> (<span class="id" title="var">e</span>+<span class="id" title="var">d</span>) (<span class="id" title="var">x</span> <span class="id" title="var">d</span>) <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Lim@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} := <span class="id" title="var">lim</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">CauchyComplete@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Alim</span> : <span class="id" title="var">Lim</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">cauchy_complete</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>, <span class="id" title="var">IsLimit</span> <span class="id" title="var">x</span> (<span class="id" title="var">lim</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">contents</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">funext</span> : <span class="id" title="var">Funext</span>} {<span class="id" title="var">univalence</span> : <span class="id" title="var">Univalence</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rounded_plus</span> `{<span class="id" title="var">Rounded</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">forall</span> <span class="id" title="var">d</span> <span class="id" title="var">d'</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>, <span class="id" title="var">close</span> <span class="id" title="var">d</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">close</span> (<span class="id" title="var">d</span>+<span class="id" title="var">d'</span>) <span class="id" title="var">u</span> <span class="id" title="var">v</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">d</span> <span class="id" title="var">d'</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>,<span class="id" title="var">d'</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rounded_le'</span> `{<span class="id" title="var">Rounded</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">d</span>, ' <span class="id" title="var">e</span> &lt;= ' <span class="id" title="var">d</span> -&gt; <span class="id" title="var">close</span> <span class="id" title="var">d</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span> <span class="id" title="var">d</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_equiv_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>].<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">pos_eq</span> <span class="id" title="var">_</span> (<span class="id" title="var">_</span> + <span class="id" title="var">_</span>) (<span class="id" title="var">Qpos_diff_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">E'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_plus</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;coq/coq6483 **)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rounded_le@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> @<span class="id" title="var">rounded_le'@</span>{<span class="id" title="var">j</span> <span class="id" title="var">i</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">rounded_le'@</span>{<span class="id" title="var">j</span> <span class="id" title="var">i</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">j</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">rounded_le'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>}]).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">rounded_le</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">close_prod</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span> <span class="id" title="var">UB</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>}) (<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>}) `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">A</span> (<span class="id" title="var">close</span> <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">B</span> (<span class="id" title="var">close</span> <span class="id" title="var">e</span>)}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_prod@</span>{} : <span class="id" title="var">Closeness@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">fst</span> <span class="id" title="var">x</span>) (<span class="id" title="var">fst</span> <span class="id" title="var">y</span>) /\ <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">snd</span> <span class="id" title="var">x</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_prod_refl@</span>{}<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>) <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>) <span class="id" title="var">e</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_prod_symm@</span>{}<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Symmetric</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Symmetric</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>) <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Symmetric</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>) <span class="id" title="var">e</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_prod_separated@</span>{}<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Separated</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Separated</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Separated</span> (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Prod.path_prod</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">separated</span>;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_prod_triangular@</span>{}<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Triangular</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Triangular</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Triangular</span> (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>;<span class="id" title="tactic">split</span>;(<span class="id" title="tactic">eapply</span> <span class="id" title="var">triangular</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">E1</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">E2</span>]).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">close_prod_rounded'</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Rounded</span> <span class="id" title="var">A</span>} <br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Rounded</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Rounded</span> (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> [<span class="id" title="var">E0</span> <span class="id" title="var">E0'</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E0</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E0'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">E0</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d1</span> [<span class="id" title="var">d1'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">E0'</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d2</span> [<span class="id" title="var">d2'</span> [<span class="id" title="var">E3</span> <span class="id" title="var">E4</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> (<span class="id" title="var">join</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span>), (<span class="id" title="var">meet</span> <span class="id" title="var">d1'</span> <span class="id" title="var">d2'</span>);<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Qpos_sum_eq_join_meet</span>. <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_le</span> <span class="id" title="keyword">with</span> <span class="id" title="var">d1</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_le</span> <span class="id" title="keyword">with</span> <span class="id" title="var">d2</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_r</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_plus</span>,<span class="id" title="var">E2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;coq/coq6483 **)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">close_prod_rounded@</span>{<span class="id" title="var">j</span>} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> @<span class="id" title="var">close_prod_rounded'@</span>{<span class="id" title="var">j</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">close_prod_rounded'@</span>{<span class="id" title="var">j</span> <span class="id" title="var">j</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> @<span class="id" title="var">close_prod_rounded'@</span>{<span class="id" title="var">j</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span>}]).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">close_prod_rounded</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">close_prod_rounded</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">prod_premetric@</span>{<span class="id" title="var">j</span>} `{!<span class="id" title="var">PreMetric@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">j</span>} <span class="id" title="var">A</span>} `{!<span class="id" title="var">PreMetric@</span>{<span class="id" title="var">UB</span> <span class="id" title="var">j</span>} <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">PreMetric@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">prod_premetric</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">Alim</span> : <span class="id" title="var">Lim</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Blim</span> : <span class="id" title="var">Lim</span> <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">prod_lim@</span>{} : <span class="id" title="var">Lim</span> (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">xy</span>. <span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">lim</span>;<br/>
[<span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">fst</span> (<span class="id" title="var">xy</span> <span class="id" title="var">e</span>))|<span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">snd</span> (<span class="id" title="var">xy</span> <span class="id" title="var">e</span>))];<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xy</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">prod_cauchy_complete</span> `{!<span class="id" title="var">CauchyComplete</span> <span class="id" title="var">A</span>} `{!<span class="id" title="var">CauchyComplete</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">CauchyComplete</span> (<span class="id" title="var">A</span> /\ <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">xy</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span>;<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">cauchy_complete</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id" title="var">approximate</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">e0</span> : <span class="id" title="var">Q</span>+ =&gt; <span class="id" title="var">fst</span> (<span class="id" title="var">xy</span> <span class="id" title="var">e0</span>); <span class="id" title="var">approx_equiv</span> := <span class="id" title="var">_</span> |}).<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">cauchy_complete</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{| <span class="id" title="var">approximate</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">e0</span> : <span class="id" title="var">Q</span>+ =&gt; <span class="id" title="var">snd</span> (<span class="id" title="var">xy</span> <span class="id" title="var">e0</span>); <span class="id" title="var">approx_equiv</span> := <span class="id" title="var">_</span> |}).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">close_prod</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">close_arrow</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>} `{<span class="id" title="var">Bclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} `{!<span class="id" title="var">PreMetric</span> <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="comment">(*&nbsp;Using&nbsp;<span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">close</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode">(<span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode">(<span class="id" title="var">g</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span>&nbsp;works&nbsp;for&nbsp;closed&nbsp;balls,&nbsp;not&nbsp;open&nbsp;ones.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_arrow</span> : <span class="id" title="var">Closeness</span> (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> =&gt; <span class="id" title="var">merely</span> (<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span> <span class="id" title="var">d'</span>, <span class="id" title="var">e</span> = <span class="id" title="var">d</span> + <span class="id" title="var">d'</span> /\ <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">close</span> <span class="id" title="var">d</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">close_arrow_apply</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>), <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">E</span> <span class="id" title="var">x</span>;<span class="id" title="var">revert</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_plus</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">close_arrow_premetric</span> : <span class="id" title="var">PreMetric</span> (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>; <span class="id" title="tactic">exists</span> (<span class="id" title="var">e</span>/2), (<span class="id" title="var">e</span>/2);<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_split2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>, <span class="id" title="var">d'</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>;<span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_forall</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">separated</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">E</span> <span class="id" title="var">e</span>)). <span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_plus</span>. <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> <span class="id" title="var">E1</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d1</span> [<span class="id" title="var">d1'</span> [<span class="id" title="var">E3</span> <span class="id" title="var">E4</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> <span class="id" title="var">E2</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d2</span> [<span class="id" title="var">d2'</span> [<span class="id" title="var">E5</span> <span class="id" title="var">E6</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> (<span class="id" title="var">d1</span>+<span class="id" title="var">d2</span>),(<span class="id" title="var">d1'</span>+<span class="id" title="var">d2'</span>). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E3</span>,<span class="id" title="var">E5</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span>; <span class="id" title="var">ring_tac.ring_with_nat</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">triangular</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>);<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> (<span class="id" title="var">d</span>+<span class="id" title="var">d'</span>/2),(<span class="id" title="var">d'</span>/2). <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Qpos_plus_assoc</span>,&lt;-<span class="id" title="var">pos_split2</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>, (<span class="id" title="var">d'</span>/2);<span class="id" title="tactic">split</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>,<span class="id" title="var">d'</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">close_arrow_apply</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">Blim</span> : <span class="id" title="var">Lim</span> <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">arrow_lim</span> : <span class="id" title="var">Lim</span> (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lim</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">close_arrow_apply</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">approx_equiv</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">arrow_lim</span> <span class="id" title="var">_</span> / <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> `{!<span class="id" title="var">CauchyComplete</span> <span class="id" title="var">B</span>}.<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">arrow_cauchy_complete</span> : <span class="id" title="var">CauchyComplete</span> (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lim</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">e</span>/2 + <span class="id" title="var">d</span>), (<span class="id" title="var">e</span>/2). <span class="id" title="tactic">split</span>.<br/>
+ <span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">set</span> (<span class="id" title="var">e'</span> := <span class="id" title="var">e</span>/2);<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pos_split2</span> <span class="id" title="var">e</span>);<span class="id" title="tactic">unfold</span> <span class="id" title="var">e'</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span>;<span class="id" title="var">ring_tac.ring_with_nat</span>).<br/>
+ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">S</span> := {| <span class="id" title="var">approximate</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">e0</span> : <span class="id" title="var">Q</span>+ =&gt; (<span class="id" title="var">f</span> <span class="id" title="var">e0</span>) <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;  <span class="id" title="var">approx_equiv</span> := <span class="id" title="var">_</span> |}).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">cauchy_complete</span> <span class="id" title="var">S</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">close_arrow</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">NonExpanding</span> `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">non_expanding</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">non_expanding</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> {<span class="id" title="var">_</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Lipschitz</span> `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">L</span> : <span class="id" title="var">Q</span>+)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">lipschitz</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">close</span> (<span class="id" title="var">L</span> * <span class="id" title="var">e</span>) (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">lipschitz</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">L</span> {<span class="id" title="var">_</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Uniform</span> `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">mu</span> : <span class="id" title="var">Q</span>+ -&gt; <span class="id" title="var">Q</span>+)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">uniform</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">close</span> (<span class="id" title="var">mu</span> <span class="id" title="var">e</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">uniform</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">mu</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Continuous@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">UB</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">continuous</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">e</span>, <span class="id" title="var">merely@</span>{<span class="id" title="var">Ularge</span>} (<span class="id" title="var">sig@</span>{<span class="id" title="var">UQ</span> <span class="id" title="var">Ularge</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">v</span>, <span class="id" title="var">close</span> <span class="id" title="var">d</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">f</span> <span class="id" title="var">u</span>) (<span class="id" title="var">f</span> <span class="id" title="var">v</span>))).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">continuous</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">BinaryDup@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> /\ <span class="id" title="var">A</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">x</span>, <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">map2</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>) : <span class="id" title="var">A</span> /\ <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span> /\ <span class="id" title="var">D</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">f</span> (<span class="id" title="var">fst</span> <span class="id" title="var">x</span>), <span class="id" title="var">g</span> (<span class="id" title="var">snd</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">closeness</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">id_nonexpanding</span> : <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">id</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">BinaryDup_nonexpanding@</span>{} : <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">BinaryDup</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UB</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nonexpanding_lipschitz'</span> `{!<span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intro</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">left_identity</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">non_expanding</span>,<span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nonexpanding_lipschitz@</span>{} `{!<span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> 1<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">nonexpanding_lipschitz'@</span>{<span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">nonexpanding_lipschitz'@</span>{}]).<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">nonexpanding_lipschitz</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lipschitz_nonexpanding@</span>{} `{!<span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> 1} : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">left_identity</span> <span class="id" title="var">e</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> <span class="id" title="var">f</span> 1 <span class="id" title="var">E</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">const_nonexpanding@</span>{} `{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>) <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">b</span> : <span class="id" title="var">B</span>) : <span class="id" title="var">NonExpanding</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <span class="id" title="var">A</span> =&gt; <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lipschitz_const@</span>{} `{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>) <span class="id" title="var">e</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">L</span>:<span class="id" title="var">Q</span>+), <span class="id" title="var">Lipschitz</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <span class="id" title="var">A</span> =&gt; <span class="id" title="var">b</span>) <span class="id" title="var">L</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">hnf</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lipschitz_uniform@</span>{} (<span class="id" title="var">L</span>:<span class="id" title="var">Q</span>+) `{!<span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">L</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Uniform</span> <span class="id" title="var">f</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">e</span> / <span class="id" title="var">L</span>) | 5.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">pos_unconjugate</span> <span class="id" title="var">L</span> <span class="id" title="var">e</span>),&lt;-<span class="id" title="var">Qpos_mult_assoc</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">L</span>),<span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uniform_continuous@</span>{} <span class="id" title="var">mu</span> `{!<span class="id" title="var">Uniform@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">UB</span>} <span class="id" title="var">f</span> <span class="id" title="var">mu</span>} : <span class="id" title="var">Continuous</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">e</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> (<span class="id" title="var">mu</span> <span class="id" title="var">e</span>).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">uniform</span> <span class="id" title="var">f</span> <span class="id" title="var">mu</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">uniform_continuous</span> | 5.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lipschitz_continuous@</span>{} (<span class="id" title="var">L</span>:<span class="id" title="var">Q</span>+) `{!<span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">L</span>} : <span class="id" title="var">Continuous</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nonexpanding_continuous@</span>{} `{!<span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>} : <span class="id" title="var">Continuous</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">closeness</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">compositions</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UB</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UC</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">C</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UC</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">C</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nonexpanding_compose@</span>{}<br/>
&nbsp;&nbsp;{<span class="id" title="var">Eg</span> : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">g</span>} {<span class="id" title="var">Ef</span> : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">exact</span> (<span class="id" title="var">non_expanding</span> <span class="id" title="var">g</span> (<span class="id" title="var">non_expanding</span> <span class="id" title="var">f</span> <span class="id" title="var">xi</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lipschitz_compose@</span>{}<br/>
&nbsp;&nbsp;<span class="id" title="var">Lg</span> {<span class="id" title="var">Eg</span> : <span class="id" title="var">Lipschitz</span> <span class="id" title="var">g</span> <span class="id" title="var">Lg</span>} <span class="id" title="var">Lf</span> {<span class="id" title="var">Ef</span> : <span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">Lf</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) (<span class="id" title="var">Lg</span> * <span class="id" title="var">Lf</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> ??? <span class="id" title="var">He</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Compose</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Ef</span>,<span class="id" title="var">Eg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">He</span>.<br/>
<span class="id" title="tactic">pattern</span> (<span class="id" title="var">Lg</span> * <span class="id" title="var">Lf</span> * <span class="id" title="var">e</span>).<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">transport</span>;[|<span class="id" title="tactic">exact</span> <span class="id" title="var">He</span>].<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="keyword">associativity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lipschitz_compose_nonexpanding_r'</span><br/>
&nbsp;&nbsp;<span class="id" title="var">L</span> {<span class="id" title="var">Eg</span> : <span class="id" title="var">Lipschitz</span> <span class="id" title="var">g</span> <span class="id" title="var">L</span>} {<span class="id" title="var">Ef</span> : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) <span class="id" title="var">L</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">left_identity</span> <span class="id" title="var">L</span>),<span class="id" title="var">commutativity</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lipschitz_compose_nonexpanding_r@</span>{}<br/>
&nbsp;&nbsp;<span class="id" title="var">L</span> {<span class="id" title="var">Eg</span> : <span class="id" title="var">Lipschitz</span> <span class="id" title="var">g</span> <span class="id" title="var">L</span>} {<span class="id" title="var">Ef</span> : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) <span class="id" title="var">L</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> (<span class="id" title="var">lipschitz_compose_nonexpanding_r'@</span>{<span class="id" title="var">Ularge</span>} <span class="id" title="var">L</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">lipschitz_compose_nonexpanding_r'@</span>{} <span class="id" title="var">L</span>)]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lipschitz_compose_nonexpanding_l'</span><br/>
&nbsp;&nbsp;<span class="id" title="var">L</span> {<span class="id" title="var">Eg</span> : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">g</span>} {<span class="id" title="var">Ef</span> : <span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">L</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) <span class="id" title="var">L</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">left_identity</span> <span class="id" title="var">L</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lipschitz_compose_nonexpanding_l@</span>{}<br/>
&nbsp;&nbsp;<span class="id" title="var">L</span> {<span class="id" title="var">Eg</span> : <span class="id" title="var">NonExpanding</span> <span class="id" title="var">g</span>} {<span class="id" title="var">Ef</span> : <span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">L</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) <span class="id" title="var">L</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> (<span class="id" title="var">lipschitz_compose_nonexpanding_l'@</span>{<span class="id" title="var">Ularge</span>} <span class="id" title="var">L</span>)|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">lipschitz_compose_nonexpanding_l'@</span>{} <span class="id" title="var">L</span>)]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uniform_compose@</span>{} <span class="id" title="var">mu</span> {<span class="id" title="var">Eg</span> : <span class="id" title="var">Uniform</span> <span class="id" title="var">g</span> <span class="id" title="var">mu</span>} <span class="id" title="var">mu'</span> {<span class="id" title="var">Ef</span> : <span class="id" title="var">Uniform</span> <span class="id" title="var">f</span> <span class="id" title="var">mu'</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Uniform</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) (<span class="id" title="var">Compose</span> <span class="id" title="var">mu'</span> <span class="id" title="var">mu</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Compose</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">uniform</span> <span class="id" title="var">g</span> <span class="id" title="var">_</span>),(<span class="id" title="var">uniform</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>),<span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">uniform_compose</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">continuous_compose@</span>{} {<span class="id" title="var">Eg</span> : <span class="id" title="var">Continuous</span> <span class="id" title="var">g</span>} {<span class="id" title="var">Ef</span> : <span class="id" title="var">Continuous</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Continuous</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">continuous</span> <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">u</span>) <span class="id" title="var">e</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> <span class="id" title="var">E</span>].<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">continuous</span> <span class="id" title="var">f</span> <span class="id" title="var">u</span> <span class="id" title="var">d</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">d'</span> <span class="id" title="var">E'</span>].<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> <span class="id" title="var">d'</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>,<span class="id" title="var">E'</span>,<span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">compositions</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">currying</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UB</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UC</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">C</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UC</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">C</span>} `{!<span class="id" title="var">Triangular</span> <span class="id" title="var">C</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">uncurry_lipschitz</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) <span class="id" title="var">L1</span> <span class="id" title="var">L2</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="var">L1</span>}<br/>
&nbsp;&nbsp;`{!<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">Lipschitz</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">L2</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">uncurry</span> <span class="id" title="var">f</span>) (<span class="id" title="var">L1</span> + <span class="id" title="var">L2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> [<span class="id" title="var">u1</span> <span class="id" title="var">u2</span>] [<span class="id" title="var">v1</span> <span class="id" title="var">v2</span>] [<span class="id" title="var">xi1</span> <span class="id" title="var">xi2</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi1</span>,<span class="id" title="var">xi2</span>.<br/>
<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : (<span class="id" title="var">L1</span> + <span class="id" title="var">L2</span>) * <span class="id" title="var">e</span> = <span class="id" title="var">L1</span> * <span class="id" title="var">e</span> + <span class="id" title="var">L2</span> * <span class="id" title="var">e</span>)<br/>
<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span>;<span class="id" title="var">ring_tac.ring_with_nat</span>);<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">triangular</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> <span class="id" title="var">u1</span> <span class="id" title="var">v2</span>)).<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> <span class="id" title="var">_</span> <span class="id" title="var">L1</span>). <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">u</span> <span class="id" title="var">v2</span>) <span class="id" title="var">L2</span>). <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">uncurry_uniform</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Rounded</span> <span class="id" title="var">A</span>} `{!<span class="id" title="var">Rounded</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) <span class="id" title="var">mu</span> <span class="id" title="var">mu'</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Uniform</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="var">mu</span>}<br/>
&nbsp;&nbsp;`{!<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">Uniform</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">mu'</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Uniform</span> (<span class="id" title="var">uncurry</span> <span class="id" title="var">f</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">meet</span> (<span class="id" title="var">mu</span> (<span class="id" title="var">e</span>/2)) (<span class="id" title="var">mu'</span> (<span class="id" title="var">e</span>/2))).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> [<span class="id" title="var">u1</span> <span class="id" title="var">u2</span>] [<span class="id" title="var">v1</span> <span class="id" title="var">v2</span>] [<span class="id" title="var">xi1</span> <span class="id" title="var">xi2</span>].<br/>
<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pos_split2</span> <span class="id" title="var">e</span>).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">triangular</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> <span class="id" title="var">u1</span> <span class="id" title="var">v2</span>)).<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">uniform</span> (<span class="id" title="var">f</span> <span class="id" title="var">u1</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">rounded_le</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">xi2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">meet_lb_l</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">uniform</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">v</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">v</span> <span class="id" title="var">v2</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">rounded_le</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">xi1</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">meet_lb_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">currying</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">pair</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">e</span>)}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UB</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} `{<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Reflexive</span> (<span class="id" title="var">close</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">B</span>) <span class="id" title="var">e</span>)}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">pair_nonexpanding_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">pair</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">exact</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">pair_nonexpanding_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">NonExpanding</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; @<span class="id" title="var">pair</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">exact</span> <span class="id" title="var">xi</span>.<br/>
- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">fst_nonexpanding</span> : <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">fst</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">snd_nonexpanding</span> : <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">snd</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">pair</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">prod_equiv</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UB</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">equiv_prod_symm_nonexpanding</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">Prod.equiv_prod_symm</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">equiv_prod_symm_inv_nonexpanding</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> ((@<span class="id" title="var">Prod.equiv_prod_symm</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)^-1).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UC</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">C</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UC</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">C</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">equiv_prod_assoc_nonexpanding</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> (@<span class="id" title="var">Prod.equiv_prod_assoc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">equiv_prod_assoc_inc_nonexpanding</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> ((@<span class="id" title="var">Prod.equiv_prod_assoc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>)^-1).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">prod_equiv</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">map2</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UB</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UB</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UC</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">C</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UC</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">C</span>}.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UD</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">D</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UD</span>} } `{<span class="id" title="var">Closeness</span> <span class="id" title="var">D</span>}.<br/>
<span class="id" title="keyword">Variables</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_nonexpanding'</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="var">NonExpanding</span> <span class="id" title="var">f</span>} `{!<span class="id" title="var">NonExpanding</span> <span class="id" title="var">g</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> (<span class="id" title="var">non_expanding</span> <span class="id" title="var">_</span>),<span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">map2_nonexpanding@</span>{<span class="id" title="var">i</span>} := @<span class="id" title="var">map2_nonexpanding'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">map2_nonexpanding</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">map2_nonexpanding</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_lipschitz'</span> `{!<span class="id" title="var">Rounded</span> <span class="id" title="var">C</span>} `{!<span class="id" title="var">Rounded</span> <span class="id" title="var">D</span>} <span class="id" title="var">Lf</span> <span class="id" title="var">Lg</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Lipschitz</span> <span class="id" title="var">f</span> <span class="id" title="var">Lf</span>} `{!<span class="id" title="var">Lipschitz</span> <span class="id" title="var">g</span> <span class="id" title="var">Lg</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) (<span class="id" title="var">join</span> <span class="id" title="var">Lf</span> <span class="id" title="var">Lg</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>. <span class="id" title="tactic">split</span>;<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_le</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">Lf</span> * <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>),<span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> (.* ' <span class="id" title="var">e</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_l</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_le</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">Lg</span> * <span class="id" title="var">e</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>),<span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> (.* ' <span class="id" title="var">e</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;coq/coq6483 **)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">map2_lipschitz@</span>{<span class="id" title="var">i</span>} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> @<span class="id" title="var">map2_lipschitz'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>}|<span class="id" title="tactic">exact</span> @<span class="id" title="var">map2_lipschitz'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>}]).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">map2_lipschitz</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">Lf</span> <span class="id" title="var">Lg</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">map2_lipschitz</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_continuous'</span> `{!<span class="id" title="var">Rounded</span> <span class="id" title="var">A</span>} `{!<span class="id" title="var">Rounded</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Continuous</span> <span class="id" title="var">f</span>} `{!<span class="id" title="var">Continuous</span> <span class="id" title="var">g</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Continuous</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">continuous</span> <span class="id" title="var">f</span> (<span class="id" title="var">fst</span> <span class="id" title="var">u</span>) <span class="id" title="var">e</span>));<span class="id" title="tactic">intros</span> [<span class="id" title="var">d1</span> <span class="id" title="var">E1</span>].<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">continuous</span> <span class="id" title="var">g</span> (<span class="id" title="var">snd</span> <span class="id" title="var">u</span>) <span class="id" title="var">e</span>));<span class="id" title="tactic">intros</span> [<span class="id" title="var">d2</span> <span class="id" title="var">E2</span>].<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">exists</span> (<span class="id" title="var">meet</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">E1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_le</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">meet</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">meet_lb_l</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">E2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_le</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">meet</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">meet_lb_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;coq/coq6483 **)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">map2_continuous@</span>{<span class="id" title="var">i</span>} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> @<span class="id" title="var">map2_continuous'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>}|<span class="id" title="tactic">exact</span> @<span class="id" title="var">map2_continuous'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>}]).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">map2_continuous</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">u</span> <span class="id" title="var">e</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">map2_continuous</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">map2</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">interval</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span> <span class="id" title="var">UALE</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } {<span class="id" title="var">Ale</span> : <span class="id" title="var">Le@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">UALE</span>} <span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Interval</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> := <span class="id" title="var">sig</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span> =&gt; <span class="id" title="var">a</span> &lt;= <span class="id" title="var">x</span> /\ <span class="id" title="var">x</span> &lt;= <span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">interval_proj</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">Interval</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">A</span> := <span class="id" title="var">pr1</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">Ameet</span> : <span class="id" title="var">Meet</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Ajoin</span> : <span class="id" title="var">Join</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">LatticeOrder@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">UALE</span>} <span class="id" title="var">Ale</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Interval_restrict@</span>{} (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">E</span> : <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span>) : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Interval</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="tactic">exists</span> (<span class="id" title="var">join</span> <span class="id" title="var">a</span> (<span class="id" title="var">meet</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>)).<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_l</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">join_le</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">meet_lb_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Interval_restrict_pr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span> <span class="id" title="var">x</span> (<span class="id" title="var">E'</span>: <span class="id" title="var">a</span> &lt;= <span class="id" title="var">x</span> /\ <span class="id" title="var">x</span> &lt;= <span class="id" title="var">b</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">Interval_restrict</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span> <span class="id" title="var">x</span> = <span class="id" title="var">exist</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">E'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span> <span class="id" title="var">x</span> <span class="id" title="var">E'</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Interval_restrict</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Sigma.path_sigma_hprop</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">meet_l</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">join_r</span>|];<span class="id" title="tactic">apply</span> <span class="id" title="var">E'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> `{<span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Interval_close</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">Closeness</span> (<span class="id" title="var">Interval</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">interval_proj</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span>) (<span class="id" title="var">interval_proj</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Interval_close</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="comment">(*&nbsp;NB:&nbsp;for&nbsp;some&nbsp;reason&nbsp;this&nbsp;forces&nbsp;UALE&nbsp;&lt;=&nbsp;UA&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Interval_premetric@</span>{<span class="id" title="var">i</span>} `{!<span class="id" title="var">PreMetric@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">i</span>} <span class="id" title="var">A</span>} <span class="id" title="var">a</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">PreMetric@</span>{<span class="id" title="var">UA</span> <span class="id" title="var">i</span>} (<span class="id" title="var">Interval</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">unfold</span> <span class="id" title="var">close</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span>. <span class="id" title="tactic">red</span>;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Sigma.path_sigma_hprop</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">separated</span>,<span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> <span class="id" title="var">xi1</span> <span class="id" title="var">xi2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">triangular</span> <span class="id" title="var">_</span> (<span class="id" title="var">interval_proj</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">v</span>)).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">xi1</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">xi2</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">xi</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">rounded</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">close</span>,<span class="id" title="var">Interval_close</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">rounded</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">Interval_premetric</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">interval_proj_nonexpanding</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">interval_proj</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">xi</span> =&gt; <span class="id" title="var">xi</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">interval</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">rationals</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Qclose_alt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> (<span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">Q</span>), <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> &lt;-&gt; <span class="id" title="var">abs</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>) &lt; ' <span class="id" title="var">e</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>;<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">total</span> <span class="id" title="var">le</span> 0 (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonneg</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonpos</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">involutive</span>. <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">split</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">involutive</span>|];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">abs</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>));<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_le_neg_raw</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_le_raw</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Qclose_neg@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Q</span>), <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> &lt;-&gt; <span class="id" title="var">close</span> <span class="id" title="var">e</span> (- <span class="id" title="var">x</span>) (- <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>.<br/>
- <span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">negate_plus_distr</span>),<span class="id" title="var">Qabs_neg</span>. <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">negate_plus_distr</span>),<span class="id" title="var">Qabs_neg</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Q_close_symm@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Symmetric</span> (@<span class="id" title="var">close</span> <span class="id" title="var">Q</span> <span class="id" title="var">_</span> <span class="id" title="var">e</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">close</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>];<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span>. <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">negate_swap_r</span>,<span class="id" title="var">involutive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_swap_r</span>,<span class="id" title="var">involutive</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Q_triangular_one@</span>{} : <span class="id" title="keyword">forall</span> (<span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">Q</span>)<br/>
(<span class="id" title="var">e</span> : <span class="id" title="var">Q</span>+) (<span class="id" title="var">Hqr</span> : <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>)<br/>
(<span class="id" title="var">q0</span> : <span class="id" title="var">Q</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">Q</span>+),<br/>
&nbsp;&nbsp;(<span class="id" title="var">close</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span> <span class="id" title="var">q0</span> -&gt; <span class="id" title="var">close</span> (<span class="id" title="var">e</span> + <span class="id" title="var">n</span>) <span class="id" title="var">r</span> <span class="id" title="var">q0</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">close</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E1'</span>] <span class="id" title="var">s</span> <span class="id" title="var">n</span> [<span class="id" title="var">E2</span> <span class="id" title="var">E2'</span>].<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_swap_r</span>,!<span class="id" title="var">involutive</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_swap_r</span>,!<span class="id" title="var">involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">plus_lt_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1'</span> <span class="id" title="var">E2</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">s</span> - <span class="id" title="var">r</span> = <span class="id" title="var">q</span> - <span class="id" title="var">r</span> + (<span class="id" title="var">s</span> - <span class="id" title="var">q</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> <span class="id" title="var">ring_tac.ring_with_integers</span> (<span class="id" title="var">NatPair.Z</span> <span class="id" title="var">nat</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">flip_lt_negate</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_swap_r</span>,!<span class="id" title="var">involutive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">plus_lt_compat</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2'</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">r</span> - <span class="id" title="var">s</span> = <span class="id" title="var">r</span> - <span class="id" title="var">q</span> + (<span class="id" title="var">q</span> - <span class="id" title="var">s</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> <span class="id" title="var">ring_tac.ring_with_integers</span> (<span class="id" title="var">NatPair.Z</span> <span class="id" title="var">nat</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Q_triangular@</span>{} : <span class="id" title="var">Triangular</span> <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Q_triangular_one</span> <span class="id" title="keyword">with</span> <span class="id" title="var">v</span>.<br/>
- <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Qclose_separating_not_lt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">Q</span>, (<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>) -&gt;<br/>
&nbsp;&nbsp;~ (<span class="id" title="var">q</span> &lt; <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">E1</span> (<span class="id" title="var">Qpos_diff</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">E3</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E3</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E3</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">cast</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E3</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E3</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">lt</span> (<span class="id" title="var">r</span> - <span class="id" title="var">q</span>)).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">abs</span> (<span class="id" title="var">r</span> - <span class="id" title="var">q</span>));<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_le_raw</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Qclose_separating</span> : <span class="id" title="var">Separated</span> <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">E1</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">tight_apart</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">apart_iff_total_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">E2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>].<br/>
- <span class="id" title="tactic">exact</span> (<span class="id" title="var">Qclose_separating_not_lt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>).<br/>
- <span class="id" title="tactic">refine</span> (<span class="id" title="var">Qclose_separating_not_lt</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Qclose_rounded@</span>{} : <span class="id" title="var">Rounded</span> <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>;<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">Q_average_between</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">exist</span> <span class="id" title="var">_</span> (<span class="id" title="var">mkQpos</span> ((<span class="id" title="var">abs</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>) + ' <span class="id" title="var">e</span>) / 2) <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_mult_compat</span>;[|<span class="id" title="var">solve_propholds</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">red</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_plus_le_lt_compat_r</span>;[<span class="id" title="var">solve_propholds</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_nonneg</span>].<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">Qpos_diff</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">Qpos_diff_pr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">E1</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>). <span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">He</span> <span class="id" title="var">xi</span>]]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">He</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_le_trans</span> <span class="id" title="keyword">with</span> (' <span class="id" title="var">d</span>);<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nonneg_plus_le_compat_r</span>. <span class="id" title="var">solve_propholds</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Q_premetric@</span>{} : <span class="id" title="var">PreMetric</span> <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_negate_r</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">abs</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">abs_sig</span> 0).2).<br/>
- <span class="id" title="var">solve_propholds</span>.<br/>
- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qneg_nonexpanding@</span>{} : <span class="id" title="var">NonExpanding</span> ((-) : <span class="id" title="var">Negate</span> <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_neg</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qplus_nonexpanding_l@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">NonExpanding</span> (+ <span class="id" title="var">s</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">close</span>,<span class="id" title="var">Q_close</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">q</span> + <span class="id" title="var">s</span> - (<span class="id" title="var">r</span> + <span class="id" title="var">s</span>) = <span class="id" title="var">q</span> - <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> <span class="id" title="var">ring_tac.ring_with_integers</span> (<span class="id" title="var">NatPair.Z</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qplus_nonexpanding_r@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">s</span> +).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">close</span>,<span class="id" title="var">Q_close</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">s</span> + <span class="id" title="var">q</span> - (<span class="id" title="var">s</span> + <span class="id" title="var">r</span>) = <span class="id" title="var">q</span> - <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> <span class="id" title="var">ring_tac.ring_with_integers</span> (<span class="id" title="var">NatPair.Z</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qabs_nonexpanding</span> : <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">abs</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">Q</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">abs</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>));<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_triangle_alt</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qmeet_nonexpanding_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">NonExpanding</span> (⊓ <span class="id" title="var">s</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">abs</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>));<span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">total</span> <span class="id" title="var">le</span> <span class="id" title="var">q</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">E1</span>|<span class="id" title="var">E1</span>], (<span class="id" title="var">total</span> <span class="id" title="var">le</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>];<br/>
<span class="id" title="tactic">rewrite</span> ?(<span class="id" title="var">meet_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1</span>), ?(<span class="id" title="var">meet_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1</span>), ?(<span class="id" title="var">meet_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>), ?(<span class="id" title="var">meet_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>).<br/>
- <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonpos</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonpos_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)); <span class="id" title="tactic">transitivity</span> <span class="id" title="var">s</span>;<span class="id" title="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">negate_swap_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonpos</span> <span class="id" title="var">_</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonpos_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">E1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">negate_swap_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> (+ (- <span class="id" title="var">q</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonneg</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonneg_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)); <span class="id" title="tactic">transitivity</span> <span class="id" title="var">s</span>;<span class="id" title="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonneg</span> <span class="id" title="var">_</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonneg_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">E2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> (+ (- <span class="id" title="var">r</span>))). <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_negate_r</span>,<span class="id" title="var">Qabs_of_nonneg</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_nonneg</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qmeet_nonexpanding_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">s</span> ⊓).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">meet_sl_order_meet_sl</span>.<br/>
<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">commutativity</span> <span class="id" title="var">s</span>).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">non_expanding</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">meet</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)). <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qjoin_nonexpanding_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">NonExpanding</span> (⊔ <span class="id" title="var">s</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">abs</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>));<span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">total</span> <span class="id" title="var">le</span> <span class="id" title="var">q</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">E1</span>|<span class="id" title="var">E1</span>], (<span class="id" title="var">total</span> <span class="id" title="var">le</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>];<br/>
<span class="id" title="tactic">rewrite</span> ?(<span class="id" title="var">join_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1</span>), ?(<span class="id" title="var">join_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E1</span>), ?(<span class="id" title="var">join_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>), ?(<span class="id" title="var">join_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span>).<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_negate_r</span>,<span class="id" title="var">Qabs_of_nonneg</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_nonneg</span>.<br/>
- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonpos</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonpos_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)); <span class="id" title="tactic">transitivity</span> <span class="id" title="var">s</span>;<span class="id" title="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">negate_swap_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonpos</span> <span class="id" title="var">_</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonpos_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">E2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">negate_swap_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> (<span class="id" title="var">r</span> +)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_le_negate</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonneg</span> (<span class="id" title="var">q</span> - <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonneg_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)); <span class="id" title="tactic">transitivity</span> <span class="id" title="var">s</span>;<span class="id" title="tactic">trivial</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Qabs_of_nonneg</span> <span class="id" title="var">_</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_nonneg_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">E1</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> (<span class="id" title="var">q</span> +)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">flip_le_negate</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qjoin_nonexpanding_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">NonExpanding</span> (<span class="id" title="var">s</span> ⊔).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">join_sl_order_join_sl</span>.<br/>
<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">commutativity</span> <span class="id" title="var">s</span>).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">non_expanding</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">join</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)). <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qmult_lipschitz@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span> : <span class="id" title="var">Q</span>, <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">q</span> *.) (<span class="id" title="var">pos_of_Q</span> <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_mult_distr_r</span>,&lt;-<span class="id" title="var">plus_mult_distr_l</span>,<span class="id" title="var">Qabs_mult</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">pos_mult_le_lt_compat</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_nonneg</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Qabs_is_join</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">join_le</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">flip_le_negate</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">involutive</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Q_abs_plus_1_bounds</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Q_abs_plus_1_bounds</span>.<br/>
- <span class="id" title="var">solve_propholds</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Qabs_nonneg</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>,<span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Qpos_upper_close</span> <span class="id" title="var">e</span> : <span class="id" title="var">Closeness</span> (<span class="id" title="var">Qpos_upper</span> <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">close</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>.1 <span class="id" title="var">y</span>.1.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Qpos_upper_close</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Q_recip_lipschitz</span> (<span class="id" title="var">e</span> : <span class="id" title="var">Q</span>+)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lipschitz</span> ((/) ∘ <span class="id" title="var">pr1</span> ∘ (<span class="id" title="var">Qpos_upper_inject</span> <span class="id" title="var">e</span>)) (/ (<span class="id" title="var">e</span> * <span class="id" title="var">e</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Compose</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">join</span> <span class="id" title="var">q</span> (' <span class="id" title="var">e</span>))) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_le_trans</span> <span class="id" title="keyword">with</span> (' <span class="id" title="var">e</span>);[<span class="id" title="var">solve_propholds</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_r</span>]).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_reflecting</span> ((<span class="id" title="var">join</span> <span class="id" title="var">q</span> (' <span class="id" title="var">e</span>)) *.)).<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">join</span> <span class="id" title="var">r</span> (' <span class="id" title="var">e</span>))) <span class="id" title="keyword">as</span> <span class="id" title="var">E'</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_le_trans</span> <span class="id" title="keyword">with</span> (' <span class="id" title="var">e</span>);[<span class="id" title="var">solve_propholds</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_r</span>]).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_reflecting</span> ((<span class="id" title="var">join</span> <span class="id" title="var">r</span> (' <span class="id" title="var">e</span>)) *.)).<br/>
<span class="id" title="tactic">set</span> (<span class="id" title="var">X</span> := <span class="id" title="var">join</span> <span class="id" title="var">r</span> (' <span class="id" title="var">e</span>)) <span class="id" title="tactic">at</span> 2 3.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">Qabs_of_nonneg</span> (<span class="id" title="var">join</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">solve_propholds</span>.<br/>
<span class="id" title="tactic">set</span> (<span class="id" title="var">Y</span> := <span class="id" title="var">join</span> <span class="id" title="var">q</span> (' <span class="id" title="var">e</span>)) <span class="id" title="tactic">at</span> 2 3.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">Qabs_of_nonneg</span> (<span class="id" title="var">join</span> <span class="id" title="var">q</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">solve_propholds</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-!<span class="id" title="var">Qabs_mult</span>.<br/>
<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">plus_mult_distr_l</span> (<span class="id" title="var">Aplus</span>:=<span class="id" title="var">Qplus</span>)).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">dec_recip_inverse</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">irrefl_neq</span>,<span class="id" title="var">symmetric_neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">trivial</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mult_1_r</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> :  (<span class="id" title="var">r</span> ⊔ ' <span class="id" title="var">e</span>) * ((<span class="id" title="var">q</span> ⊔ ' <span class="id" title="var">e</span>) * - / (<span class="id" title="var">r</span> ⊔ ' <span class="id" title="var">e</span>)) = - <span class="id" title="var">Y</span> * (<span class="id" title="var">X</span> / <span class="id" title="var">X</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_tac.ring_with_integers</span> (<span class="id" title="var">NatPair.Z</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">dec_recip_inverse</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">irrefl_neq</span>,<span class="id" title="var">symmetric_neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E'</span>;<span class="id" title="tactic">trivial</span>).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mult_1_r</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">X</span>, <span class="id" title="var">Y</span>.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">lt_le_trans</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Qclose_alt</span>. <span class="id" title="tactic">eapply</span> (<span class="id" title="var">non_expanding</span> (⊔ ' <span class="id" title="var">e</span>)). <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">xi</span>.<br/>
- <span class="id" title="tactic">transitivity</span> (' (((<span class="id" title="var">e</span> * <span class="id" title="var">e</span>) / (<span class="id" title="var">e</span> * <span class="id" title="var">e</span>)) * <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_recip_r</span>,<span class="id" title="var">Qpos_mult_1_l</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;-!<span class="id" title="var">Qpos_mult_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (' (<span class="id" title="var">e</span> * (<span class="id" title="var">e</span> * (/ (<span class="id" title="var">e</span> * <span class="id" title="var">e</span>) * <span class="id" title="var">n</span>)))) <span class="id" title="keyword">with</span> (' <span class="id" title="var">e</span> * (' <span class="id" title="var">e</span> * ' (/ (<span class="id" title="var">e</span> * <span class="id" title="var">e</span>) * <span class="id" title="var">n</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">mult_le_compat</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">solve_propholds</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_r</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">mult_le_compat</span>;<span class="id" title="tactic">try</span> <span class="id" title="var">solve_propholds</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">join_ub_r</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">rationals</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">cauchy</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UA</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">UA</span>} } {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Context</span> `{!<span class="id" title="var">PreMetric</span> <span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">limit_unique</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>, <span class="id" title="var">IsLimit</span> <span class="id" title="var">x</span> <span class="id" title="var">l1</span> -&gt; <span class="id" title="var">IsLimit</span> <span class="id" title="var">x</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">l1</span> = <span class="id" title="var">l2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">separated</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">pos_split2</span> <span class="id" title="var">e</span>),(<span class="id" title="var">pos_split2</span> (<span class="id" title="var">e</span>/2)).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">triangular</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> (<span class="id" title="var">e</span> / 2 / 2));[<span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">E1</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">E2</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equiv_through_approx0</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">y</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>) <span class="id" title="var">ly</span>, <span class="id" title="var">IsLimit</span> <span class="id" title="var">y</span> <span class="id" title="var">ly</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span>, <span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> (<span class="id" title="var">y</span> <span class="id" title="var">d</span>) -&gt; <span class="id" title="var">close</span> (<span class="id" title="var">e</span>+<span class="id" title="var">d</span>) <span class="id" title="var">u</span> <span class="id" title="var">ly</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">ly</span> <span class="id" title="var">E1</span> <span class="id" title="var">u</span> <span class="id" title="var">e</span> <span class="id" title="var">d</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> ((<span class="id" title="var">fst</span> (<span class="id" title="var">rounded</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">xi</span>))).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">d0</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">He</span> <span class="id" title="var">E2</span>]]].<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">triangular</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E2</span> (<span class="id" title="var">E1</span> <span class="id" title="var">d'</span> <span class="id" title="var">_</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">E3</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">e</span> + <span class="id" title="var">d</span> = <span class="id" title="var">d0</span> + (<span class="id" title="var">d'</span> + <span class="id" title="var">d</span>));[|<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">trivial</span>].<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">He</span>. <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Qpos_plus_assoc</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">Alim</span> : <span class="id" title="var">Lim</span> <span class="id" title="var">A</span>} `{!<span class="id" title="var">CauchyComplete</span> <span class="id" title="var">A</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equiv_through_approx</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">u</span> (<span class="id" title="var">y</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>) <span class="id" title="var">e</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">close</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> (<span class="id" title="var">y</span> <span class="id" title="var">d</span>) -&gt; <span class="id" title="var">close</span> (<span class="id" title="var">e</span>+<span class="id" title="var">d</span>) <span class="id" title="var">u</span> (<span class="id" title="var">lim</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">u</span> <span class="id" title="var">y</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_through_approx0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">cauchy_complete</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equiv_lim_lim</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>) (<span class="id" title="var">e</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span> <span class="id" title="var">e'</span> : <span class="id" title="var">Q</span>+)<br/>
&nbsp;&nbsp;: <span class="id" title="var">e</span> = <span class="id" title="var">d</span> + <span class="id" title="var">n</span> + <span class="id" title="var">e'</span> -&gt; <span class="id" title="var">close</span> <span class="id" title="var">e'</span> (<span class="id" title="var">x</span> <span class="id" title="var">d</span>) (<span class="id" title="var">y</span> <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">close</span> <span class="id" title="var">e</span> (<span class="id" title="var">lim</span> <span class="id" title="var">x</span>) (<span class="id" title="var">lim</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">He</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">He</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">d</span> + <span class="id" title="var">n</span> + <span class="id" title="var">e'</span> = <span class="id" title="var">e'</span> + <span class="id" title="var">d</span> + <span class="id" title="var">n</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span>;<span class="id" title="var">ring_tac.ring_with_nat</span>);<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_through_approx</span>.<br/>
<span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_through_approx</span>. <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lim_same_distance@</span>{} : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span>) <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">d</span> <span class="id" title="var">n</span>, <span class="id" title="var">close</span> (<span class="id" title="var">e</span>+<span class="id" title="var">d</span>) (<span class="id" title="var">x</span> <span class="id" title="var">n</span>) (<span class="id" title="var">y</span> <span class="id" title="var">n</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">d</span>, <span class="id" title="var">close</span> (<span class="id" title="var">e</span>+<span class="id" title="var">d</span>) (<span class="id" title="var">lim</span> <span class="id" title="var">x</span>) (<span class="id" title="var">lim</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">E</span> <span class="id" title="var">d</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_lim_lim</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">d</span>/3) (<span class="id" title="var">d</span>/3) (<span class="id" title="var">e</span> + <span class="id" title="var">d</span>/3);[|<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>].<br/>
<span class="id" title="var">path_via</span> (<span class="id" title="var">e</span> + 3 / 3 * <span class="id" title="var">d</span>).<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">pos_recip_r</span>,<span class="id" title="var">Qpos_mult_1_l</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_eq</span>;<span class="id" title="var">ring_tac.ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">cauchy</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">lipschitz_lim</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>} {<span class="id" title="var">Aclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">A</span>} `{!<span class="id" title="var">PreMetric</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;`{<span class="id" title="var">Bclose</span> : <span class="id" title="var">Closeness</span> <span class="id" title="var">B</span>} `{!<span class="id" title="var">PreMetric</span> <span class="id" title="var">B</span>} {<span class="id" title="var">Blim</span> : <span class="id" title="var">Lim</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;&nbsp;`{!<span class="id" title="var">CauchyComplete</span> <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lipschitz_lim_lipschitz</span> (<span class="id" title="var">s</span> : <span class="id" title="var">Approximation</span> (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>)) <span class="id" title="var">L</span><br/>
&nbsp;&nbsp;`{!<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">s</span> <span class="id" title="var">e</span>) <span class="id" title="var">L</span>} : <span class="id" title="var">Lipschitz</span> (<span class="id" title="var">lim</span> <span class="id" title="var">s</span>) <span class="id" title="var">L</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded</span> <span class="id" title="tactic">in</span> <span class="id" title="var">xi</span>;<span class="id" title="var">revert</span> <span class="id" title="var">xi</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Trunc_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">d'</span> [<span class="id" title="var">E</span> <span class="id" title="var">xi</span>]]].<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>,<span class="id" title="var">Qpos_plus_mult_distr_l</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lim_same_distance</span>.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">e</span> <span class="id" title="var">d'</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">d'</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rounded_plus</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">lipschitz</span> (<span class="id" title="var">s</span> <span class="id" title="var">n</span>) <span class="id" title="var">L</span>). <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">lipschitz_lim</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">contents</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">rounded_le</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">non_expanding</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> {<span class="id" title="var">_</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">lipschitz</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">L</span> {<span class="id" title="var">_</span> <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">uniform</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">mu</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">continuous</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">map2_nonexpanding</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span> <span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">D</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">g</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">map2_lipschitz</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span> <span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">D</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">g</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">Lf</span> <span class="id" title="var">Lg</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">e</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">xi</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">map2_continuous</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span> <span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">D</span> <span class="id" title="var">_</span>} <span class="id" title="var">f</span> <span class="id" title="var">g</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">u</span> <span class="id" title="var">e</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Interval_close</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> /.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Lim</span> <span class="id" title="var">A</span> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">lim</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Approximation</span> <span class="id" title="var">A</span> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Build_Approximation</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">approximate</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">approx_equiv</span> {<span class="id" title="var">A</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">CauchyComplete</span> <span class="id" title="var">A</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">arrow_lim</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> / <span class="id" title="var">_</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>