<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Flattening</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Flattening</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab1082"></a><h1 class="section">The flattening lemma.</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Types.Paths</span> <span class="id" title="var">Types.Forall</span> <span class="id" title="var">Types.Sigma</span> <span class="id" title="var">Types.Arrow</span> <span class="id" title="var">Types.Universe</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Colimits.Coeq</span>.<br/>

<br/>
</div>

<div class="doc">
The base HIT <span class="inlinecode"><span class="id" title="var">W</span></span> is just a homotopy coequalizer <span class="inlinecode"><span class="id" title="var">Coeq</span></span>. 
<div class="paragraph"> </div>

 TODO: Make the names in this file more usable, move it into <span class="inlinecode"><span class="id" title="var">Coeq.v</span></span>, and use it to derive corresponding flattening lemmas for <span class="inlinecode"><span class="id" title="var">pushout</span></span>, etc. 
<div class="paragraph"> </div>

 Now we define the flattened HIT which will be equivalent to the total space of a fibration over <span class="inlinecode"><span class="id" title="var">W</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">FlattenedHIT</span>.<br/>

<br/>
<span class="id" title="keyword">Private Inductive</span> <span class="id" title="var">Wtil</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">C</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">D</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) &lt;~&gt; <span class="id" title="var">C</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">Type</span> :=<br/>
| <span class="id" title="var">cct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">C</span> <span class="id" title="var">a</span> -&gt; <span class="id" title="var">Wtil</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">cct</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} <span class="id" title="var">a</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">ppt</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">y</span>:<span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)),<br/>
&nbsp;&nbsp;@<span class="id" title="var">cct</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> = <span class="id" title="var">cct</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Wtil_ind</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">Q</span> : <span class="id" title="var">Wtil</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">cct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>, <span class="id" title="var">Q</span> (<span class="id" title="var">cct</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">ppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>, (<span class="id" title="var">ppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) # (<span class="id" title="var">cct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span>) = <span class="id" title="var">cct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">w</span>, <span class="id" title="var">Q</span> <span class="id" title="var">w</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">w</span> <span class="id" title="keyword">with</span> <span class="id" title="var">cct</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">cct'</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="keyword">end</span> <span class="id" title="var">ppt'</span>.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">Wtil_ind_beta_ppt</span><br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">Q</span> : <span class="id" title="var">Wtil</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>, <span class="id" title="var">Q</span> (<span class="id" title="var">cct</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>, (<span class="id" title="var">ppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) # (<span class="id" title="var">cct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span>) = <span class="id" title="var">cct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">apD</span> (<span class="id" title="var">Wtil_ind</span> <span class="id" title="var">Q</span> <span class="id" title="var">cct'</span> <span class="id" title="var">ppt'</span>) (<span class="id" title="var">ppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) = <span class="id" title="var">ppt'</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">FlattenedHIT</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Wtil_rec</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span>} {<span class="id" title="var">D</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) &lt;~&gt; <span class="id" title="var">C</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">Q</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">cct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> (<span class="id" title="var">x</span> : <span class="id" title="var">C</span> <span class="id" title="var">a</span>), <span class="id" title="var">Q</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">ppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> (<span class="id" title="var">y</span> : <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)), <span class="id" title="var">cct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> = <span class="id" title="var">cct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">Wtil</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> -&gt; <span class="id" title="var">Q</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Wtil_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span>) <span class="id" title="var">cct'</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">transport_const</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ppt'</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Wtil_rec_beta_ppt</span><br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span>} {<span class="id" title="var">D</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) &lt;~&gt; <span class="id" title="var">C</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">Q</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">cct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> (<span class="id" title="var">x</span> : <span class="id" title="var">C</span> <span class="id" title="var">a</span>), <span class="id" title="var">Q</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">ppt'</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)), <span class="id" title="var">cct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> = <span class="id" title="var">cct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">y</span>: <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">ap</span> (@<span class="id" title="var">Wtil_rec</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">Q</span> <span class="id" title="var">cct'</span> <span class="id" title="var">ppt'</span>) (<span class="id" title="var">ppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) = <span class="id" title="var">ppt'</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Wtil_rec</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">cancelL</span> (<span class="id" title="var">transport_const</span> (<span class="id" title="var">ppt</span> (<span class="id" title="var">C</span>:=<span class="id" title="var">C</span>) <span class="id" title="var">b</span> <span class="id" title="var">y</span>) <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">apD_const</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">Wtil_ind</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span>) <span class="id" title="var">cct'</span> <span class="id" title="var">_</span>) (<span class="id" title="var">ppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Wtil_ind_beta_ppt</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Now we define the fibration over it that we will be considering the total space of. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">AssumeAxioms</span>.<br/>
<span class="id" title="keyword">Context</span> `{<span class="id" title="var">Univalence</span>}.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span> <span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">C</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>} {<span class="id" title="var">D</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>, <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) &lt;~&gt; <span class="id" title="var">C</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>)}.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">W'</span> := <span class="id" title="var">Coeq</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">P</span> : <span class="id" title="var">W'</span> -&gt; <span class="id" title="keyword">Type</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Coeq_rec</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">C</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">path_universe</span> (<span class="id" title="var">D</span> <span class="id" title="var">b</span>)).<br/>

<br/>
</div>

<div class="doc">
Now we give the total space the same structure as <span class="inlinecode"><span class="id" title="var">Wtil</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">sWtil</span> := { <span class="id" title="var">w</span>:<span class="id" title="var">W'</span> &amp; <span class="id" title="var">P</span> <span class="id" title="var">w</span> }.<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">scct</span> (<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">C</span> <span class="id" title="var">a</span>) : <span class="id" title="var">sWtil</span> := (<span class="id" title="var">exist</span> <span class="id" title="var">P</span> (<span class="id" title="var">coeq</span> <span class="id" title="var">a</span>) <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">sppt</span> (<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">y</span>:<span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)) : <span class="id" title="var">scct</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> = <span class="id" title="var">scct</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">path_sigma'</span> <span class="id" title="var">P</span> (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transport_path_universe'</span> <span class="id" title="var">P</span> (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Coeq_rec_beta_cglue</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">C</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b0</span> =&gt; <span class="id" title="var">path_universe</span> (<span class="id" title="var">D</span> <span class="id" title="var">b0</span>)) <span class="id" title="var">b</span>) <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
Here is the dependent eliminator 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sWtil_ind</span> (<span class="id" title="var">Q</span> : <span class="id" title="var">sWtil</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">scct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>, <span class="id" title="var">Q</span> (<span class="id" title="var">scct</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">sppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>, (<span class="id" title="var">sppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) # (<span class="id" title="var">scct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span>) = <span class="id" title="var">scct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">w</span>, <span class="id" title="var">Q</span> <span class="id" title="var">w</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sig_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Coeq_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>:<span class="id" title="var">P</span> <span class="id" title="var">w</span>, <span class="id" title="var">Q</span> (<span class="id" title="var">w</span>;<span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">scct'</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">dpath_forall</span> <span class="id" title="var">P</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">Q</span> (<span class="id" title="var">a</span>;<span class="id" title="var">b</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">scct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)) (<span class="id" title="var">scct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">q</span> := <span class="id" title="var">transport_path_universe'</span> <span class="id" title="var">P</span> (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Coeq_rec_beta_cglue</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">C</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b0</span> : <span class="id" title="var">B</span> =&gt; <span class="id" title="var">path_universe</span> (<span class="id" title="var">D</span> <span class="id" title="var">b0</span>)) <span class="id" title="var">b</span>) <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transportD_is_transport</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">apD</span> (<span class="id" title="var">scct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>)) <span class="id" title="var">q</span>^).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">moveL_transport_V</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Q</span> (<span class="id" title="var">scct</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) <span class="id" title="var">x</span>)) <span class="id" title="var">q</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_compose</span>, &lt;- <span class="id" title="var">transport_pp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">sppt'</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap10</span>, <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">whiskerL</span> <span class="id" title="var">_</span> (<span class="id" title="var">ap_exist</span> <span class="id" title="var">P</span> (<span class="id" title="var">coeq</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">path_sigma_p1_1p'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The eliminator computes on the point constructor. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sWtil_ind_beta_cct</span> (<span class="id" title="var">Q</span> : <span class="id" title="var">sWtil</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">scct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>, <span class="id" title="var">Q</span> (<span class="id" title="var">scct</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">sppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>, (<span class="id" title="var">sppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) # (<span class="id" title="var">scct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span>) = <span class="id" title="var">scct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">C</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">sWtil_ind</span> <span class="id" title="var">Q</span> <span class="id" title="var">scct'</span> <span class="id" title="var">sppt'</span> (<span class="id" title="var">scct</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>) = <span class="id" title="var">scct'</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;:= 1.<br/>

<br/>
</div>

<div class="doc">
This would be its propositional computation rule on the path constructor... 
<div class="paragraph"> </div>

<pre>
Definition sWtil_ind_beta_ppt (Q : sWtil -&gt; Type)
  (scct' : forall a x, Q (scct a x))
  (sppt' : forall b y, (sppt b y) # (scct' (f b) y) = scct' (g b) (D b y))
  (b:B) (y:C (f b))
  : apD (sWtil_ind Q scct' sppt') (sppt b y) = sppt' b y.
Proof.
  unfold sWtil_ind.
  (** ... but it's a doozy! *)
Abort.
</pre>

<div class="paragraph"> </div>

 Fortunately, it turns out to be enough to have the computation rule for the *non-dependent* eliminator! 
<div class="paragraph"> </div>

 We could define that in terms of the dependent one, as usual...
<pre>
Definition sWtil_rec (P : Type)
  (scct' : forall a (x : C a), P)
  (sppt' : forall b (y : C (f b)), scct' (f b) y = scct' (g b) (D b y))
  : sWtil -&gt; P
  := sWtil_ind (fun _ =&gt; P) scct' (fun b y =&gt; transport_const _ _ @ sppt' b y).
</pre>

<div class="paragraph"> </div>

 ...but if we define it diindly, then it's easier to reason about. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sWtil_rec</span> (<span class="id" title="var">Q</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">scct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> (<span class="id" title="var">x</span> : <span class="id" title="var">C</span> <span class="id" title="var">a</span>), <span class="id" title="var">Q</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">sppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> (<span class="id" title="var">y</span> : <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)), <span class="id" title="var">scct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> = <span class="id" title="var">scct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">sWtil</span> -&gt; <span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sig_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Coeq_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">w</span> =&gt; <span class="id" title="var">P</span> <span class="id" title="var">w</span> -&gt; <span class="id" title="var">Q</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">scct'</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">dpath_arrow</span> <span class="id" title="var">P</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">transport_const</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">sppt'</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">transport_path_universe'</span> <span class="id" title="var">P</span> (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">Coeq_rec_beta_cglue</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">long_path_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sWtil_rec_beta_ppt</span> (<span class="id" title="var">Q</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">scct'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> (<span class="id" title="var">x</span> : <span class="id" title="var">C</span> <span class="id" title="var">a</span>), <span class="id" title="var">Q</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">sppt'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> (<span class="id" title="var">y</span> : <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>)), <span class="id" title="var">scct'</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> = <span class="id" title="var">scct'</span> (<span class="id" title="var">g</span> <span class="id" title="var">b</span>) (<span class="id" title="var">D</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">b</span>:<span class="id" title="var">B</span>) (<span class="id" title="var">y</span>: <span class="id" title="var">C</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">ap</span> (<span class="id" title="var">sWtil_rec</span> <span class="id" title="var">Q</span> <span class="id" title="var">scct'</span> <span class="id" title="var">sppt'</span>) (<span class="id" title="var">sppt</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>) = <span class="id" title="var">sppt'</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">sWtil_rec</span>, <span class="id" title="var">sppt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<span class="id" title="var">ap_sig_rec_path_sigma</span> <span class="id" title="var">W'</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (@<span class="id" title="var">Coeq_ind_beta_cglue</span> <span class="id" title="var">B</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">ap10_dpath_arrow</span> <span class="id" title="var">P</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Q</span>) (<span class="id" title="var">cglue</span> <span class="id" title="var">b</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_pp</span>.<br/>
</div>

<div class="doc">
Now everything cancels! 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_V</span>, <span class="id" title="var">concat_pV_p</span>, <span class="id" title="var">concat_pV_p</span>, <span class="id" title="var">concat_pV_p</span>, <span class="id" title="var">concat_Vp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_1p</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">long_path_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Woot! 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_flattening</span> : <span class="id" title="var">Wtil</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> &lt;~&gt; <span class="id" title="var">sWtil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
</div>

<div class="doc">
The maps back and forth are obtained easily from the non-dependent eliminators. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_adjointify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Wtil_rec</span> <span class="id" title="var">_</span> <span class="id" title="var">scct</span> <span class="id" title="var">sppt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">sWtil_rec</span> <span class="id" title="var">_</span> <span class="id" title="var">cct</span> <span class="id" title="var">ppt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
</div>

<div class="doc">
The two homotopies are completely symmetrical, using the *dependent* eliminators, but only the computation rules for the non-dependent ones. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> (<span class="id" title="var">sWtil_ind</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> =&gt; 1) <span class="id" title="var">_</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dpath_path_FFlr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_1p</span>, <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">sWtil_rec_beta_ppt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> (@<span class="id" title="var">Wtil_rec_beta_ppt</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> (<span class="id" title="var">Wtil_ind</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> =&gt; 1) <span class="id" title="var">_</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dpath_path_FFlr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_1p</span>, <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Wtil_rec_beta_ppt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">sWtil_rec_beta_ppt</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">AssumeAxioms</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>