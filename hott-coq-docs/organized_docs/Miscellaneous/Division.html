<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Division</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Division</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Basics.Overture</span> <span class="id" title="var">Basics.Tactics</span> <span class="id" title="var">Basics.Trunc</span> <span class="id" title="var">Basics.Classes</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Basics.PathGroupoids</span> <span class="id" title="var">Basics.Equivalences</span> <span class="id" title="var">Types.Sigma</span> <span class="id" title="var">Spaces.Nat.Core</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Basics.Decidable</span> <span class="id" title="var">Basics.Iff</span> <span class="id" title="var">Types.Prod</span> <span class="id" title="var">List.Theory</span> <span class="id" title="var">Types.Sum</span> <span class="id" title="var">Types.Arrow</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Minimization</span> <span class="id" title="var">ToSet</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1536"></a><h1 class="section">Division of natural numbers</h1>

<div class="paragraph"> </div>

<a id="lab1537"></a><h2 class="section">Divisibility</h2>

<div class="paragraph"> </div>

 We define divisibility as a relation between natural numbers. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">NatDivides</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Type0</span> := <span class="id" title="var">nat_divides</span> : {<span class="id" title="var">k</span> : <span class="id" title="var">nat</span> &amp; <span class="id" title="var">k</span> * <span class="id" title="var">n</span> = <span class="id" title="var">m</span>}.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;( n | m )" := (<span class="id" title="var">NatDivides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) : <span class="id" title="var">nat_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Any number divides <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_zero_r</span> <span class="id" title="var">n</span> : (<span class="id" title="var">n</span> | 0)<br/>
&nbsp;&nbsp;:= (0; <span class="id" title="var">idpath</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">1</span> divides any number. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_one_l</span> <span class="id" title="var">n</span> : (1 | <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= (<span class="id" title="var">n</span>; <span class="id" title="var">nat_mul_one_r</span> <span class="id" title="var">_</span>).<br/>

<br/>
</div>

<div class="doc">
Any number divides itself. Divisibility is a reflexive relation. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_refl</span> <span class="id" title="var">n</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= (1; <span class="id" title="var">nat_mul_one_l</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">reflexive_nat_divides</span> : <span class="id" title="var">Reflexive</span> <span class="id" title="var">NatDivides</span> := <span class="id" title="var">nat_divides_refl</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility is transitive. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_trans</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span>} : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">m</span> | <span class="id" title="var">l</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>] [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">y</span> * <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">nat_divides_trans</span> : <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">transitive_nat_divides</span> : <span class="id" title="var">Transitive</span> <span class="id" title="var">NatDivides</span> := @<span class="id" title="var">nat_divides_trans</span>.<br/>

<br/>
</div>

<div class="doc">
A left factor divides a product. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_mul_l'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">n</span> * <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;:= (<span class="id" title="var">m</span>; <span class="id" title="var">nat_mul_comm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>

<br/>
</div>

<div class="doc">
A right factor divides a product. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_mul_r'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">m</span> | <span class="id" title="var">n</span> * <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;:= (<span class="id" title="var">n</span>; <span class="id" title="var">idpath</span>).<br/>

<br/>
</div>

<div class="doc">
Divisibility of the product is implied by divisibility of the left factor. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_mul_l</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} <span class="id" title="var">l</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span> * <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">nat_divides_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility of the product is implied by divisibility of the right factor. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_mul_r</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} <span class="id" title="var">l</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">l</span> * <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">nat_divides_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
Multiplication is monotone with respect to divisibility. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_mul_monotone</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">l</span> | <span class="id" title="var">p</span>) -&gt; (<span class="id" title="var">n</span> * <span class="id" title="var">l</span> | <span class="id" title="var">m</span> * <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">r</span>] [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> * <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>, <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">nat_mul</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility of the sum is implied by divisibility of the summands. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_add</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">l</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span> + <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>] [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_dist_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">n</span></span> divides a sum and the left summand, then <span class="inlinecode"><span class="id" title="var">n</span></span> divides the right summand. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_add_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span> + <span class="id" title="var">l</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>] [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">y</span> - <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_dist_sub_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">n</span></span> divides a sum and the right summand, then <span class="inlinecode"><span class="id" title="var">n</span></span> divides the left summand. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_add_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">l</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span> + <span class="id" title="var">l</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_add_comm</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_divides_add_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility of the difference is implied by divisibility of the minuend and subtrahend. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_sub</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">l</span>) -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span> - <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>] [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> - <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_dist_sub_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The divisor is greater than zero when the divident is greater than zero. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gt_zero_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">d</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>)) (<span class="id" title="var">gt0</span> : 0 &lt; <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;: 0 &lt; <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> | <span class="id" title="var">s</span>].<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;remaining&nbsp;case&nbsp;is&nbsp;impossible.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gt0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gt0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">gt0</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility implies that the divisor is less than or equal to the dividend. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">leq_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">m</span> -&gt; (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">n</span> &lt;= <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>, <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">contradiction</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">leq_mul_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The divisor is strictly less than the dividend when the other factor is greater than one. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">d</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>)) (<span class="id" title="var">gt0</span> : 0 &lt; <span class="id" title="var">m</span>) (<span class="id" title="var">gt1</span> : 1 &lt; <span class="id" title="var">d</span>.1)<br/>
&nbsp;&nbsp;: <span class="id" title="var">n</span> &lt; <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">d</span>.2.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">lt_leq_lt_trans</span> (<span class="id" title="var">m</span>:=1*<span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;1: <span class="id" title="var">rapply</span> (<span class="id" title="var">leq_mul_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0).<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> (<span class="id" title="var">nat_mul_r_strictly_monotone</span> (<span class="id" title="var">l</span>:=0)).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">gt_zero_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility is antisymmetric 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_antisym</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">m</span> | <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">H2</span>.2^ @ <span class="id" title="var">nat_mul_zero_r</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> ((<span class="id" title="var">nat_mul_zero_r</span> <span class="id" title="var">_</span>)^ @ <span class="id" title="var">H1</span>.2).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">leq_antisym</span>; <span class="id" title="var">nrapply</span> <span class="id" title="var">leq_divides</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">antisymmetric_divides</span> : <span class="id" title="var">AntiSymmetric</span> <span class="id" title="var">NatDivides</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">nat_divides_antisym</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">n</span></span> divides <span class="inlinecode"><span class="id" title="var">m</span></span>, then the other factor also divides <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">divides_divisor</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>)) : (<span class="id" title="var">H</span>.1 | <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.2.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1538"></a><h2 class="section">Properties of division</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">nat_div_mod_unique_helper</span> <span class="id" title="var">b</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">r1</span> &lt; <span class="id" title="var">b</span> -&gt; <span class="id" title="var">r2</span> &lt; <span class="id" title="var">b</span> -&gt; <span class="id" title="var">q1</span> &lt; <span class="id" title="var">q2</span> -&gt; <span class="id" title="var">b</span> * <span class="id" title="var">q1</span> + <span class="id" title="var">r1</span> &lt;&gt; <span class="id" title="var">b</span> * <span class="id" title="var">q2</span> + <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span> <span class="id" title="var">H3</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 (<span class="id" title="var">nat_add_comm</span> (<span class="id" title="var">b</span> * <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveL_nV</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_sub_l_add_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="var">only</span> 2: <span class="id" title="var">rapply</span> <span class="id" title="var">nat_mul_l_monotone</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_dist_sub_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_add_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">snd</span> (@<span class="id" title="var">leq_iff_not_gt</span> <span class="id" title="var">b</span> (<span class="id" title="var">r1</span> - <span class="id" title="var">r2</span>))).<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> (<span class="id" title="var">lt_leq_lt_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">leq_mul_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_lt_lt_sub</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Quotients and remainders are uniquely determined. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mod_unique</span> <span class="id" title="var">d</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">r1</span> &lt; <span class="id" title="var">d</span> -&gt; <span class="id" title="var">r2</span> &lt; <span class="id" title="var">d</span> -&gt; <span class="id" title="var">d</span> * <span class="id" title="var">q1</span> + <span class="id" title="var">r1</span> = <span class="id" title="var">d</span> * <span class="id" title="var">q2</span> + <span class="id" title="var">r2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">q1</span> = <span class="id" title="var">q2</span> /\ <span class="id" title="var">r1</span> = <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_trichotomy</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">q</span> | <span class="id" title="var">q</span>] | <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">contradiction</span> (<span class="id" title="var">nat_div_mod_unique_helper</span> <span class="id" title="var">d</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">isinj_nat_add_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">contradiction</span> (<span class="id" title="var">nat_div_mod_unique_helper</span> <span class="id" title="var">d</span> <span class="id" title="var">q2</span> <span class="id" title="var">q1</span> <span class="id" title="var">r2</span> <span class="id" title="var">r1</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility by a positive natural number is a hprop. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_nat_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">n</span> -&gt; <span class="id" title="var">IsHProp</span> (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">hprop_allpath</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>] [<span class="id" title="var">y</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">path_sigma_hprop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span>]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> ((<span class="id" title="var">nat_mul_one_r</span> <span class="id" title="var">_</span>)^ @ <span class="id" title="var">p</span> @ <span class="id" title="var">q</span>^ @ <span class="id" title="var">nat_mul_one_r</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">nat_div_mod_unique</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">x</span> <span class="id" title="var">y</span> 0 0 <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 (<span class="id" title="var">nat_mul_comm</span> <span class="id" title="var">n</span>.+1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> @ <span class="id" title="var">q</span>^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
This specifies the behaviour of <span class="inlinecode"><span class="id" title="var">nat_div_mod_helper</span></span> when <span class="inlinecode"><span class="id" title="var">u</span></span> <span class="inlinecode">&lt;=</span> <span class="inlinecode"><span class="id" title="var">y</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mod_helper_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">q</span> <span class="id" title="var">u</span> (<span class="id" title="var">H</span> : <span class="id" title="var">u</span> &lt;= <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">let</span> (<span class="id" title="var">q'</span>, <span class="id" title="var">u'</span>) := <span class="id" title="var">nat_div_mod</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">q</span> <span class="id" title="var">u</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> + <span class="id" title="var">y</span>.+1 * <span class="id" title="var">q</span> + (<span class="id" title="var">y</span> - <span class="id" title="var">u</span>) = <span class="id" title="var">y</span>.+1 * <span class="id" title="var">q'</span> + (<span class="id" title="var">y</span> - <span class="id" title="var">u'</span>) /\ <span class="id" title="var">u'</span> &lt;= <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">IHx</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">y</span>, <span class="id" title="var">q</span>, <span class="id" title="var">u</span>, <span class="id" title="var">H</span>, <span class="id" title="var">d</span>, <span class="id" title="var">r</span> |- *; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">u</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHx</span> <span class="id" title="var">y</span> <span class="id" title="var">q</span>.+1 <span class="id" title="var">y</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">H'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">p</span>, <span class="id" title="var">nat_sub_zero_r</span>, <span class="id" title="var">nat_sub_cancel</span>, <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_add_succ_r</span>, &lt;- 2 <span class="id" title="var">nat_add_assoc</span>, <span class="id" title="var">nat_mul_succ_r</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHx</span> <span class="id" title="var">y</span> <span class="id" title="var">q</span> <span class="id" title="var">u</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">H'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">p</span>, 2 <span class="id" title="var">nat_add_succ_l</span>, &lt;- <span class="id" title="var">nat_add_succ_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_sub_succ_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_succ_pred</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">lt_moveL_nV</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Division and modulo can be put in quotient-remainder form. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span> * (<span class="id" title="var">x</span> / <span class="id" title="var">y</span>) + <span class="id" title="var">x</span> <span class="id" title="var">mod</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span>]; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">p</span> := <span class="id" title="var">fst</span> (<span class="id" title="var">nat_div_mod_helper_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> 0 <span class="id" title="var">y</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>, <span class="id" title="var">nat_sub_cancel</span>, 2 <span class="id" title="var">nat_add_zero_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mod_spec'</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">x</span> - <span class="id" title="var">y</span> * (<span class="id" title="var">x</span> / <span class="id" title="var">y</span>) = <span class="id" title="var">x</span> <span class="id" title="var">mod</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mod_spec''</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">x</span> - <span class="id" title="var">x</span> <span class="id" title="var">mod</span> <span class="id" title="var">y</span> = <span class="id" title="var">y</span> * (<span class="id" title="var">x</span> / <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_lt_r'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">r</span> : <span class="id" title="var">r</span> &lt; <span class="id" title="var">m</span> -&gt; <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span> &lt; <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">lt_leq_lt_trans</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">m</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">nat_mod_lt_r'</span> : <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> modulo <span class="inlinecode"><span class="id" title="var">m</span></span> is less than <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_mod_lt_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">m</span> -&gt; <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span> &lt; <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">nat_mod_lt_r'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> 0.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> modulo <span class="inlinecode"><span class="id" title="var">m</span></span> is less than or equal to <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_mod_leq_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span> &lt;= <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_div_mod_spec'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">leq_moveR_nV</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Division is unique. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_unique</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> (<span class="id" title="var">H</span> : <span class="id" title="var">r</span> &lt; <span class="id" title="var">y</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">y</span> * <span class="id" title="var">q</span> + <span class="id" title="var">r</span> = <span class="id" title="var">x</span>) : <span class="id" title="var">x</span> / <span class="id" title="var">y</span> = <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">fst</span> (<span class="id" title="var">nat_div_mod_unique</span> <span class="id" title="var">y</span> (<span class="id" title="var">x</span> / <span class="id" title="var">y</span>) <span class="id" title="var">q</span> (<span class="id" title="var">x</span> <span class="id" title="var">mod</span> <span class="id" title="var">y</span>) <span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">p</span> @ <span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)^).<br/>

<br/>
</div>

<div class="doc">
Modulo is unique. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_unique</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> (<span class="id" title="var">H</span> : <span class="id" title="var">r</span> &lt; <span class="id" title="var">y</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">y</span> * <span class="id" title="var">q</span> + <span class="id" title="var">r</span> = <span class="id" title="var">x</span>) : <span class="id" title="var">x</span> <span class="id" title="var">mod</span> <span class="id" title="var">y</span> = <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">snd</span> (<span class="id" title="var">nat_div_mod_unique</span> <span class="id" title="var">y</span> (<span class="id" title="var">x</span> / <span class="id" title="var">y</span>) <span class="id" title="var">q</span> (<span class="id" title="var">x</span> <span class="id" title="var">mod</span> <span class="id" title="var">y</span>) <span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">p</span> @ <span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)^).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">0</span> divided by any number is <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_zero_l</span> <span class="id" title="var">n</span> : 0 / <span class="id" title="var">n</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> divided by <span class="inlinecode">0</span> is <span class="inlinecode">0</span> by convention. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_zero_r</span> <span class="id" title="var">n</span> : <span class="id" title="var">n</span> / 0 = 0 := <span class="id" title="var">idpath</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> divided by <span class="inlinecode">1</span> is <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_one_r</span> <span class="id" title="var">n</span> : <span class="id" title="var">n</span> / 1 = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_one_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> divided by <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode">1</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_cancel</span> <span class="id" title="var">n</span> : 0 &lt; <span class="id" title="var">n</span> -&gt; <span class="id" title="var">n</span> / <span class="id" title="var">n</span> = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [|<span class="id" title="var">m</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">nat_div_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0); <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_one_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A number divided by a larger number is 0. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_lt</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">n</span> &lt; <span class="id" title="var">m</span> -&gt; <span class="id" title="var">n</span> / <span class="id" title="var">m</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">nat_div_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>, <span class="id" title="var">nat_add_zero_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span> divided by <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mul_cancel_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">n</span> -&gt; (<span class="id" title="var">n</span> * <span class="id" title="var">m</span>) / <span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">nat_div_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span> divided by <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mul_cancel_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">m</span> -&gt; (<span class="id" title="var">n</span> * <span class="id" title="var">m</span>) / <span class="id" title="var">m</span> = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mul_cancel_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
More generally, <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">k</span></span> divided by <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode">/</span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mul_add_cancel_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : 0 &lt; <span class="id" title="var">n</span> -&gt; (<span class="id" title="var">n</span> * <span class="id" title="var">m</span> + <span class="id" title="var">k</span>) / <span class="id" title="var">n</span> = <span class="id" title="var">m</span> + <span class="id" title="var">k</span> / <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">nat_div_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">k</span> <span class="id" title="var">mod</span> <span class="id" title="var">n</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_dist_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mul_add_cancel_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : 0 &lt; <span class="id" title="var">m</span> -&gt; (<span class="id" title="var">n</span> * <span class="id" title="var">m</span> + <span class="id" title="var">k</span>) / <span class="id" title="var">m</span> = <span class="id" title="var">n</span> + <span class="id" title="var">k</span> / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mul_add_cancel_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">k</span></span> is positive, then multiplication on the left is injective; that is, if <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">n</span></span>, then <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isinj_nat_mul_l</span> <span class="id" title="var">k</span> : 0 &lt; <span class="id" title="var">k</span> -&gt; <span class="id" title="var">IsInjective</span> (<span class="id" title="var">nat_mul</span> <span class="id" title="var">k</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kp</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">nat_div_mul_cancel_l</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">nat_div_mul_cancel_l</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> / <span class="id" title="var">k</span>) <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">k</span></span> is positive, then multiplication on the right is injective; that is, if <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">k</span></span>, then <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isinj_nat_mul_r</span> <span class="id" title="var">k</span> : 0 &lt; <span class="id" title="var">k</span> -&gt; <span class="id" title="var">IsInjective</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">nat_mul</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">kp</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">nat_div_mul_cancel_r</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">nat_div_mul_cancel_r</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> / <span class="id" title="var">k</span>) <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
When <span class="inlinecode"><span class="id" title="var">d</span></span> divides one of the summands, division distributes over addition. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_dist</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">d</span> | <span class="id" title="var">n</span>) -&gt; (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) / <span class="id" title="var">d</span> = <span class="id" title="var">n</span> / <span class="id" title="var">d</span> + <span class="id" title="var">m</span> / <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> []].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_div_mul_cancel_r</span>. 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_mul_add_cancel_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_dist'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">d</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) / <span class="id" title="var">d</span> = <span class="id" title="var">n</span> / <span class="id" title="var">d</span> + <span class="id" title="var">m</span> / <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_add_comm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_dist</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
In general, <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">*</span> <span class="inlinecode">(<span class="id" title="var">m</span></span> <span class="inlinecode">/</span> <span class="inlinecode"><span class="id" title="var">n</span>)</span> is less than or equal to <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_leq_mul_div_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">n</span> * (<span class="id" title="var">m</span> / <span class="id" title="var">n</span>) &lt;= <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">tmp</span> := <span class="id" title="var">n</span> * (<span class="id" title="var">m</span> / <span class="id" title="var">n</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">tmp</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">tmp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
When <span class="inlinecode"><span class="id" title="var">n</span></span> divides <span class="inlinecode"><span class="id" title="var">m</span></span>, they are equal. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mul_div_cancel_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">m</span> / <span class="id" title="var">n</span>) * <span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">k</span> []]. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mul_zero_r</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">k</span> []].<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_mul_cancel_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mul_div_cancel_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">n</span> * (<span class="id" title="var">m</span> / <span class="id" title="var">n</span>) = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mul_div_cancel_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Division by non-zero <span class="inlinecode"><span class="id" title="var">k</span></span> is strictly monotone if <span class="inlinecode"><span class="id" title="var">k</span></span> divides the larger number. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_strictly_monotone_r</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span>} <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">l</span> &lt; <span class="id" title="var">k</span> -&gt; <span class="id" title="var">n</span> &lt; <span class="id" title="var">m</span> -&gt; (<span class="id" title="var">k</span> | <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">n</span> / <span class="id" title="var">k</span> &lt; <span class="id" title="var">m</span> / <span class="id" title="var">k</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">lk</span> <span class="id" title="var">nm</span> <span class="id" title="var">km</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">gt_iff_not_leq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">mknk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">gt_iff_not_leq</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>); <span class="id" title="var">only</span> 1: <span class="id" title="tactic">apply</span> <span class="id" title="var">nm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">nat_mul_div_cancel_l</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span> <span class="id" title="var">km</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">leq_trans</span> (<span class="id" title="var">y</span>:=<span class="id" title="var">k</span> * (<span class="id" title="var">n</span> / <span class="id" title="var">k</span>))).<br/>
&nbsp;&nbsp;- <span class="id" title="var">rapply</span> <span class="id" title="var">nat_mul_l_monotone</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_leq_mul_div_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">0</span> modulo <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_zero_l</span> <span class="id" title="var">n</span> : 0 <span class="id" title="var">mod</span> <span class="id" title="var">n</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_sub_cancel</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> modulo <span class="inlinecode">0</span> is <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_zero_r</span> <span class="id" title="var">n</span> : <span class="id" title="var">n</span> <span class="id" title="var">mod</span> 0 = <span class="id" title="var">n</span> := <span class="id" title="var">idpath</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_lt</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> : <span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span> -&gt; <span class="id" title="var">k</span> <span class="id" title="var">mod</span> <span class="id" title="var">n</span> = <span class="id" title="var">k</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_div_mod_spec'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_div_lt</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_sub_zero_r</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> modulo <span class="inlinecode">1</span> is <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_one_r</span> <span class="id" title="var">n</span> : <span class="id" title="var">n</span> <span class="id" title="var">mod</span> 1 = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">m</span></span> divides <span class="inlinecode"><span class="id" title="var">n</span></span>, then <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">mod</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">m</span> | <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mul_zero_r</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_div_mod_spec'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_div_mul_cancel_r</span>; <span class="id" title="var">only</span> 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span>, <span class="id" title="var">nat_mul_comm</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">mod</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span> iff <span class="inlinecode"><span class="id" title="var">m</span></span> divides <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_iff_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span> = 0 &lt;-&gt; (<span class="id" title="var">m</span> | <span class="id" title="var">n</span>) .<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> (<span class="id" title="var">nat_mod_divides</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">n</span> / <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Divisibility is therefore decidable. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">decidable_nat_divides</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">Decidable</span> (<span class="id" title="var">n</span> | <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">decidable_iff</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mod_iff_divides</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">n</span></span> modulo <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_cancel</span> <span class="id" title="var">n</span> : <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">n</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">nat_mod_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 1); <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_one_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A number can be corrected so that it is divisible by subtracting the modulo. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_sub_mod</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">n</span> | <span class="id" title="var">m</span> - <span class="id" title="var">m</span> <span class="id" title="var">mod</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_div_mod_spec''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1539"></a><h2 class="section">Further Properties of division and modulo</h2>

<div class="paragraph"> </div>

 We can cancel common factors on the left in a division. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_cancel_mul_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;: 0 &lt; <span class="id" title="var">k</span> -&gt; (<span class="id" title="var">k</span> * <span class="id" title="var">n</span>) / (<span class="id" title="var">k</span> * <span class="id" title="var">m</span>) = <span class="id" title="var">n</span> / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">kp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">mp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">nat_div_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">k</span> * (<span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span>))).<br/>
&nbsp;&nbsp;1: <span class="id" title="var">rapply</span> <span class="id" title="var">nat_mul_l_strictly_monotone</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_dist_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can cancel common factors on the right in a division. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_cancel_mul_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;: 0 &lt; <span class="id" title="var">k</span> -&gt; (<span class="id" title="var">n</span> * <span class="id" title="var">k</span>) / (<span class="id" title="var">m</span> * <span class="id" title="var">k</span>) = <span class="id" title="var">n</span> / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 (<span class="id" title="var">nat_mul_comm</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_div_cancel_mul_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can swap the order of division and multiplication on the left under certain conditions. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mul_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : (<span class="id" title="var">m</span> | <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">k</span> * (<span class="id" title="var">n</span> / <span class="id" title="var">m</span>) = (<span class="id" title="var">k</span> * <span class="id" title="var">n</span>) / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">mp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_mul_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">nat_div_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> * <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;1: <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_mod_divides</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can swap the order of division and multiplication on the right under certain conditions. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_mul_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : (<span class="id" title="var">m</span> | <span class="id" title="var">n</span>) -&gt; (<span class="id" title="var">n</span> / <span class="id" title="var">m</span>) * <span class="id" title="var">k</span> = (<span class="id" title="var">n</span> * <span class="id" title="var">k</span>) / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 (<span class="id" title="var">nat_mul_comm</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">nat_div_mul_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_sub_mod</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">n</span> / <span class="id" title="var">m</span> = (<span class="id" title="var">n</span> - <span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span>) / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">mp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_div_mod_spec''</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_mul_cancel_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Dividing a quotient is the same as dividing by the product of the divisors. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_div_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : (<span class="id" title="var">n</span> / <span class="id" title="var">m</span>) / <span class="id" title="var">k</span> = <span class="id" title="var">n</span> / (<span class="id" title="var">m</span> * <span class="id" title="var">k</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">k</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">kp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">mp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_div_zero_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_unique</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">r</span> := (<span class="id" title="var">n</span> <span class="id" title="var">mod</span> (<span class="id" title="var">m</span> * <span class="id" title="var">k</span>)) / <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">lt_lt_leq_trans</span> (<span class="id" title="var">m</span>:=(<span class="id" title="var">m</span> * <span class="id" title="var">k</span>)/<span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_strictly_monotone_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">nat_mod_lt_r'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">nat_mul_strictly_monotone</span> <span class="id" title="var">mp</span> <span class="id" title="var">kp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_div_mul_cancel_l</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> ((<span class="id" title="var">m</span> * (<span class="id" title="var">k</span> * (<span class="id" title="var">n</span> / (<span class="id" title="var">m</span> * <span class="id" title="var">k</span>)))) / <span class="id" title="var">m</span> + (<span class="id" title="var">n</span> <span class="id" title="var">mod</span> (<span class="id" title="var">m</span> * <span class="id" title="var">k</span>)) / <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_mul_cancel_l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_div_dist</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> / <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Dividing a number by a quotient is the same as dividing the product of the number with the denominator of the quotient by the numerator of the quotient. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_div_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : (<span class="id" title="var">k</span> | <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">n</span> / (<span class="id" title="var">m</span> / <span class="id" title="var">k</span>) = (<span class="id" title="var">n</span> * <span class="id" title="var">k</span>) / <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">k</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">kp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>, <span class="id" title="var">nat_div_zero_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_div_cancel_mul_r</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_mul_cancel_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A variant of <span class="inlinecode"><span class="id" title="var">nat_div_div_r</span></span> without the divisibility assumption, by modifying <span class="inlinecode"><span class="id" title="var">m</span></span> to become divisible. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_div_div_r'</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <span class="id" title="var">n</span> / (<span class="id" title="var">m</span> / <span class="id" title="var">k</span>) = (<span class="id" title="var">n</span> * <span class="id" title="var">k</span>) / (<span class="id" title="var">m</span> - <span class="id" title="var">m</span> <span class="id" title="var">mod</span> <span class="id" title="var">k</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_div_sub_mod</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_div_div_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can cancel common factors on the left in a modulo. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_mul_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">k</span> * <span class="id" title="var">n</span>) <span class="id" title="var">mod</span> (<span class="id" title="var">k</span> * <span class="id" title="var">m</span>) = <span class="id" title="var">k</span> * (<span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">k</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">kp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_zero_or_gt_zero</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [[] | <span class="id" title="var">mp</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_mod_unique</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">n</span> / <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;1: <span class="id" title="var">rapply</span> <span class="id" title="var">nat_mul_l_strictly_monotone</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_dist_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_div_mod_spec</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can cancel common factors on the right in a modulo. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_mod_mul_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">n</span> * <span class="id" title="var">k</span>) <span class="id" title="var">mod</span> (<span class="id" title="var">m</span> * <span class="id" title="var">k</span>) = (<span class="id" title="var">n</span> <span class="id" title="var">mod</span> <span class="id" title="var">m</span>) * <span class="id" title="var">k</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3 (<span class="id" title="var">nat_mul_comm</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mod_mul_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1540"></a><h2 class="section">Greatest Common Divisor</h2>

<div class="paragraph"> </div>

 The greatest common divisor of <span class="inlinecode">0</span> and a number is the number itself. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_zero_l</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat_gcd</span> 0 <span class="id" title="var">n</span> = <span class="id" title="var">n</span> := <span class="id" title="var">idpath</span>.<br/>

<br/>
</div>

<div class="doc">
The greatest common divisor of a number and <span class="inlinecode">0</span> is the number itself. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_zero_r</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> 0 = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_sub_cancel</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The greatest common divisor of <span class="inlinecode">1</span> and any number is <span class="inlinecode">1</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_one_l</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat_gcd</span> 1 <span class="id" title="var">n</span> = 1 := <span class="id" title="var">idpath</span>.<br/>

<br/>
</div>

<div class="doc">
The greatest common divisor of any number and <span class="inlinecode">1</span> is <span class="inlinecode">1</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_one_r</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> 1 = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_sub_succ_l</span>; <span class="id" title="var">only</span> 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_sub_cancel</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Idempotency. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_idem</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">nat_gcd</span>; <span class="id" title="tactic">fold</span> <span class="id" title="var">nat_gcd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mod_cancel</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can prove that the greatest common divisor of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> divides both <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span>. This proof requires strong induction. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_l_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> | <span class="id" title="var">n</span>) /\ (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> | <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>; <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_ind_strong</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">split</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHn</span> (<span class="id" title="var">m</span> <span class="id" title="var">mod</span> <span class="id" title="var">n</span>.+1) <span class="id" title="var">_</span> <span class="id" title="var">n</span>.+1) <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span> <span class="id" title="var">H2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">nat_gcd</span>; <span class="id" title="tactic">fold</span> <span class="id" title="var">nat_gcd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">n'</span> := <span class="id" title="var">n</span>.+1) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">r</span> := <span class="id" title="var">m</span> <span class="id" title="var">mod</span> <span class="id" title="var">n'</span>); <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span>); <span class="id" title="tactic">unfold</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The greatest common divisor of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> divides <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_l_gcd_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> | <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">fst</span> (<span class="id" title="var">nat_divides_l_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>

<br/>
</div>

<div class="doc">
The greatest common divisor of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> divides <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">divides_l_nat_gcd_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> | <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">snd</span> (<span class="id" title="var">nat_divides_l_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>

<br/>
</div>

<div class="doc">
We can prove that any common divisor of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> divides the greatest common divisor of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span>. It is in that sense the greatest. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_divides_r_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> : (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>) -&gt; (<span class="id" title="var">p</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">p</span> | <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>; <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_ind_strong</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">nat_gcd</span>; <span class="id" title="tactic">fold</span> <span class="id" title="var">nat_gcd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>; <span class="id" title="var">only</span> 1,3: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_div_mod_spec</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>.+1) <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_divides_add_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_r_iff_divides_r_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>) * (<span class="id" title="var">p</span> | <span class="id" title="var">m</span>) &lt;-&gt; (<span class="id" title="var">p</span> | <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; [<span class="id" title="tactic">intros</span> [<span class="id" title="var">H1</span> <span class="id" title="var">H2</span>] | <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">split</span>]; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">p</span></span> is divisible by all common divisors of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span>, and <span class="inlinecode"><span class="id" title="var">p</span></span> is also a common divisor, then it must necesserily be equal to the greatest common divisor. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_unique</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span>, (<span class="id" title="var">q</span> | <span class="id" title="var">n</span>) -&gt; (<span class="id" title="var">q</span> | <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">q</span> | <span class="id" title="var">p</span>))<br/>
&nbsp;&nbsp;: (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>) -&gt; (<span class="id" title="var">p</span> | <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_divides_antisym</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
As a corollary of uniquness, we get that the greatest common divisor operation is commutative. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_comm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_gcd_unique</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">nat_gcd</span></span> is associative. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_assoc</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>) = <span class="id" title="var">nat_gcd</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) <span class="id" title="var">k</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_unique</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_divides_r_gcd</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rapply</span> (<span class="id" title="var">nat_divides_trans</span> (<span class="id" title="var">nat_divides_l_gcd_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_divides_r_gcd</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">nat_divides_trans</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">nat_gcd</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> is <span class="inlinecode">0</span>, then <span class="inlinecode"><span class="id" title="var">n</span></span> must also be <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_is_zero_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = 0 -&gt; <span class="id" title="var">n</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (<span class="id" title="var">nat_divides_l_gcd_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span>^ @ <span class="id" title="var">nat_mul_zero_r</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">nat_gcd</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> is <span class="inlinecode">0</span>, then <span class="inlinecode"><span class="id" title="var">m</span></span> must also be <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_is_zero_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = 0 -&gt; <span class="id" title="var">m</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_gcd_is_zero_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">nat_gcd</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> is <span class="inlinecode">0</span> if and only if both <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> are <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_zero_iff_zero</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = 0 &lt;-&gt; <span class="id" title="var">n</span> = 0 /\ <span class="id" title="var">m</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_gcd_is_zero_l</span> <span class="id" title="var">_</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_gcd_is_zero_r</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [-&gt; -&gt;].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">nat_gcd</span></span> is positive for positive inputs. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_gcd_pos</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">n</span> -&gt; 0 &lt; <span class="id" title="var">m</span> -&gt; 0 &lt; <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_iff_not_geq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H3</span>; <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_zero_leq_zero_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_gcd_zero_iff_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> [-&gt;].<br/>
&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_l_add_r_mul</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat_gcd</span> (<span class="id" title="var">n</span> + <span class="id" title="var">k</span> * <span class="id" title="var">m</span>) <span class="id" title="var">m</span> = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_gcd_unique</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_divides_r_gcd</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">nat_divides_add_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">k</span> * <span class="id" title="var">m</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_r_add_r_mul</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> (<span class="id" title="var">m</span> + <span class="id" title="var">k</span> * <span class="id" title="var">n</span>) = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_l_add_r_mul</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_l_add_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat_gcd</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) <span class="id" title="var">m</span> = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">nat_gcd_l_add_r_mul</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_one_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_r_add_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> (<span class="id" title="var">m</span> + <span class="id" title="var">n</span>) = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_l_add_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_l_sub</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">m</span> &lt;= <span class="id" title="var">n</span> -&gt; <span class="id" title="var">nat_gcd</span> (<span class="id" title="var">n</span> - <span class="id" title="var">m</span>) <span class="id" title="var">m</span> = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_l_add_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_add_sub_l_cancel</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_gcd_r_sub</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">n</span> &lt;= <span class="id" title="var">m</span> -&gt; <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> (<span class="id" title="var">m</span> - <span class="id" title="var">n</span>) = <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_gcd_l_sub</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1541"></a><h2 class="section">Bezout's Identity</h2>

<div class="paragraph"> </div>

 Bezout's identity states that for any two numbers <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span>, their greatest common divisor can be written as a linear combination of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span>. This is easy to state for the integers, however since we are working with the natural numbers, we need to be more careful. This is why we write the linear combination as <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">d</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span> rather than the usual <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">d</span></span>. 
<div class="paragraph"> </div>

 We define a predicate for triples of integers satisfying Bezout's identity. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">d</span> : <span class="id" title="var">Type0</span><br/>
&nbsp;&nbsp;:= <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> * <span class="id" title="var">n</span> = <span class="id" title="var">d</span> + <span class="id" title="var">b</span> * <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Existing Class</span> <span class="id" title="var">NatBezout</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_bezout_refl_l</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> : <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> 1, 0.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode">1</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">m</span></span>, then the gcd of <span class="inlinecode"><span class="id" title="var">n</span></span> and <span class="inlinecode"><span class="id" title="var">m</span></span> is <span class="inlinecode">1</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_bezout_coprime</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> 1 -&gt; <span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> [<span class="id" title="var">b</span> <span class="id" title="var">p</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_gcd_unique</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">nat_divides_add_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">b</span> * <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_bezout_comm</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;: 0 &lt; <span class="id" title="var">m</span> -&gt; <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">d</span> -&gt; <span class="id" title="var">NatBezout</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> [<span class="id" title="var">a</span> [<span class="id" title="var">b</span> <span class="id" title="var">p</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (@<span class="id" title="var">equiv_leq_lt_or_eq</span> 0 <span class="id" title="var">a</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> (<span class="id" title="var">n</span> * <span class="id" title="var">a</span>.+1 * <span class="id" title="var">b</span>.+1 - <span class="id" title="var">b</span>), (<span class="id" title="var">m</span> * <span class="id" title="var">a</span>.+1 * <span class="id" title="var">b</span>.+1 - <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">nat_dist_sub_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_add_comm</span>, <span class="id" title="var">nat_add_assoc</span>, &lt;- (<span class="id" title="var">nat_add_comm</span> <span class="id" title="var">d</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_sub_l_add_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mul_r_monotone</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">nat_mul_succ_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">leq_trans</span> <span class="id" title="var">_</span> (<span class="id" title="var">leq_add_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">leq_trans</span> <span class="id" title="var">_</span> (<span class="id" title="var">leq_add_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveL_nV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_add_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">ap011</span> <span class="id" title="var">nat_add</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> 0, 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">nat_mul_zero_l</span>, <span class="id" title="var">nat_add_zero_r</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_nat_add_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">nat_bezout_comm</span> : <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_bezout_pos_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : 0 &lt; <span class="id" title="var">n</span> -&gt; <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">k</span> := <span class="id" title="var">n</span> + <span class="id" title="var">m</span>); <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> : <span class="id" title="var">n</span> + <span class="id" title="var">m</span> = <span class="id" title="var">k</span>) <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="var">clearbody</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">k</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>; <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_ind_strong</span>; <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">IHk</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">q</span> <span class="id" title="var">H</span>.<br/>
</div>

<div class="doc">
Given a sum <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">m</span></span>, we can always find another pair <span class="inlinecode"><span class="id" title="var">n'</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">m'</span></span> equal to that sum such that <span class="inlinecode"><span class="id" title="var">n'</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">m'</span></span>. This extra hypothesis lets us prove the statement more directly. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span>, <span class="id" title="var">n</span> + <span class="id" title="var">m</span> = <span class="id" title="var">n'</span> + <span class="id" title="var">m'</span> -&gt; 0 &lt; <span class="id" title="var">n'</span> -&gt; <span class="id" title="var">n'</span> &lt; <span class="id" title="var">m'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">NatBezout</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span>)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span> <span class="id" title="var">p</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">m'</span> &lt; <span class="id" title="var">n</span> + <span class="id" title="var">m</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">change</span> (0 + <span class="id" title="var">m'</span> &lt; <span class="id" title="var">n'</span> + <span class="id" title="var">m'</span>); <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHk</span> <span class="id" title="var">m'</span> <span class="id" title="var">_</span> <span class="id" title="var">n'</span> (<span class="id" title="var">m'</span> - <span class="id" title="var">n'</span>) (<span class="id" title="var">nat_add_sub_r_cancel</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> [<span class="id" title="var">b</span> <span class="id" title="var">r</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>), <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_dist_r</span>, <span class="id" title="var">r</span>, <span class="id" title="var">nat_dist_sub_l</span>, &lt;- <span class="id" title="var">nat_add_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_add_sub_l_cancel</span>; <span class="id" title="var">only</span> 2: <span class="id" title="var">rapply</span> <span class="id" title="var">nat_mul_l_monotone</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> + <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_gcd_r_sub</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_trichotomy</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">l</span> | <span class="id" title="var">p</span>] | <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_gcd_idem</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (@<span class="id" title="var">equiv_leq_lt_or_eq</span> 0 <span class="id" title="var">m</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_gcd_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_bezout_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_add_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_gcd_zero_r</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
For strictly positive numbers, we have Bezout's identity in both directions. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_bezout_pos</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;: 0 &lt; <span class="id" title="var">n</span> -&gt; 0 &lt; <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;-&gt; <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) /\ <span class="id" title="var">NatBezout</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>; <span class="id" title="tactic">split</span>; [| <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_bezout_comm</span>]; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
For arbitrary natural numbers, we have Bezout's identity in at least one direction. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_bezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">NatBezout</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) + <span class="id" title="var">NatBezout</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> (<span class="id" title="var">nat_gcd</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; [ <span class="id" title="tactic">right</span> | <span class="id" title="tactic">left</span> ]; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1542"></a><h2 class="section">Prime Numbers</h2>

<div class="paragraph"> </div>

 A prime number is a number greater than <span class="inlinecode">1</span> that is only divisible by <span class="inlinecode">1</span> and itself. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsPrime</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Type0</span> := {<br/>
&nbsp;&nbsp;<span class="id" title="var">gt_one_isprime</span> :: 1 &lt; <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">isprime</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, (<span class="id" title="var">m</span> | <span class="id" title="var">n</span>) -&gt; (<span class="id" title="var">m</span> = 1) + (<span class="id" title="var">m</span> = <span class="id" title="var">n</span>);<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issig_IsPrime</span> <span class="id" title="var">n</span> : <span class="id" title="var">_</span> &lt;~&gt; <span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span> := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">issig</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_isprime</span> `{<span class="id" title="var">Funext</span>} <span class="id" title="var">n</span> : <span class="id" title="var">IsHProp</span> (<span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">istrunc_equiv_istrunc</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">issig_IsPrime</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">istrunc_sigma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">istrunc_forall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">istrunc_forall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">ishprop_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">snd</span> <span class="id" title="var">neq_iff_lt_or_gt</span> <span class="id" title="var">_</span> (<span class="id" title="var">p</span>^ @ <span class="id" title="var">q</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">0</span> is not a prime number. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_isprime_zero</span> : ~ <span class="id" title="var">IsPrime</span> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">not_lt_zero_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">1</span> is not a prime number. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_isprime_one</span> : ~ <span class="id" title="var">IsPrime</span> 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">lt_irrefl</span> 1).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Being prime is a decidable property. We give an inefficient procedure for determining primality. More efficient procedures can be given, but for proofs this suffices. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">decidable_isprime@</span>{} <span class="id" title="var">n</span> : <span class="id" title="var">Decidable</span> (<span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
</div>

<div class="doc">
First we begin by discarding the <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span> case as we can easily prove that <span class="inlinecode">0</span> is not prime. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">right</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">not_isprime_zero</span>.<br/>
</div>

<div class="doc">
Next, we rewrite <span class="inlinecode"><span class="id" title="var">IsPrime</span></span> <span class="inlinecode"><span class="id" title="var">n</span>.+1</span> as the equivalent sigma type. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">decidable_equiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">nrapply</span> <span class="id" title="var">issig_IsPrime</span>.<br/>
</div>

<div class="doc">
The condition in the first component in <span class="inlinecode"><span class="id" title="var">IsPrime</span></span> is clearly decidable, so we can proceed to the second component. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">decidable_equiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_sigma_prod0</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1%<span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">decidable_prod</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
</div>

<div class="doc">
In order to show that this <span class="inlinecode"><span class="id" title="keyword">forall</span></span> is decidable, we will exhibit it as a <span class="inlinecode"><span class="id" title="var">for_all</span></span> statement over a given list. The predicate will be the conclusion we wish to reach here, and the list will consist of all numbers with a condition equivalent to the divisibility condition. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">P</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">m</span> =&gt; ((<span class="id" title="var">m</span> = 1) + (<span class="id" title="var">m</span> = <span class="id" title="var">n</span>.+1))%<span class="id" title="keyword">type</span> : <span class="id" title="var">Type0</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">l</span> := <span class="id" title="var">list_filter</span> (<span class="id" title="var">seq</span> <span class="id" title="var">n</span>.+2) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">x</span> | <span class="id" title="var">n</span>.+1)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">decidable_iff</span> (<span class="id" title="var">A</span> := <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Pl</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_for_all</span> <span class="id" title="keyword">with</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Pl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">Pl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_filter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">only</span> 2: <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_seq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_divides</span> <span class="id" title="tactic">in</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">for_all_inlist</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_filter</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">H'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_seq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can show that the first 8 primes are prime as expected. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_2</span> : <span class="id" title="var">IsPrime</span> 2 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_3</span> : <span class="id" title="var">IsPrime</span> 3 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_5</span> : <span class="id" title="var">IsPrime</span> 5 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_7</span> : <span class="id" title="var">IsPrime</span> 7 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_11</span> : <span class="id" title="var">IsPrime</span> 11 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_13</span> : <span class="id" title="var">IsPrime</span> 13 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_17</span> : <span class="id" title="var">IsPrime</span> 17 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_19</span> : <span class="id" title="var">IsPrime</span> 19 := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>

<br/>
</div>

<div class="doc">
Similarly, we can see that other natural numbers are not prime. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_isprime_0</span> : <span class="id" title="var">not</span> (<span class="id" title="var">IsPrime</span> 0) := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_isprime_1</span> : <span class="id" title="var">not</span> (<span class="id" title="var">IsPrime</span> 1) := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_isprime_4</span> : <span class="id" title="var">not</span> (<span class="id" title="var">IsPrime</span> 4) := <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">decide</span>).<br/>

<br/>
</div>

<div class="doc">
We can define the type of prime numbers as a subtype of natural numbers. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Prime</span> : <span class="id" title="var">Type0</span> := {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span> &amp; <span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span>}.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">nat_of_prime</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>) : <span class="id" title="var">nat</span> := <span class="id" title="var">p</span>.1.<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isprime_prime</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>) : <span class="id" title="var">IsPrime</span> <span class="id" title="var">p</span> := <span class="id" title="var">p</span>.2.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lt_zero_prime</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>) : 0 &lt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">lt_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">gt_one_isprime</span>.<br/>

<br/>
</div>

<div class="doc">
A prime <span class="inlinecode"><span class="id" title="var">p</span></span> is coprime to a natural number <span class="inlinecode"><span class="id" title="var">n</span></span> iff <span class="inlinecode"><span class="id" title="var">p</span></span> does not divide <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_coprime_iff_not_divides</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">nat_gcd</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span> = 1 &lt;-&gt; ~ (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> [<span class="id" title="var">d</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">nat_gcd_r_add_r_mul</span> <span class="id" title="var">p</span> 0) <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_gcd_zero_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">neq_iff_lt_or_gt</span> <span class="id" title="var">p</span> 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">right</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">nd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">nat_gcd_unique</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isprime</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H1</span>|<span class="id" title="var">H1</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span>; <span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
When a prime number divides a multiple, then the prime must divide one of the factors. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_divides_prime_l</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>) <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;: (<span class="id" title="var">p</span> | <span class="id" title="var">n</span> * <span class="id" title="var">m</span>) -&gt; (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>) + (<span class="id" title="var">p</span> | <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_coprime_iff_not_divides</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_bezout_pos_l</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> [<span class="id" title="var">y</span> <span class="id" title="var">q</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>^; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> * <span class="id" title="var">m</span> - <span class="id" title="var">y</span> * <span class="id" title="var">d</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_dist_sub_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 2 <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">nat_mul_comm</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>^; <span class="id" title="tactic">clear</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">nat_mul_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_dist_sub_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_one_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">nat_mul</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_moveR_nV</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1543"></a><h2 class="section">Composite Numbers</h2>

<div class="paragraph"> </div>

 A natural number larger than <span class="inlinecode">1</span> is composite if it has a divisor other than <span class="inlinecode">1</span> and itself. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsComposite</span> <span class="id" title="var">n</span> : <span class="id" title="var">Type0</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">iscomposite</span> : <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>, 1 &lt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">n</span> /\ (<span class="id" title="var">a</span> | <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gt_1_iscomposite@</span>{} <span class="id" title="var">n</span> : <span class="id" title="var">IsComposite</span> <span class="id" title="var">n</span> -&gt; 1 &lt; <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> [[<span class="id" title="var">H1</span> <span class="id" title="var">H2</span>] <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">gt_1_iscomposite</span> : <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
</div>

<div class="doc">
Being composite is a decidable property. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">decidable_iscomposite@</span>{} <span class="id" title="var">n</span> : <span class="id" title="var">Decidable</span> (<span class="id" title="var">IsComposite</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsComposite</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">decidable_exists_nat</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">fst</span> <span class="id" title="var">c</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
For a number larger than <span class="inlinecode">1</span>, being prime is equivalent to not being composite. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isprime_iff_not_iscomposite@</span>{} <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span> &lt;-&gt; 1 &lt; <span class="id" title="var">n</span> /\ ~ <span class="id" title="var">IsComposite</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> [[<span class="id" title="var">H2</span> <span class="id" title="var">H3</span>] <span class="id" title="var">H4</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isprime</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H4</span>|<span class="id" title="var">H4</span>]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H4</span>; <span class="id" title="tactic">exact</span> (<span class="id" title="var">lt_irrefl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">H1</span> <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">Build_IsPrime</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (1 &lt; <span class="id" title="var">d</span>.1)) <span class="id" title="keyword">as</span> [<span class="id" title="var">H2</span>|<span class="id" title="var">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">divides_divisor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">d'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_divides</span> <span class="id" title="tactic">in</span> <span class="id" title="var">d'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_leq_lt_or_eq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">d'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d'</span>|<span class="id" title="var">d'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> : <span class="id" title="var">IsComposite</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>.1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">split</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_div_cancel</span> <span class="id" title="keyword">with</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_div_mul_cancel_l</span> <span class="id" title="keyword">with</span> <span class="id" title="var">d</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> / <span class="id" title="var">d</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">geq_iff_not_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_zero_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">contradiction</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">neq_nat_zero_succ</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_mul_one_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">right</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_pred'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">d</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
And since <span class="inlinecode"><span class="id" title="var">IsComposite</span></span> is decidable, we can show that being not prime is equivalent to being composite. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">not_isprime_iff_iscomposite@</span>{} <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: 1 &lt; <span class="id" title="var">n</span> /\ ~ <span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span> &lt;-&gt; <span class="id" title="var">IsComposite</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_functor_prod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">iff_not</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">isprime_iff_not_iscomposite</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">rapply</span> <span class="id" title="var">iff_not_prod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">nrapply</span> <span class="id" title="var">sum_distrib_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_functor_sum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">iff_contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">iff_functor_prod</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">iff_stable</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">rapply</span> <span class="id" title="var">sum_empty_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="var">only</span> 1: <span class="id" title="tactic">exact</span> <span class="id" title="var">snd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">split</span>; <span class="id" title="var">only</span> 2: <span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1544"></a><h2 class="section">Fundamental theorem of arithmetic</h2>

<div class="paragraph"> </div>

 Every natural number greater than <span class="inlinecode">1</span> has a prime divisor. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">exists_prime_divisor@</span>{} <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: 1 &lt; <span class="id" title="var">n</span> -&gt; <span class="id" title="tactic">exists</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>), (<span class="id" title="var">p</span> | <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>; <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_ind_strong</span>; <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">IsPrime</span> <span class="id" title="var">n</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span>|<span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exists</span> (<span class="id" title="var">_</span>; <span class="id" title="var">x</span>); <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">r</span> := (<span class="id" title="var">H</span>, <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">not_isprime_iff_iscomposite</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">d</span> [[<span class="id" title="var">H1</span> <span class="id" title="var">H2</span>] <span class="id" title="var">H3</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">d</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Any natural number can either be written as a product of primes or is zero. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">prime_factorization@</span>{} <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: 0 &lt; <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="tactic">exists</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">Prime</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">fold_right</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">p</span> : <span class="id" title="var">Prime</span>) <span class="id" title="var">n</span> =&gt; <span class="id" title="var">nat_mul</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span>) 1 <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">n</span>; <span class="id" title="var">snrapply</span> <span class="id" title="var">nat_ind_strong</span>; <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">IHn</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exists</span> <span class="id" title="var">nil</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">exists_prime_divisor</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">d</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">l</span> := <span class="id" title="var">lt_divides</span> <span class="id" title="var">d</span>.1 <span class="id" title="var">n</span>.+1 <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span> <span class="id" title="var">r</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>, <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">contradiction</span> (<span class="id" title="var">lt_irrefl</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">p</span> :: <span class="id" title="var">f</span>)%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
TODO: show that any two prime factorizations are unique up to permutation of the lists. 
</div>
<div class="code">
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>