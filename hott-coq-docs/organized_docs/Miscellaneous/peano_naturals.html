<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>peano_naturals</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library peano_naturals</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.abstract_algebra</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.naturals</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.orders</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.rings</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.orders.semirings</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.apartness</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">mc_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Minimization</span> <span class="id" title="var">ToSet</span>.<br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;should&nbsp;go&nbsp;away&nbsp;one&nbsp;Coq&nbsp;has&nbsp;universe&nbsp;cumulativity&nbsp;through&nbsp;inductives.&nbsp;*)</span><br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">nat_lift</span>.<br/>

<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">N</span>.<br/>
<span class="comment">(*&nbsp;It's&nbsp;important&nbsp;that&nbsp;the&nbsp;universe&nbsp;<span class="inlinecode"><span class="id" title="var">N</span></span>&nbsp;be&nbsp;free.&nbsp;&nbsp;Occasionally,&nbsp;Coq&nbsp;will&nbsp;choose&nbsp;universe&nbsp;variables&nbsp;in&nbsp;proofs&nbsp;that&nbsp;force&nbsp;<span class="inlinecode"><span class="id" title="var">N</span></span>&nbsp;to&nbsp;be&nbsp;<span class="inlinecode"><span class="id" title="keyword">Set</span></span>.&nbsp;&nbsp;To&nbsp;pinpoint&nbsp;where&nbsp;this&nbsp;happens,&nbsp;you&nbsp;can&nbsp;add&nbsp;the&nbsp;line&nbsp;<span class="inlinecode"><span class="id" title="var">Constraint</span></span> <span class="inlinecode"><span class="id" title="keyword">Set</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">N</span>.</span>&nbsp;here,&nbsp;and&nbsp;see&nbsp;what&nbsp;fails&nbsp;below.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Let</span> <span class="id" title="var">natpaths</span> := @<span class="id" title="var">paths@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;=N=" := <span class="id" title="var">natpaths</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">natpaths_symm</span> : <span class="id" title="var">Symmetric@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} <span class="id" title="var">natpaths</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">natpaths</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_0</span>: <span class="id" title="var">Zero@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := 0%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_1</span>: <span class="id" title="var">One@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := 1%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_plus</span>: <span class="id" title="var">Plus@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := <span class="id" title="var">Nat.Core.nat_add</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">mul</span> := <span class="id" title="var">Nat.Core.nat_mul</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_mult</span>: <span class="id" title="var">Mult@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := <span class="id" title="var">Nat.Core.nat_mul</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">simpl_nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<span class="id" title="var">plus</span> <span class="id" title="var">nat</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">Nat.Core.nat_add</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<span class="id" title="var">mult</span> <span class="id" title="var">nat</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">Nat.Core.nat_mul</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">Nat.Core.nat_add</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">plus</span> <span class="id" title="var">nat</span> <span class="id" title="var">Nat.Core.nat_add</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">Nat.Core.nat_mul</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">mult</span> <span class="id" title="var">nat</span> <span class="id" title="var">Nat.Core.nat_mul</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">0</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">=<span class="id" title="var">N</span>=</span> <span class="inlinecode"><span class="id" title="var">a</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">add_0_l</span> : <span class="id" title="var">LeftIdentity@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">plus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">nat</span>) 0 := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">idpath</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">add_S_l</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">S</span> <span class="id" title="var">a</span> + <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= <span class="id" title="var">S</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) := <span class="id" title="var">idpath</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode">0</span> <span class="inlinecode">=<span class="id" title="var">N</span>=</span> <span class="inlinecode"><span class="id" title="var">a</span></span> 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">add_0_r</span> : <span class="id" title="var">RightIdentity@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">plus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">zero</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span>), <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_S_r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> + <span class="id" title="var">S</span> <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= <span class="id" title="var">S</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span>), <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">nat</span>,</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode">(<span class="id" title="var">b</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">c</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">(<span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span>)</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">c</span></span>.  The RHS is written <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">c</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">add_assoc</span> : <span class="id" title="var">Associative@</span>{<span class="id" title="var">N</span>} (<span class="id" title="var">plus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> (<span class="id" title="var">a</span> + (<span class="id" title="var">b</span> + <span class="id" title="var">c</span>)) = <span class="id" title="var">S</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span> + <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span>), <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">add_comm</span> : <span class="id" title="var">Commutative@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">plus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">rhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">add_0_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">add_S_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span>), <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">mul_0_l</span> : <span class="id" title="var">LeftAbsorb@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">zero</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">idpath</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mul_S_l</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) * <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= <span class="id" title="var">b</span> + <span class="id" title="var">a</span> * <span class="id" title="var">b</span> := <span class="id" title="var">idpath</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">1</span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">=<span class="id" title="var">N</span>=</span> <span class="inlinecode"><span class="id" title="var">a</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">mul_1_l</span> : <span class="id" title="var">LeftIdentity@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">one</span> : <span class="id" title="var">One</span> <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">add_0_r</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">mul_0_r</span> : <span class="id" title="var">RightAbsorb@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">zero</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">a</span> * 0 = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mul_S_r</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">a</span> * <span class="id" title="var">S</span> <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= <span class="id" title="var">a</span> + <span class="id" title="var">a</span> * <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">S</span> (<span class="id" title="var">b</span> + <span class="id" title="var">a</span> * <span class="id" title="var">S</span> <span class="id" title="var">b</span>) = <span class="id" title="var">S</span> (<span class="id" title="var">a</span> + (<span class="id" title="var">b</span> + <span class="id" title="var">a</span> * <span class="id" title="var">b</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> <span class="id" title="var">add_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> + <span class="id" title="var">_</span>) (<span class="id" title="var">add_comm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">plus</span> <span class="id" title="var">b</span>) <span class="id" title="var">IHa</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode">1</span> <span class="inlinecode">=<span class="id" title="var">N</span>=</span> <span class="inlinecode"><span class="id" title="var">a</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">mul_1_r</span> : <span class="id" title="var">RightIdentity@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">one</span> : <span class="id" title="var">One</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">mul_S_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> (<span class="id" title="var">mul_0_r</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">add_0_r</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">mul_comm</span> : <span class="id" title="var">Commutative@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">rhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">mul_0_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">mul_S_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">b</span> + <span class="id" title="var">a</span> * <span class="id" title="var">b</span> = <span class="id" title="var">b</span> + <span class="id" title="var">b</span> * <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">b</span> + <span class="id" title="var">x</span>)), <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode">(<span class="id" title="var">b</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">c</span>)</span> <span class="inlinecode">=<span class="id" title="var">N</span>=</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">c</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">add_mul_distr_l</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">LeftDistribute@</span>{<span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">plus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> ((<span class="id" title="var">b</span> + <span class="id" title="var">c</span>) + <span class="id" title="var">a</span> * (<span class="id" title="var">b</span> + <span class="id" title="var">c</span>) = (<span class="id" title="var">b</span> + <span class="id" title="var">a</span> * <span class="id" title="var">b</span>) + (<span class="id" title="var">c</span> + <span class="id" title="var">a</span> * <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">plus</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> <span class="id" title="var">add_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> + <span class="id" title="var">_</span>) (<span class="id" title="var">add_comm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">rapply</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">plus</span> <span class="id" title="var">c</span>)), <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">(<span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span>)</span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">=<span class="id" title="var">N</span>=</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">c</span></span>.  This also follows from <span class="inlinecode"><span class="id" title="var">plus_mult_distr_r</span></span>, which currently requires that we already have a semiring.  It should be adjusted to not require associativity. 
</div>
<div class="code">
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">add_mul_distr_r</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">RightDistribute@</span>{<span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">plus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">mul_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">add_mul_distr_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">mul_comm</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">mul_assoc</span> : <span class="id" title="var">Associative@</span>{<span class="id" title="var">N</span>} (<span class="id" title="var">mult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">simpl_nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">add_mul_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">S_neq_0</span> <span class="id" title="var">x</span> : <span class="id" title="var">PropHolds</span> (~ (<span class="id" title="var">S</span> <span class="id" title="var">x</span> =<span class="id" title="var">N</span>= 0)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">change</span> ((<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span> <span class="id" title="var">S</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Unit</span> | 0%<span class="id" title="var">nat</span> =&gt; <span class="id" title="var">Empty</span> <span class="id" title="keyword">end</span>) 0).<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">transport</span>.<br/>
- <span class="id" title="tactic">exact</span> <span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">split</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pred</span> <span class="id" title="var">x</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> | 0%<span class="id" title="var">nat</span> =&gt; 0 | <span class="id" title="var">S</span> <span class="id" title="var">k</span> =&gt; <span class="id" title="var">k</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">S_inj</span> : <span class="id" title="var">IsInjective@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} <span class="id" title="var">S</span><br/>
&nbsp;&nbsp;:= { <span class="id" title="var">injective</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span> =&gt; <span class="id" title="var">ap</span> <span class="id" title="var">pred</span> <span class="id" title="var">E</span> }.<br/>

<br/>
</div>

<div class="doc">
This is also in Spaces.Nat.Core. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_dec</span>: <span class="id" title="var">DecidablePaths@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">nat_rect@</span>{<span class="id" title="var">N</span>} (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">_</span>)).<br/>
- <span class="id" title="tactic">intros</span> [|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">symmetric_neq</span>,<span class="id" title="var">S_neq_0</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">IHa</span> [|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">S_neq_0</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHa</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">S</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_set</span> : <span class="id" title="var">IsTrunc@</span>{<span class="id" title="var">N</span>} 0 <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">hset_pathcoll</span>, <span class="id" title="var">pathcoll_decpaths</span>, <span class="id" title="var">nat_dec</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">nat_semiring</span> : <span class="id" title="var">IsSemiCRing@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Add&nbsp;Ring&nbsp;nat:&nbsp;(rings.stdlib_semiring_theory&nbsp;nat).&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Close&nbsp;Scope&nbsp;nat_scope.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">O_nat_0</span> : <span class="id" title="var">O</span> =<span class="id" title="var">N</span>= 0.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">S_nat_plus_1</span> <span class="id" title="var">x</span> : <span class="id" title="var">S</span> <span class="id" title="var">x</span> =<span class="id" title="var">N</span>= <span class="id" title="var">x</span> + 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_comm</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">S_nat_1_plus</span> <span class="id" title="var">x</span> : <span class="id" title="var">S</span> <span class="id" title="var">x</span> =<span class="id" title="var">N</span>= 1 + <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_induction</span> (<span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Type</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> 0 -&gt; (<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="var">P</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">P</span> (1 + <span class="id" title="var">n</span>)) -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="var">P</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_rect</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">plus_eq_zero</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">a</span> + <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= 0 -&gt; <span class="id" title="var">a</span> =<span class="id" title="var">N</span>= 0 /\ <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>];[<span class="id" title="tactic">intros</span> [|<span class="id" title="var">b</span>];<span class="id" title="tactic">auto</span>|].<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">S_neq_0</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
- <span class="id" title="tactic">intros</span> ? <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">S_neq_0</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mult_eq_zero</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">a</span> * <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= 0 -&gt; <span class="id" title="var">a</span> =<span class="id" title="var">N</span>= 0 |<span class="id" title="var">_</span>| <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>] [|<span class="id" title="var">b</span>];<span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>;<span class="id" title="tactic">right</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="var">simpl_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">S_neq_0</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">nat_zero_divisors</span> : <span class="id" title="var">NoZeroDivisors</span> <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> [<span class="id" title="var">Ex</span> [<span class="id" title="var">y</span> [<span class="id" title="var">Ey1</span> <span class="id" title="var">Ey2</span>]]].<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">mult_eq_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ey2</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">Ey2</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">nat_plus_cancel_l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>:<span class="id" title="var">nat</span>, <span class="id" title="var">LeftCancellation@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">plus</span> <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">IHa</span>];<span class="id" title="var">simpl_nat</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">S</span>). <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">nat_mult_cancel_l</span><br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">PropHolds</span> (~ (<span class="id" title="var">z</span> =<span class="id" title="var">N</span>= 0)) -&gt; <span class="id" title="var">LeftCancellation@</span>{<span class="id" title="var">N</span>} (.*.) <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">PropHolds</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">LeftCancellation</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">Ea</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E</span>;<span class="id" title="var">revert</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span> <span class="id" title="var">Ea</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">IHb</span>];<span class="id" title="tactic">intros</span> [|<span class="id" title="var">c</span>];<span class="id" title="var">simpl_nat</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">Ea</span> <span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">mul_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mul_S_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_eq_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ea</span> (<span class="id" title="var">fst</span> <span class="id" title="var">E</span>)).<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">mul_0_r</span>,<span class="id" title="var">mul_S_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">plus_eq_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ea</span> (<span class="id" title="var">fst</span> <span class="id" title="var">E</span>)).<br/>
- <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">mul_S_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Order&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_le</span>: <span class="id" title="var">Le@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := <span class="id" title="var">Nat.Core.leq</span>.<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_lt</span>: <span class="id" title="var">Lt@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := <span class="id" title="var">Nat.Core.lt</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_plus</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span>, <span class="id" title="var">n</span> &lt;= <span class="id" title="var">k</span> + <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">k</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.Core.leq_refl</span>.<br/>
- <span class="id" title="var">simpl_nat</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_exists</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iff@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">n</span> &lt;= <span class="id" title="var">m</span>) (<span class="id" title="var">sig@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> =&gt; <span class="id" title="var">m</span> =<span class="id" title="var">N</span>= <span class="id" title="var">k</span> + <span class="id" title="var">n</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>;<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">induction</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m</span> <span class="id" title="var">E</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> 0;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">IH</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IH</span>;<span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intros</span> [<span class="id" title="var">k</span> <span class="id" title="var">Hk</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hk</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_plus</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">zero_least</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0 &lt;= <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">constructor</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_S_S</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">iff@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span>) (<span class="id" title="var">S</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">S</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="var">etransitivity</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span>|].<br/>
<span class="id" title="var">etransitivity</span>;[|<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>,<span class="id" title="var">le_exists</span>].<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">intros</span> [<span class="id" title="var">k</span> <span class="id" title="var">E</span>];<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>,<span class="id" title="var">add_S_r</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_S_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_0_S</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> : <span class="id" title="var">nat</span>, 0 &lt; <span class="id" title="var">S</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">zero_least</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_S_either</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> &lt;= <span class="id" title="var">S</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span> |<span class="id" title="var">_</span>| <span class="id" title="var">a</span> = <span class="id" title="var">S</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>] <span class="id" title="var">b</span>.<br/>
- <span class="id" title="tactic">intros</span>;<span class="id" title="tactic">left</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_least</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">le_S_S</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">E</span>];<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_lt_dec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span> |<span class="id" title="var">_</span>| <span class="id" title="var">b</span> &lt; <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
- <span class="id" title="tactic">intros</span>;<span class="id" title="tactic">left</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_least</span>.<br/>
- <span class="id" title="tactic">intros</span> [|<span class="id" title="var">b</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lt_0_S</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHa</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_lt_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, ~ (<span class="id" title="var">a</span> &lt; 0).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">E</span>].<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">natpaths_symm</span>,<span class="id" title="var">plus_eq_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">S_neq_0</span> <span class="id" title="var">_</span> (<span class="id" title="var">snd</span> <span class="id" title="var">E</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>.<br/>
- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_0</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">nat_le_total</span> : <span class="id" title="var">TotalRelation@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">_</span>:<span class="id" title="var">Le</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">le_lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>);[<span class="id" title="tactic">left</span>|<span class="id" title="tactic">right</span>].<br/>
- <span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">lt_le</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">nat_lt_irrefl</span> : <span class="id" title="var">Irreflexive@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} (<span class="id" title="var">_</span>:<span class="id" title="var">Lt</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">E</span>].<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">S_neq_0</span> <span class="id" title="var">k</span>).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation@</span>{<span class="id" title="var">N</span>} (+) <span class="id" title="var">x</span>).<br/>
<span class="id" title="tactic">fold</span> <span class="id" title="var">natpaths</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_0_r</span>, <span class="id" title="var">add_S_r</span>,&lt;-<span class="id" title="var">add_S_l</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_comm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">natpaths_symm</span>,<span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">nat_le_hprop</span> : <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">nat</span> <span class="id" title="var">le</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Trunc.hprop_allpath</span>.<br/>
<span class="id" title="tactic">generalize</span> (<span class="id" title="var">idpath</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) : <span class="id" title="var">S</span> <span class="id" title="var">n</span> =<span class="id" title="var">N</span>= <span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">generalize</span> <span class="id" title="var">n</span> <span class="id" title="tactic">at</span> 2 3 4 5.<br/>
<span class="id" title="tactic">change</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">n0</span> : <span class="id" title="var">nat</span>,<br/>
<span class="id" title="var">S</span> <span class="id" title="var">n</span> =<span class="id" title="var">N</span>= <span class="id" title="var">S</span> <span class="id" title="var">n0</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">le_mn1</span> <span class="id" title="var">le_mn2</span> : <span class="id" title="var">m</span> &lt;= <span class="id" title="var">n0</span>, <span class="id" title="var">le_mn1</span> = <span class="id" title="var">le_mn2</span>).<br/>
<span class="id" title="tactic">induction</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">n0</span> <span class="id" title="var">IHn0</span>].<br/>
- <span class="id" title="tactic">intros</span> ? <span class="id" title="var">E</span>;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">S_neq_0</span> <span class="id" title="var">_</span> (<span class="id" title="var">natpaths_symm</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>)).<br/>
- <span class="id" title="tactic">clear</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">S</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">le_mn1</span> <span class="id" title="var">le_mn2</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">def_n2</span> := <span class="id" title="var">idpath</span> <span class="id" title="var">n0</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">path_via</span> (<span class="id" title="var">paths_ind</span> <span class="id" title="var">n0</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">le</span> <span class="id" title="var">m</span> <span class="id" title="var">_</span>) <span class="id" title="var">le_mn2</span> <span class="id" title="var">n0</span> <span class="id" title="var">def_n2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">def_n2</span>; <span class="id" title="var">revert</span> <span class="id" title="var">le_mn1</span> <span class="id" title="var">le_mn2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="var">n0</span> <span class="id" title="tactic">at</span> 1 4 5 8; <span class="id" title="tactic">intros</span> <span class="id" title="var">n1</span> <span class="id" title="var">le_mn1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">le_mn1</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">le_mn2</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">le_mn2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">def_n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Trunc.path_ishprop</span> <span class="id" title="var">def_n0</span> <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">def_n0</span>; <span class="id" title="tactic">generalize</span> <span class="id" title="var">le_mn2</span>; <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">def_n0</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">le_mn0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">nat_lt</span> <span class="id" title="var">_</span> <span class="id" title="var">le_mn0</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">def_n0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">nat_lt</span> <span class="id" title="var">m0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">def_n0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">le_mn1</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">def_n0</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">injective</span> <span class="id" title="var">S</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">def_n0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Trunc.path_ishprop</span> <span class="id" title="var">def_n0</span> <span class="id" title="var">idpath</span>). <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn0</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">nat_le_po</span> : <span class="id" title="var">PartialOrder</span> <span class="id" title="var">nat_le</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">hnf</span>;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">constructor</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k1</span> <span class="id" title="var">E1</span>], <span class="id" title="var">E2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k2</span> <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E2</span>,<span class="id" title="var">E1</span>,<span class="id" title="var">add_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_plus</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k1</span> <span class="id" title="var">E1</span>], <span class="id" title="var">E2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k2</span> <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">k1</span> + <span class="id" title="var">k2</span> = 0) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> (+) <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">path_via</span> (<span class="id" title="var">k2</span> + <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> <span class="id" title="var">a</span>), (<span class="id" title="var">plus_assoc</span> <span class="id" title="var">k2</span>), (<span class="id" title="var">plus_comm</span> <span class="id" title="var">k2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">plus_eq_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Ek1</span> <span class="id" title="var">Ek2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Ek2</span>,<span class="id" title="var">plus_0_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">nat_strict</span> : <span class="id" title="var">StrictOrder</span> (<span class="id" title="var">_</span>:<span class="id" title="var">Lt</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">cbv</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k1</span> <span class="id" title="var">E1</span>], <span class="id" title="var">E2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k2</span> <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">S</span> (<span class="id" title="var">k1</span>+<span class="id" title="var">k2</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E2</span>,<span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">add_S_r</span>,<span class="id" title="var">add_S_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">k2</span>), (<span class="id" title="var">add_comm</span> <span class="id" title="var">k2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">nat_trichotomy</span> : <span class="id" title="var">Trichotomy@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">i</span>} (<span class="id" title="var">lt</span>:<span class="id" title="var">Lt</span> <span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">fold</span> <span class="id" title="var">natpaths</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">le_lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) <span class="id" title="keyword">as</span> [[|]|<span class="id" title="var">E</span>];<span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">right</span>;<span class="id" title="tactic">left</span>;<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_apart</span> : <span class="id" title="var">Apart@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> =&gt; <span class="id" title="var">n</span> &lt; <span class="id" title="var">m</span> |<span class="id" title="var">_</span>| <span class="id" title="var">m</span> &lt; <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">nat_apart_mere</span> : <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">nat</span> <span class="id" title="var">nat_apart</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">ishprop_sum</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">nat_lt</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="tactic">transitivity</span> <span class="id" title="var">y</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">decidable_nat_apart</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Decidable</span> (<span class="id" title="var">nat_apart</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">decidable_sum@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span>}; <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.Core.decidable_lt</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_trivial_apart</span> : <span class="id" title="var">TrivialApart</span> <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">irrefl_neq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">symmetric_neq</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">trichotomy</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) <span class="id" title="keyword">as</span> [?|[?|?]];<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_not_lt_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, ~ (<span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span>) -&gt; <span class="id" title="var">b</span> &lt;= <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> ?? <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">le_lt_dec</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span>);<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_lt_not_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span> -&gt; ~ (<span class="id" title="var">b</span> &lt;= <span class="id" title="var">a</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k1</span> <span class="id" title="var">E1</span>], <span class="id" title="var">E2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k2</span> <span class="id" title="var">E2</span>].<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">S_neq_0</span> (<span class="id" title="var">k1</span> + <span class="id" title="var">k2</span>)).<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> (+) <span class="id" title="var">a</span>).<br/>
<span class="id" title="tactic">fold</span> <span class="id" title="var">natpaths</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_0_r</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_S_r</span>;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">add_S_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">a</span>), (<span class="id" title="var">add_comm</span> <span class="id" title="var">a</span>), &lt;-(<span class="id" title="var">add_assoc</span> <span class="id" title="var">k1</span>), (<span class="id" title="var">add_comm</span> <span class="id" title="var">a</span>).<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">add_assoc</span> <span class="id" title="var">k1</span>), (<span class="id" title="var">add_comm</span> <span class="id" title="var">k1</span>), &lt;-(<span class="id" title="var">add_assoc</span> <span class="id" title="var">k2</span>).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">natpaths_symm</span>,<span class="id" title="var">E2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_le_dec</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">x</span>  <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">le_lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>
- <span class="id" title="tactic">left</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_lt_not_le</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">S_gt_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0 &lt; <span class="id" title="var">S</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>,<span class="id" title="var">zero_least</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nonzero_gt_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, ~ (<span class="id" title="var">a</span> =<span class="id" title="var">N</span>= 0) -&gt; 0 &lt; <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>] <span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">S_gt_0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_le_lt_trans</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span> -&gt; <span class="id" title="var">b</span> &lt; <span class="id" title="var">c</span> -&gt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k1</span> <span class="id" title="var">E1</span>],<span class="id" title="var">E2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k2</span> <span class="id" title="var">E2</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E2</span>,<span class="id" title="var">E1</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_S_r</span>,<span class="id" title="var">add_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>,<span class="id" title="var">le_plus</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_strong_cotrans</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span>, <span class="id" title="var">a</span> &lt; <span class="id" title="var">c</span> |<span class="id" title="var">_</span>| <span class="id" title="var">c</span> &lt; <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E1</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">le_lt_dec</span> <span class="id" title="var">c</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>].<br/>
- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_le_lt_trans</span> <span class="id" title="keyword">with</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">left</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_full'</span> : <span class="id" title="var">FullPseudoSemiRingOrder</span> <span class="id" title="var">nat_le</span> <span class="id" title="var">nat_lt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|<span class="id" title="tactic">split</span>|].<br/>
- <span class="id" title="tactic">split</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> [<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">lt</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span> <span class="id" title="var">c</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_strong_cotrans</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_not_lt_le</span>,<span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">E</span>];<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_comm</span>;<span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">Hk</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hk</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_S_r</span>,&lt;-<span class="id" title="var">add_S_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>,(<span class="id" title="var">plus_comm</span> <span class="id" title="var">z</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>)), &lt;-<span class="id" title="var">plus_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>,<span class="id" title="var">le_plus</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">E</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">add_S_r</span>,<span class="id" title="var">plus_assoc</span>,(<span class="id" title="var">plus_comm</span> <span class="id" title="var">k</span> <span class="id" title="var">z</span>),&lt;-<span class="id" title="var">plus_assoc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_plus</span>.<br/>
- <span class="id" title="tactic">intros</span> ???? <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trivial_apart</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">apart</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>)) <span class="id" title="keyword">as</span> [?|<span class="id" title="var">ex</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tight_apart</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ex</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trivial_apart</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">ey</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">unfold</span> <span class="id" title="var">PropHolds</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">Ea</span> <span class="id" title="var">Eb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nonzero_gt_0</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">mult_eq_zero</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>];[<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ea</span>|<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Eb</span>];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">lt</span> 0);<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_lt_not_le</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">le_lt_dec</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nat_full@</span>{} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span>[<span class="id" title="tactic">exact</span> <span class="id" title="var">nat_full'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">nat_full'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">N</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">nat_full'@</span>{}]).<br/>
<span class="id" title="keyword">Local Existing Instance</span> <span class="id" title="var">nat_full</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_nat_max_l</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">n</span> &lt;= <span class="id" title="var">Nat.Core.nat_max</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n'</span> <span class="id" title="var">IHn</span>];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m'</span> <span class="id" title="var">IHm</span>]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">zero_least</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">m'</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_nat_max_r</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">m</span> &lt;= <span class="id" title="var">Nat.Core.nat_max</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n'</span> <span class="id" title="var">IHn</span>];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">m</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m'</span> <span class="id" title="var">IHm</span>]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">zero_least</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">m'</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">S_embedding</span> : <span class="id" title="var">OrderEmbedding</span> <span class="id" title="var">S</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> ??;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>.<br/>
- <span class="id" title="tactic">intros</span> ??;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">S_strict_embedding</span> : <span class="id" title="var">StrictOrderEmbedding</span> <span class="id" title="var">S</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_naturals_to_semiring</span> : <span class="id" title="var">NaturalsToSemiRing@</span>{<span class="id" title="var">N</span> <span class="id" title="var">i</span>} <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">fix</span> <span class="id" title="var">f</span> (<span class="id" title="var">n</span>: <span class="id" title="var">nat</span>) := <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> 0%<span class="id" title="var">nat</span> =&gt; 0 | 1%<span class="id" title="var">nat</span> =&gt; 1 |<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; 1 + <span class="id" title="var">f</span> <span class="id" title="var">n'</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">for_another_semiring</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Universe</span> <span class="id" title="var">U</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">R</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">U</span>} } `{<span class="id" title="var">IsSemiCRing@</span>{<span class="id" title="var">U</span>} <span class="id" title="var">R</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <span class="id" title="var">toR</span> := (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">nat</span> <span class="id" title="var">R</span>).<br/>

<br/>
<span class="comment">(*&nbsp;&nbsp;&nbsp;Add&nbsp;Ring&nbsp;R:&nbsp;(rings.stdlib_semiring_theory&nbsp;R).&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">f_S</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">toR</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>) = 1 + <span class="id" title="var">toR</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [|<span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_0_r</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">f_preserves_plus</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span>: <span class="id" title="var">toR</span> (<span class="id" title="var">a</span> + <span class="id" title="var">a'</span>) = <span class="id" title="var">toR</span> <span class="id" title="var">a</span> + <span class="id" title="var">toR</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">toR</span> <span class="id" title="var">a'</span> = 0 + <span class="id" title="var">toR</span> <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>,<span class="id" title="var">plus_0_l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">toR</span> (<span class="id" title="var">S</span> (<span class="id" title="var">a</span> + <span class="id" title="var">a'</span>)) = <span class="id" title="var">toR</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) + <span class="id" title="var">toR</span> <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">f_S</span>,<span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="keyword">associativity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">f_preserves_mult</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span>: <span class="id" title="var">toR</span> (<span class="id" title="var">a</span> * <span class="id" title="var">a'</span>) = <span class="id" title="var">toR</span> <span class="id" title="var">a</span> * <span class="id" title="var">toR</span> <span class="id" title="var">a'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">IHa</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (0 = 0 * <span class="id" title="var">toR</span> <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mult_0_l</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f_S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">toR</span> (<span class="id" title="var">a'</span> + <span class="id" title="var">a</span> * <span class="id" title="var">a'</span>) = (1 + <span class="id" title="var">toR</span> <span class="id" title="var">a</span>) * <span class="id" title="var">toR</span> <span class="id" title="var">a'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">f_preserves_plus</span>, <span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_mult_distr_r</span>,<span class="id" title="var">mult_1_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_to_sr_morphism</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsSemiRingPreserving</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">nat</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rapply</span> <span class="id" title="var">f_preserves_plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">rapply</span> <span class="id" title="var">f_preserves_mult</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">toR_unique</span> (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">R</span>) `{!<span class="id" title="var">IsSemiRingPreserving</span> <span class="id" title="var">h</span>} <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">nat</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span> = <span class="id" title="var">h</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">E</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">change</span> (0 = <span class="id" title="var">h</span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>,<span class="id" title="var">preserves_0</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f_S</span>. <span class="id" title="tactic">change</span> (1 + <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">nat</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> = <span class="id" title="var">h</span> (1+<span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_plus</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">h</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap10</span>,<span class="id" title="var">ap</span>,<span class="id" title="tactic">symmetry</span>,<span class="id" title="var">preserves_1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">for_another_semiring</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_naturals</span> : <span class="id" title="var">Naturals@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">N</span> <span class="id" title="var">i</span>} <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">toR_unique</span>, <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">nat_naturals</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_cut_minus</span>: <span class="id" title="var">CutMinus@</span>{<span class="id" title="var">N</span>} <span class="id" title="var">nat</span> := <span class="id" title="var">Nat.Core.nat_sub</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">plus_minus</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">cut_minus</span> (<span class="id" title="var">a</span> + <span class="id" title="var">b</span>) <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">cut_minus</span>,<span class="id" title="var">nat_cut_minus</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="var">revert</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">IH</span>].<br/>
- <span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>];<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>,<span class="id" title="var">add_0_r</span>.<br/>
- <span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">IH</span> 0) <span class="id" title="keyword">as</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_0_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">change</span> <span class="id" title="var">nat_plus</span> <span class="id" title="keyword">with</span> <span class="id" title="var">plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_S_r</span>,&lt;-<span class="id" title="var">add_S_l</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_plus_minus</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">n</span> &lt;= <span class="id" title="var">m</span> -&gt; <span class="id" title="var">m</span> =<span class="id" title="var">N</span>= (<span class="id" title="var">n</span> + (<span class="id" title="var">cut_minus</span> <span class="id" title="var">m</span>  <span class="id" title="var">n</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">le_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> <span class="id" title="var">E</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_minus</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">add_comm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">minus_ge</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span> -&gt; <span class="id" title="var">cut_minus</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =<span class="id" title="var">N</span>= 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">cut_minus</span>,<span class="id" title="var">nat_cut_minus</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="var">revert</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">IH</span>];<span class="id" title="tactic">intros</span> [|<span class="id" title="var">a</span>];<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_0</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
- <span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_S</span>,<span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">nat_cut_minus_spec</span> : <span class="id" title="var">CutMinusSpec@</span>{<span class="id" title="var">N</span> <span class="id" title="var">N</span>} <span class="id" title="var">nat</span> <span class="id" title="var">nat_cut_minus</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_comm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">le_plus_minus</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">minus_ge</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">nat_lift</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>