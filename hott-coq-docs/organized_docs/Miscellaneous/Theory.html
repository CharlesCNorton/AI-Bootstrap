<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Theory</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Theory</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Basics.Overture</span> <span class="id" title="var">Basics.Tactics</span> <span class="id" title="var">Basics.PathGroupoids</span> <span class="id" title="var">Basics.Trunc</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Basics.Equivalences</span> <span class="id" title="var">Basics.Decidable</span> <span class="id" title="var">Basics.Iff</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Types.Paths</span> <span class="id" title="var">Types.Unit</span> <span class="id" title="var">Types.Prod</span> <span class="id" title="var">Types.Sigma</span> <span class="id" title="var">Types.Sum</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Types.Empty</span> <span class="id" title="var">Types.Option</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Spaces.List.Core</span> <span class="id" title="var">Spaces.Nat.Core</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Minimization</span> <span class="id" title="var">ToSet</span>.<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Polymorphic</span> <span class="id" title="keyword">Inductive</span> <span class="id" title="var">Cumulativity</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1469"></a><h1 class="section">Theory of Lists and List Operations</h1>

<div class="paragraph"> </div>

 In this file we collect lemmas about lists and their operations. We don't include those in <span class="inlinecode"><span class="id" title="var">List.Core</span></span> so that file can stay lightweight on dependencies. 
<div class="paragraph"> </div>

 We generally try to keep the order the same as the concepts appeared in <span class="inlinecode"><span class="id" title="var">List.Core</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1470"></a><h2 class="section">Length</h2>

<div class="paragraph"> </div>

 A list of length zero must be the empty list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_0</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">H</span> : <span class="id" title="var">length</span> <span class="id" title="var">l</span> = 0%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">l</span> = <span class="id" title="var">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1471"></a><h2 class="section">Concatenation</h2>

<div class="paragraph"> </div>

 Concatenating the empty list on the right is the identity. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">app_nil</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">l</span> ++ <span class="id" title="var">nil</span> = <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Associativity of list concatenation. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">app_assoc</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">app</span> <span class="id" title="var">x</span> (<span class="id" title="var">app</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) = <span class="id" title="var">app</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">IHx</span>] <span class="id" title="tactic">in</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span>) <span class="id" title="var">IHx</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The type of lists has a monoidal structure given by concatenation. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_pentagon</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">w</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">app_assoc</span> <span class="id" title="var">w</span> <span class="id" title="var">x</span> (<span class="id" title="var">y</span> ++ <span class="id" title="var">z</span>) @ <span class="id" title="var">app_assoc</span> (<span class="id" title="var">w</span> ++ <span class="id" title="var">x</span>) <span class="id" title="var">y</span> <span class="id" title="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">w</span> ++ <span class="id" title="var">l</span>) (<span class="id" title="var">app_assoc</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">app_assoc</span> <span class="id" title="var">w</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>) <span class="id" title="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">l</span> ++ <span class="id" title="var">z</span>) (<span class="id" title="var">app_assoc</span> <span class="id" title="var">w</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|? <span class="id" title="var">w</span> <span class="id" title="var">IHw</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>, <span class="id" title="var">z</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_p1_1q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap_idmap</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ap_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span>)) (<span class="id" title="var">IHw</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ap_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ap_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap_compose</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ap_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">ap_compose</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">l</span> ++ <span class="id" title="var">z</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of a concatenated list is the sum of the lengths of the two lists. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_app</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">l</span> + <span class="id" title="var">length</span> <span class="id" title="var">l'</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span> <span class="id" title="var">IHl</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a concatenated list is equivalently either in the first list or in the second list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_inlist_app</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> + <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l'</span> &lt;~&gt; <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">sum_empty_l</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>; <span class="id" title="var">nrefine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_sum_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sum_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1472"></a><h2 class="section">Folding</h2>

<div class="paragraph"> </div>

 A left fold over a concatenated list is equivalent to folding over the first followed by folding over the second. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_left_app</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">fold_left</span> <span class="id" title="var">f</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) <span class="id" title="var">i</span> = <span class="id" title="var">fold_left</span> <span class="id" title="var">f</span> <span class="id" title="var">l'</span> (<span class="id" title="var">fold_left</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A right fold over a concatenated list is equivalent to folding over the second followed by folding over the first. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_right_app</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">fold_right</span> <span class="id" title="var">f</span> <span class="id" title="var">i</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) = <span class="id" title="var">fold_right</span> <span class="id" title="var">f</span> (<span class="id" title="var">fold_right</span> <span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="var">l'</span>) <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) (<span class="id" title="var">IHl</span> <span class="id" title="var">_</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1473"></a><h2 class="section">Maps</h2>

<div class="paragraph"> </div>

 The length of a mapped list is the same as the length of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_list_map</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>) = <span class="id" title="var">length</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span> <span class="id" title="var">IHl</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A function applied to an element of a list is an element of the mapped list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_map</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">InList</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> | <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">i</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a mapped list is equal to the function applied to some element of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_map'</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>) -&gt; { <span class="id" title="var">y</span> : <span class="id" title="var">A</span> &amp; (<span class="id" title="var">f</span> <span class="id" title="var">y</span> = <span class="id" title="var">x</span>) * <span class="id" title="var">InList</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> | <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">y</span>; (<span class="id" title="var">p</span>, <span class="id" title="var">inl</span> <span class="id" title="var">idpath</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">y'</span> [<span class="id" title="var">p</span> <span class="id" title="var">i'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">y'</span>; (<span class="id" title="var">p</span>, <span class="id" title="var">inr</span> <span class="id" title="var">i'</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Mapping a function over a concatenated list is the concatenation of the mapped lists. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_map_app</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map</span> <span class="id" title="var">f</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) = <span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> ++ <span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A function that acts as the identity on the elements of a list is the identity on the mapped list. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">list_map_id</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Hf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;:  <span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> = <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">ap011</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">Hf</span> <span class="id" title="var">_</span> (<span class="id" title="var">inl</span> <span class="id" title="var">idpath</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">Hy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">right</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">list_map</span></span> of a composition is the composition of the maps. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_map_compose</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">l</span> = <span class="id" title="var">list_map</span> <span class="id" title="var">g</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
TODO: generalize as max  The length of a <span class="inlinecode"><span class="id" title="var">list_map2</span></span> is the same as the length of the original lists. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_list_map2@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">B</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">j</span>}} {<span class="id" title="var">C</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">k</span>}}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> <span class="id" title="var">l1</span> = <span class="id" title="var">length</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">length</span> (<span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>) = <span class="id" title="var">length</span> <span class="id" title="var">l1</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l1</span> <span class="id" title="var">IHl1</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">l2</span>, <span class="id" title="var">p</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>}.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl1</span>, <span class="id" title="var">path_nat_succ</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a <span class="inlinecode"><span class="id" title="var">list_map2</span></span> is the result of applying the function to some elements of the original lists. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_map2@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">u</span> | <span class="id" title="var">i</span> &lt;= <span class="id" title="var">u</span>, <span class="id" title="var">j</span> &lt;= <span class="id" title="var">u</span>, <span class="id" title="var">k</span> &lt;= <span class="id" title="var">u</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">B</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">j</span>}} {<span class="id" title="var">C</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">k</span>}}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>) -&gt; <span class="id" title="var">length</span> <span class="id" title="var">l1</span> = <span class="id" title="var">length</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; { <span class="id" title="var">y</span> : <span class="id" title="var">A</span> &amp; { <span class="id" title="var">z</span> : <span class="id" title="var">B</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">prod@</span>{<span class="id" title="var">k</span> <span class="id" title="var">u</span>} ((<span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) = <span class="id" title="var">x</span>) (<span class="id" title="var">InList</span> <span class="id" title="var">y</span> <span class="id" title="var">l1</span> * <span class="id" title="var">InList</span> <span class="id" title="var">z</span> <span class="id" title="var">l2</span>) } }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span> <span class="id" title="var">l1</span> <span class="id" title="var">IHl1</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">l2</span>, <span class="id" title="var">x</span>, <span class="id" title="var">H</span>, <span class="id" title="var">p</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">u</span>}.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">z</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">q</span> | <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">y</span>; <span class="id" title="var">z</span>; (<span class="id" title="var">q</span>, (<span class="id" title="var">inl</span> <span class="id" title="var">idpath</span>, <span class="id" title="var">inl</span> <span class="id" title="var">idpath</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHl1</span> <span class="id" title="var">l2</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">y'</span> [<span class="id" title="var">z'</span> [<span class="id" title="var">q</span> [<span class="id" title="var">r</span> <span class="id" title="var">s</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">path_nat_succ</span>, <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">y'</span>; <span class="id" title="var">z'</span>; (<span class="id" title="var">q</span>, (<span class="id" title="var">inr</span> <span class="id" title="var">r</span>, <span class="id" title="var">inr</span> <span class="id" title="var">s</span>))).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">list_map2</span></span> is a <span class="inlinecode"><span class="id" title="var">list_map</span></span> if the first list is a repeated value. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_map2_repeat_l</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) <span class="id" title="var">l</span> {<span class="id" title="var">defl</span> <span class="id" title="var">defr</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span> (<span class="id" title="var">length</span> <span class="id" title="var">l</span>)) <span class="id" title="var">l</span> = <span class="id" title="var">list_map</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">list_map2</span></span> is a <span class="inlinecode"><span class="id" title="var">list_map</span></span> if the second list is a repeated value. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_map2_repeat_r</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>) <span class="id" title="var">l</span> {<span class="id" title="var">defl</span> <span class="id" title="var">defr</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">y</span> (<span class="id" title="var">length</span> <span class="id" title="var">l</span>)) = <span class="id" title="var">list_map</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1474"></a><h2 class="section">Reversal</h2>

<div class="paragraph"> </div>

 The length of <span class="inlinecode"><span class="id" title="var">reverse_acc</span></span> is the sum of the lengths of the two lists. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_reverse_acc@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">acc</span> <span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">reverse_acc</span> <span class="id" title="var">acc</span> <span class="id" title="var">l</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">acc</span> + <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">acc</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">nat_add_zero_r</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_add_succ_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of <span class="inlinecode"><span class="id" title="var">reverse</span></span> is the same as the length of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_reverse</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">reverse</span> <span class="id" title="var">l</span>) = <span class="id" title="var">length</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">length_reverse_acc</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">list_map</span></span> of a <span class="inlinecode"><span class="id" title="var">reverse_acc</span></span> is the <span class="inlinecode"><span class="id" title="var">reverse_acc</span></span> of the <span class="inlinecode"><span class="id" title="var">list_map</span></span> of the two lists. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_map_reverse_acc</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map</span> <span class="id" title="var">f</span> (<span class="id" title="var">reverse_acc</span> <span class="id" title="var">l'</span> <span class="id" title="var">l</span>) = <span class="id" title="var">reverse_acc</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l'</span>) (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l'</span>; <span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">l'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">list_map</span></span> of a reversed list is the reversed <span class="inlinecode"><span class="id" title="var">list_map</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_map_reverse</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map</span> <span class="id" title="var">f</span> (<span class="id" title="var">reverse</span> <span class="id" title="var">l</span>) = <span class="id" title="var">reverse</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">list_map_reverse_acc</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">reverse_acc</span></span> is the same as concatenating the reversed list with the accumulator. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">reverse_acc_cons</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">reverse_acc</span> <span class="id" title="var">l'</span> <span class="id" title="var">l</span> = <span class="id" title="var">reverse</span> <span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">l'</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">app_assoc</span> <span class="id" title="var">_</span> [<span class="id" title="var">a</span>]).<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">reverse</span></span> of a <span class="inlinecode"><span class="id" title="var">cons</span></span> is the concatenation of the <span class="inlinecode"><span class="id" title="var">reverse</span></span> with the head. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">reverse_cons</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">reverse</span> (<span class="id" title="var">a</span> :: <span class="id" title="var">l</span>) = <span class="id" title="var">reverse</span> <span class="id" title="var">l</span> ++ [<span class="id" title="var">a</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">a</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">reverse_acc_cons</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">reverse</span></span> of a concatenated list is the concatenation of the reversed lists in reverse order. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">reverse_app</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">reverse</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) = <span class="id" title="var">reverse</span> <span class="id" title="var">l'</span> ++ <span class="id" title="var">reverse</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">l'</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">app_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">reverse_cons</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="var">nrapply</span> <span class="id" title="var">reverse_cons</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">l</span> ++ [<span class="id" title="var">a</span>])).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">l'</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">reverse</span></span> is involutive. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">reverse_reverse</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">reverse</span> (<span class="id" title="var">reverse</span> <span class="id" title="var">l</span>) = <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">nrapply</span> <span class="id" title="var">reverse_cons</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">reverse_app</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">IHl</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1475"></a><h2 class="section">Getting elements</h2>

<div class="paragraph"> </div>

 A variant of <span class="inlinecode"><span class="id" title="var">nth</span></span> that returns an element of the list and a proof that it is the <span class="inlinecode"><span class="id" title="var">n</span></span>-th element. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_lt@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: { <span class="id" title="var">x</span> : <span class="id" title="var">A</span> &amp; <span class="id" title="var">nth</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> = <span class="id" title="var">Some</span> <span class="id" title="var">x</span> }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHa</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">H</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_pred'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A variant of <span class="inlinecode"><span class="id" title="var">nth</span></span> that always returns an element when we know that the index is in the list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>) : <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr1</span> (<span class="id" title="var">nth_lt</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>).<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element doesn't depend on the proof that <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'_nth'</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H</span> <span class="id" title="var">H'</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span> = <span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">path_ishprop</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a list is in the list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_nth'@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> (<span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>) <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHa</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">H</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a list is the same as the one given by <span class="inlinecode"><span class="id" title="var">nth</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_nth'</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">nth_lt</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>).2.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a <span class="inlinecode"><span class="id" title="var">cons</span></span> indexed at <span class="inlinecode"><span class="id" title="var">n</span>.+1</span> is the same as the <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of the tail indexed at <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'_cons</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">H'</span> : (<span class="id" title="var">n</span>.+1 &lt; <span class="id" title="var">length</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">l</span>))%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth'</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">l</span>) <span class="id" title="var">n</span>.+1 <span class="id" title="var">H'</span> = <span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinj_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;1,3: <span class="id" title="var">rapply</span> <span class="id" title="var">nth_nth'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The index of an element in a list is the <span class="inlinecode"><span class="id" title="var">n</span></span> such that the <span class="inlinecode"><span class="id" title="var">nth'</span></span> element is the element. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">index_of@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">sig@</span>{<span class="id" title="keyword">Set</span> <span class="id" title="var">i</span>} (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span> =&gt; { <span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span> &amp; <span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span> = <span class="id" title="var">x</span> }).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">intros</span> <span class="id" title="var">x'</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [| <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">paths_ind_r@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">exist@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} <span class="id" title="var">_</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">exist</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> [<span class="id" title="var">H</span> <span class="id" title="var">H'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">exist@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} <span class="id" title="var">_</span> <span class="id" title="var">n</span>.+1%<span class="id" title="var">nat</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">_</span>; <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">leq_succ</span>, <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">H'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nth'_cons</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth</span></span> element of a map is the function applied optionally to the <span class="inlinecode"><span class="id" title="var">nth</span></span> element of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_list_map@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">B</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">j</span>}}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>) <span class="id" title="var">n</span> = <span class="id" title="var">functor_option</span> <span class="id" title="var">f</span> (<span class="id" title="var">nth</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a <span class="inlinecode"><span class="id" title="var">list_map</span></span> is the function applied to the <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'_list_map@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">B</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">j</span>}}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H'</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>))%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth'</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>) <span class="id" title="var">n</span> <span class="id" title="var">H'</span> = <span class="id" title="var">f</span> (<span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">H</span>, <span class="id" title="var">H'</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a <span class="inlinecode"><span class="id" title="var">list_map2</span></span> is the function applied to the <span class="inlinecode"><span class="id" title="var">nth'</span></span> elements of the original lists. The length of the two lists is required to be the same. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'_list_map2</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">l1</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> (<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l1</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">H'</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l2</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H''</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> (<span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>))%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">length</span> <span class="id" title="var">l1</span> = <span class="id" title="var">length</span> <span class="id" title="var">l2</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">f</span> (<span class="id" title="var">nth'</span> <span class="id" title="var">l1</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span>) (<span class="id" title="var">nth'</span> <span class="id" title="var">l2</span> <span class="id" title="var">n</span> <span class="id" title="var">H'</span>) = <span class="id" title="var">nth'</span> (<span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>) <span class="id" title="var">n</span> <span class="id" title="var">H''</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l2</span> <span class="id" title="var">n</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">H</span> <span class="id" title="var">H'</span> <span class="id" title="var">H''</span> <span class="id" title="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l1</span> <span class="id" title="var">a</span> <span class="id" title="var">l1</span> <span class="id" title="var">IHl1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l2</span> <span class="id" title="var">n</span> <span class="id" title="var">defl</span> <span class="id" title="var">defr</span> <span class="id" title="var">H</span> <span class="id" title="var">H'</span> <span class="id" title="var">H''</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">l2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">l2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">erewrite</span> 3 <span class="id" title="var">nth'_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">path_nat_succ</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> is the repeated value. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'_repeat@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">i</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">length</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>))%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth'</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span> <span class="id" title="var">H</span> = <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>, <span class="id" title="var">H</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">nat_ind@</span>{<span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Two lists are equal if their <span class="inlinecode"><span class="id" title="var">nth'</span></span> elements are equal. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_list_nth'@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">length</span> <span class="id" title="var">l</span> = <span class="id" title="var">length</span> <span class="id" title="var">l'</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> (<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>), <span class="id" title="var">nth'</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">H</span> = <span class="id" title="var">nth'</span> <span class="id" title="var">l'</span> <span class="id" title="var">n</span> (<span class="id" title="var">p</span> # <span class="id" title="var">H</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">l</span> = <span class="id" title="var">l'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">l'</span>, <span class="id" title="var">p</span>, <span class="id" title="var">H</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">l'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">discriminate</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l'</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a'</span> <span class="id" title="var">l'</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">H</span> 0%<span class="id" title="var">nat</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">snrapply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">path_nat_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrefine</span> ((<span class="id" title="var">nth'_cons</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">Hn</span> <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">leq_succ</span>, <span class="id" title="var">Hn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">nth'_cons</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> element of a concatenated list <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">l'</span></span> where <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> is the <span class="inlinecode"><span class="id" title="var">nth</span></span> element of <span class="inlinecode"><span class="id" title="var">l</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_app@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) <span class="id" title="var">n</span> = <span class="id" title="var">nth</span> <span class="id" title="var">l</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">l'</span>, <span class="id" title="var">n</span>, <span class="id" title="var">H</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>, <span class="id" title="var">leq_pred'</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth</span></span> <span class="inlinecode"><span class="id" title="var">i</span></span> element where <span class="inlinecode"><span class="id" title="var">pred</span></span> <span class="inlinecode">(<span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">i</span></span> is the last element of the list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_last</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">nat_pred</span> (<span class="id" title="var">length</span> <span class="id" title="var">l</span>) = <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth</span> <span class="id" title="var">l</span> <span class="id" title="var">i</span> = <span class="id" title="var">last</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">b</span> <span class="id" title="var">l</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The last element of a list with an element appended is the appended element. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">last_app</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">last</span> (<span class="id" title="var">l</span> ++ [<span class="id" title="var">x</span>]) = <span class="id" title="var">Some</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">x</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1476"></a><h2 class="section">Removing elements</h2>

<div class="paragraph"> </div>

 These functions allow surgery to be perfomed on a given list. 
<div class="paragraph"> </div>

<a id="lab1477"></a><h3 class="section">Drop</h3>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">drop</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> removes the first <span class="inlinecode"><span class="id" title="var">n</span></span> elements of <span class="inlinecode"><span class="id" title="var">l</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">drop</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span>, <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> :: <span class="id" title="var">l</span>, <span class="id" title="var">n</span>.+1%<span class="id" title="var">nat</span> =&gt; <span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">drop</span></span> of zero elements is the identity. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drop_0</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">drop</span> 0 <span class="id" title="var">l</span> = <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">drop</span></span> of one element is the tail of the list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drop_1</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">drop</span> 1 <span class="id" title="var">l</span> = <span class="id" title="var">tail</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">drop</span></span> of the empty list is the empty list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drop_nil</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">drop</span> <span class="id" title="var">n</span> (@<span class="id" title="var">nil</span> <span class="id" title="var">A</span>) = <span class="id" title="var">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">drop</span></span> of <span class="inlinecode"><span class="id" title="var">n</span></span> elements with <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">&lt;=</span> <span class="inlinecode"><span class="id" title="var">n</span></span> is the empty list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drop_length_leq@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">length</span> <span class="id" title="var">l</span> &lt;= <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span> = <span class="id" title="var">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>, <span class="id" title="var">n</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">drop_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_pred'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of a <span class="inlinecode"><span class="id" title="var">drop</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is the length of the original list minus <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_drop@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">l</span> - <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">drop_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a <span class="inlinecode"><span class="id" title="var">drop</span></span> is an element of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">drop_inlist@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">drop</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">H</span>, <span class="id" title="var">x</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">rewrite</span> <span class="id" title="var">drop_nil</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">rewrite</span> <span class="id" title="var">drop_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">right</span>; <span class="id" title="var">nrapply</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1478"></a><h3 class="section">Take</h3>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">take</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> keeps the first <span class="inlinecode"><span class="id" title="var">n</span></span> elements of <span class="inlinecode"><span class="id" title="var">l</span></span> and returns <span class="inlinecode"><span class="id" title="var">l</span></span> if <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;=</span> <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">take</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span>, <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> :: <span class="id" title="var">l</span>, <span class="id" title="var">n</span>.+1%<span class="id" title="var">nat</span> =&gt; <span class="id" title="var">x</span> :: <span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">take</span></span> of zero elements is the empty list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">take_0</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">take</span> 0 <span class="id" title="var">l</span> = <span class="id" title="var">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">take</span></span> of the empty list is the empty list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">take_nil</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">take</span> <span class="id" title="var">n</span> (@<span class="id" title="var">nil</span> <span class="id" title="var">A</span>) = <span class="id" title="var">nil</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">take</span></span> of <span class="inlinecode"><span class="id" title="var">n</span></span> elements with <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">&lt;=</span> <span class="inlinecode"><span class="id" title="var">n</span></span> is the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">take_length_leq@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">length</span> <span class="id" title="var">l</span> &lt;= <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span> = <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>, <span class="id" title="var">n</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">take_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>, <span class="id" title="var">leq_pred'</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of a <span class="inlinecode"><span class="id" title="var">take</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is the minimum of <span class="inlinecode"><span class="id" title="var">n</span></span> and the length of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_take@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) = <span class="id" title="var">nat_min</span> <span class="id" title="var">n</span> (<span class="id" title="var">length</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">take_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_min_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a <span class="inlinecode"><span class="id" title="var">take</span></span> is an element of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">take_inlist@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">H</span>, <span class="id" title="var">x</span> |- * <span class="id" title="keyword">using</span> <span class="id" title="var">list_ind@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">rewrite</span> <span class="id" title="var">take_nil</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">rewrite</span> <span class="id" title="var">take_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [-&gt; | <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">left</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">right</span>; <span class="id" title="tactic">exact</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1479"></a><h3 class="section">Remove</h3>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">remove</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> removes the <span class="inlinecode"><span class="id" title="var">n</span></span>-th element of <span class="inlinecode"><span class="id" title="var">l</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">list</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">take</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span> ++ <span class="id" title="var">drop</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">l</span>.<br/>

<br/>
</div>

<div class="doc">
Removing the first element of a list is the tail of the list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove_0</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="var">remove</span> 0 <span class="id" title="var">l</span> = <span class="id" title="var">tail</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">remove</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">take_0</span>, <span class="id" title="var">drop_1</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Removing the <span class="inlinecode"><span class="id" title="var">n</span></span>-th element of a list with <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">&lt;=</span> <span class="inlinecode"><span class="id" title="var">n</span></span> is the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove_length_leq</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">length</span> <span class="id" title="var">l</span> &lt;= <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">remove</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span> = <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">remove</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">take_length_leq</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">drop_length_leq</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">app_nil</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of a <span class="inlinecode"><span class="id" title="var">remove</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is the length of the original list minus one. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_remove@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">remove</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) = <span class="id" title="var">nat_pred</span> (<span class="id" title="var">length</span> <span class="id" title="var">l</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">remove</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_app@</span>{<span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_take</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_drop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_min_l</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> (<span class="id" title="var">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">nat_sub_l_add_r</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nat_sub_succ_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nat_add_sub_cancel_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a <span class="inlinecode"><span class="id" title="var">remove</span></span> is an element of the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove_inlist</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">remove</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>) -&gt; <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">remove</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_inlist_app</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">sum_rec</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">take_inlist</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">drop_inlist</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1480"></a><h3 class="section">Filter</h3>

<div class="paragraph"> </div>

 Produce the list of elements of a list that satisfy a decidable predicate. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">list_filter@</span>{<span class="id" title="var">u</span> <span class="id" title="var">v</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">u</span>}} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Type@</span>{<span class="id" title="var">v</span>})<br/>
&nbsp;&nbsp;(<span class="id" title="var">dec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">x</span> :: <span class="id" title="var">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">dec</span> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> <span class="id" title="var">x</span> :: <span class="id" title="var">list_filter</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span> <span class="id" title="var">dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">list_filter</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span> <span class="id" title="var">dec</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_filter@</span>{<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">k</span> | <span class="id" title="var">u</span> &lt;= <span class="id" title="var">k</span>, <span class="id" title="var">v</span> &lt;= <span class="id" title="var">k</span>} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">u</span>}} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Type@</span>{<span class="id" title="var">v</span>}) (<span class="id" title="var">dec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">iff@</span>{<span class="id" title="var">u</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span>} (<span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">list_filter</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span> <span class="id" title="var">dec</span>)) (<span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> /\ <span class="id" title="var">P</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iff_inverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iff_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">prod_empty_l@</span>{<span class="id" title="var">v</span>}.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">apply</span> <span class="id" title="var">iff_inverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iff_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">sum_distrib_r@</span>{<span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> <span class="id" title="var">a</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span>|<span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">sum</span> (<span class="id" title="var">a</span> = <span class="id" title="var">x</span>) (<span class="id" title="var">prod</span> (<span class="id" title="var">InList@</span>{<span class="id" title="var">u</span>} <span class="id" title="var">x</span> <span class="id" title="var">l</span>) (<span class="id" title="var">P</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">functor_sum</span>; <span class="id" title="var">only</span> 1,3: <span class="id" title="tactic">exact</span> <span class="id" title="var">idmap</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">functor_sum@</span>{<span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span>}; <span class="id" title="var">only</span> 2,4: <span class="id" title="tactic">apply</span> <span class="id" title="var">idmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">idpath</span>, <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">exact</span> <span class="id" title="var">fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">nrapply</span> <span class="id" title="var">iff_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iff_inverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">iff_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">equiv_compose'@</span>{<span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span>} (<span class="id" title="var">sum_empty_l@</span>{<span class="id" title="var">k</span>} <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">equiv_functor_sum'@</span>{<span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">exact</span> <span class="id" title="var">equiv_idmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_to_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [[] <span class="id" title="var">r</span>].<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_filter_app</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> <span class="id" title="var">l'</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">dec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_filter</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">l'</span>) <span class="id" title="var">P</span> <span class="id" title="var">dec</span> = <span class="id" title="var">list_filter</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span> <span class="id" title="var">dec</span> ++ <span class="id" title="var">list_filter</span> <span class="id" title="var">l'</span> <span class="id" title="var">P</span> <span class="id" title="var">dec</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> <span class="id" title="var">a</span>); <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1481"></a><h2 class="section">Sequences</h2>

<div class="paragraph"> </div>

 The length of a reverse sequence of <span class="inlinecode"><span class="id" title="var">n</span></span> numbers is <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_seq_rev@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">seq_rev</span> <span class="id" title="var">n</span>) = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of a sequence of <span class="inlinecode"><span class="id" title="var">n</span></span> numbers is <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_seq@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">seq</span> <span class="id" title="var">n</span>) = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">length_reverse</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">length_seq_rev</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The reversed sequence of <span class="inlinecode"><span class="id" title="var">n</span>.+1</span> numbers is the <span class="inlinecode"><span class="id" title="var">n</span></span> followed by the rest of the reversed sequence. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_rev_cons@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">seq_rev</span> <span class="id" title="var">n</span>.+1 = <span class="id" title="var">n</span> :: <span class="id" title="var">seq_rev</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The sequence of <span class="inlinecode"><span class="id" title="var">n</span>.+1</span> numbers is the sequence of <span class="inlinecode"><span class="id" title="var">n</span></span> numbers concatenated with <span class="inlinecode">[<span class="id" title="var">n</span>]</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_succ@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">seq</span> <span class="id" title="var">n</span>.+1 = <span class="id" title="var">seq</span> <span class="id" title="var">n</span> ++ [<span class="id" title="var">n</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">reverse_cons</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Alternate definition of <span class="inlinecode"><span class="id" title="var">seq_rev</span></span> that keeps the proofs of the entries being <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_rev'@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">list</span> {<span class="id" title="var">k</span> : <span class="id" title="var">nat</span> &amp; (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">transparent</span> <span class="id" title="tactic">assert</span> (<span class="id" title="var">f</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, {<span class="id" title="var">k</span> : <span class="id" title="var">nat</span> &amp; (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; {<span class="id" title="var">k</span> : <span class="id" title="var">nat</span> &amp; (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>})).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">functor_sigma</span> <span class="id" title="var">idmap</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">leq_succ_r</span> <span class="id" title="var">H</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrefine</span> ((<span class="id" title="var">n</span>; <span class="id" title="var">_</span>) :: <span class="id" title="var">list_map</span> (<span class="id" title="var">f</span> <span class="id" title="var">n</span>) <span class="id" title="var">IHn</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Alternate definition of <span class="inlinecode"><span class="id" title="var">seq</span></span> that keeps the proofs of the entries being <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq'@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">list</span> {<span class="id" title="var">k</span> : <span class="id" title="var">nat</span> &amp; (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">reverse</span> (<span class="id" title="var">seq_rev'</span> <span class="id" title="var">n</span>).<br/>

<br/>
</div>

<div class="doc">
The length of <span class="inlinecode"><span class="id" title="var">seq_rev'</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_seq_rev'@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">seq_rev'</span> <span class="id" title="var">n</span>) = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">length_list_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of <span class="inlinecode"><span class="id" title="var">seq'</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_seq'@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">seq'</span> <span class="id" title="var">n</span>) = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">length_reverse</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">length_seq_rev'</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">list_map</span></span> of first projections on <span class="inlinecode"><span class="id" title="var">seq_rev'</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">seq_rev</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_rev_seq_rev'@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map</span> <span class="id" title="var">pr1</span> (<span class="id" title="var">seq_rev'</span> <span class="id" title="var">n</span>) = <span class="id" title="var">seq_rev</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">list_map_compose</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">list_map</span></span> of first projections on <span class="inlinecode"><span class="id" title="var">seq'</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> is <span class="inlinecode"><span class="id" title="var">seq</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_seq'@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_map</span> <span class="id" title="var">pr1</span> (<span class="id" title="var">seq'</span> <span class="id" title="var">n</span>) = <span class="id" title="var">seq</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">list_map_reverse_acc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">reverse</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">seq_rev_seq_rev'</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth</span></span> element of a <span class="inlinecode"><span class="id" title="var">seq_rev</span></span> is <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">i</span>.+1</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_seq_rev@</span>{} {<span class="id" title="var">n</span> <span class="id" title="var">i</span>} (<span class="id" title="var">H</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth</span> (<span class="id" title="var">seq_rev</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span> = <span class="id" title="var">Some</span> (<span class="id" title="var">n</span> - <span class="id" title="var">i</span>.+1)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">i</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">i</span> <span class="id" title="var">IHi</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">H</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_sub_zero_r</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHi</span>, <span class="id" title="var">leq_pred'</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth</span></span> element of a <span class="inlinecode"><span class="id" title="var">seq</span></span> is <span class="inlinecode"><span class="id" title="var">i</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth_seq@</span>{} {<span class="id" title="var">n</span> <span class="id" title="var">i</span>} (<span class="id" title="var">H</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">nth</span> (<span class="id" title="var">seq</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span> = <span class="id" title="var">Some</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">destruct</span> (<span class="id" title="var">not_lt_zero_r</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">seq_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H'</span>|<span class="id" title="var">H'</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nth_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_seq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">geq_iff_not_lt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">leq_pred'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">leq_antisym</span> <span class="id" title="var">H</span> <span class="id" title="var">H'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nth_last</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">nat_add_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">length_seq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">last_app</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">nth'</span></span> element of a <span class="inlinecode"><span class="id" title="var">seq'</span></span> is <span class="inlinecode"><span class="id" title="var">i</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nth'_seq'@</span>{} (<span class="id" title="var">n</span> <span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">length</span> (<span class="id" title="var">seq'</span> <span class="id" title="var">n</span>))%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">nth'</span> (<span class="id" title="var">seq'</span> <span class="id" title="var">n</span>) <span class="id" title="var">i</span> <span class="id" title="var">H</span>).1 = <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nth'_list_map</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_list_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">ap011D</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">nth'</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>) <span class="id" title="var">_</span> <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">seq_seq'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinj_some</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">nth_nth'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">nth_seq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_seq'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_seq@</span>{} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">x</span> (<span class="id" title="var">seq</span> <span class="id" title="var">n</span>) &lt;~&gt; (<span class="id" title="var">x</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_induction</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> <span class="id" title="var">IHn</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_to_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">not_lt_zero_r</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> (<span class="id" title="var">seq_succ</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_inlist_app</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1).<br/>
&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_functor_sum'</span> (<span class="id" title="var">B'</span>:=<span class="id" title="var">x</span> = <span class="id" title="var">n</span>) <span class="id" title="var">IHn</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;2: { <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_path_inverse</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">sum_empty_r@</span>{<span class="id" title="keyword">Set</span>} <span class="id" title="var">_</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_leq_lt_or_eq</span>^-1).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">equiv_iff_hprop</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1482"></a><h2 class="section">Repeat</h2>

<div class="paragraph"> </div>

 The length of a repeated list is the number of repetitions. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_repeat@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">using</span> <span class="id" title="var">nat_ind@</span>{<span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">ap</span> <span class="id" title="var">S</span> <span class="id" title="var">IHn</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An element of a repeated list is equal to the repeated element. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_repeat@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">InList</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">y</span> = <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1:<span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> | <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1483"></a><h2 class="section">Forall</h2>

<div class="paragraph"> </div>

 If a predicate holds for all elements of a list, the the <span class="inlinecode"><span class="id" title="var">for_all</span></span> predicate holds for the list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">for_all_inlist</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;: (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>) -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">h</span> <span class="id" title="var">t</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">trivial</span>; <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">right</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Conversely, if <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> then each element of the list satisfies <span class="inlinecode"><span class="id" title="var">P</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_for_all</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl</span>] <span class="id" title="var">y</span> [-&gt; | <span class="id" title="var">i</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">i</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If a predicate <span class="inlinecode"><span class="id" title="var">P</span></span> implies a predicate <span class="inlinecode"><span class="id" title="var">Q</span></span> composed with a function <span class="inlinecode"><span class="id" title="var">f</span></span>, then <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> implies <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode">(<span class="id" title="var">list_map</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">l</span>)</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">for_all_list_map</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">Hf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">Q</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">Q</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A variant of <span class="inlinecode"><span class="id" title="var">for_all_map</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> where <span class="inlinecode"><span class="id" title="var">Q</span></span> is <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">for_all_list_map'</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, <span class="id" title="var">for_all</span> (<span class="id" title="var">P</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>) <span class="id" title="var">l</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> (<span class="id" title="var">list_map</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">for_all_list_map</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If a predicate <span class="inlinecode"><span class="id" title="var">P</span></span> and a predicate <span class="inlinecode"><span class="id" title="var">Q</span></span> together imply a predicate <span class="inlinecode"><span class="id" title="var">R</span></span>, then <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> and <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> together imply <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">R</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span>. There are also some side conditions for the default elements. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">for_all_list_map2</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">Hf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">R</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;<span class="id" title="var">def_l</span> (<span class="id" title="var">Hdefl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l1</span>, <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l1</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">R</span> (<span class="id" title="var">def_l</span> <span class="id" title="var">l1</span>))<br/>
&nbsp;&nbsp;<span class="id" title="var">def_r</span> (<span class="id" title="var">Hdefr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l2</span>, <span class="id" title="var">for_all</span> <span class="id" title="var">Q</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">R</span> (<span class="id" title="var">def_r</span> <span class="id" title="var">l2</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">l1</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l1</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">Q</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">R</span> (<span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">def_l</span> <span class="id" title="var">def_r</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l1</span> <span class="id" title="var">x</span> <span class="id" title="var">l1</span> <span class="id" title="var">IHl1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span> <span class="id" title="var">l2</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span> <span class="id" title="var">l2</span>]; <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl1</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> | <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hy</span> <span class="id" title="var">Hl2</span>] ]; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hdefl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A simpler variant of <span class="inlinecode"><span class="id" title="var">for_all_map2</span></span> where both lists have the same length and the side conditions on the default elements can be avoided. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">for_all_list_map2'</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">Hf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">R</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;{<span class="id" title="var">def_l</span> <span class="id" title="var">def_r</span>} {<span class="id" title="var">l1</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>} {<span class="id" title="var">l2</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">length</span> <span class="id" title="var">l1</span> = <span class="id" title="var">length</span> <span class="id" title="var">l2</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l1</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">Q</span> <span class="id" title="var">l2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">R</span> (<span class="id" title="var">list_map2</span> <span class="id" title="var">f</span> <span class="id" title="var">def_l</span> <span class="id" title="var">def_r</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">l2</span> <span class="id" title="var">p</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l1</span> <span class="id" title="var">x</span> <span class="id" title="var">l1</span> <span class="id" title="var">IHl1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l2</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">l2</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">y</span> <span class="id" title="var">l2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl1</span>] [<span class="id" title="var">Hy</span> <span class="id" title="var">Hl2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl1</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_nat_succ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The left fold of <span class="inlinecode"><span class="id" title="var">f</span></span> on a list <span class="inlinecode"><span class="id" title="var">l</span></span> for which <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> satisfies <span class="inlinecode"><span class="id" title="var">P</span></span> if <span class="inlinecode"><span class="id" title="var">P</span></span> and <span class="inlinecode"><span class="id" title="var">Q</span></span> imply <span class="inlinecode"><span class="id" title="var">P</span></span> composed with <span class="inlinecode"><span class="id" title="var">f</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_left_preserves</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Q</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Hf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">Q</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">acc</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">Ha</span> : <span class="id" title="var">P</span> <span class="id" title="var">acc</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">B</span>) (<span class="id" title="var">Hl</span> : <span class="id" title="var">for_all</span> <span class="id" title="var">Q</span> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">P</span> (<span class="id" title="var">fold_left</span> <span class="id" title="var">f</span> <span class="id" title="var">l</span> <span class="id" title="var">acc</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">acc</span> <span class="id" title="var">Ha</span> <span class="id" title="var">Hl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">acc</span> <span class="id" title="var">Ha</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">Ha</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Qx</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">for_all</span></span> preserves the truncation predicate. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">istrunc_for_all</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">for_all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)) <span class="id" title="var">l</span> -&gt; <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">istrunc_for_all'</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_for_all</span>, <span class="id" title="var">for_all_inlist</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If a predicate holds for an element, then it holds <span class="inlinecode"><span class="id" title="var">for_all</span></span> the elements of the repeated list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">for_all_repeat</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> (<span class="id" title="tactic">repeat</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">tt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">H</span>, <span class="id" title="var">IHn</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can form a list of pairs of a sigma type given a list and a for_all predicate over it. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_sigma</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> {<span class="id" title="var">x</span> : <span class="id" title="var">A</span> &amp; <span class="id" title="var">P</span> <span class="id" title="var">x</span>}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>] <span class="id" title="tactic">in</span> <span class="id" title="var">p</span> |- *.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">x</span>; <span class="id" title="var">Hx</span>) :: <span class="id" title="var">IHl</span> <span class="id" title="var">Hl</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length of a list of sigma types is the same as the original list. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">length_list_sigma</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>} {<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>} {<span class="id" title="var">p</span> : <span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">length</span> (<span class="id" title="var">list_sigma</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span> <span class="id" title="var">p</span>) = <span class="id" title="var">length</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">p</span>; <span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hx</span> <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHl</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If a predicate <span class="inlinecode"><span class="id" title="var">P</span></span> is decidable then so is <span class="inlinecode"><span class="id" title="var">for_all</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">decidable_for_all</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Decidable</span> (<span class="id" title="var">for_all</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If a predicate <span class="inlinecode"><span class="id" title="var">P</span></span> is decidable then so is <span class="inlinecode"><span class="id" title="var">list_exists</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">decidable_list_exists</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)} (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Decidable</span> (<span class="id" title="var">list_exists</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inlist_list_exists</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list_exists</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="tactic">exists</span> (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>), <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> /\ <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">Px</span> | <span class="id" title="var">ex</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">left</span>|].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">ex</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> [<span class="id" title="var">H</span> <span class="id" title="var">Px'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">x'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">right</span>|].<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_exists_inlist</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>), <span class="id" title="var">InList</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">list_exists</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">simple_list_induction</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> <span class="id" title="var">IHl</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">H</span> <span class="id" title="var">p</span>; <span class="id" title="var">revert</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">functor_sum</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">r</span>^ # <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHl</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">list_exists_seq</span> {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span>, <span class="id" title="var">P</span> <span class="id" title="var">k</span> -&gt; (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>, <span class="id" title="var">P</span> <span class="id" title="var">k</span>) &lt;-&gt; <span class="id" title="var">list_exists</span> <span class="id" title="var">P</span> (<span class="id" title="var">seq</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">k</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">list_exists_inlist</span> <span class="id" title="var">P</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_seq</span>, <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inlist_list_exists</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H1</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">k</span> [<span class="id" title="var">Hk</span> <span class="id" title="var">p</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
An upper bound on witnesses of a decidable predicate makes the sigma type decidable. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">decidable_exists_nat</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">nat</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span>, <span class="id" title="var">P</span> <span class="id" title="var">k</span> -&gt; (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">P</span> <span class="id" title="var">k</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">Decidable</span> (<span class="id" title="tactic">exists</span> <span class="id" title="var">k</span>, <span class="id" title="var">P</span> <span class="id" title="var">k</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">decidable_iff</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">iff_inverse</span>; <span class="id" title="var">nrapply</span> <span class="id" title="var">list_exists_seq</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>