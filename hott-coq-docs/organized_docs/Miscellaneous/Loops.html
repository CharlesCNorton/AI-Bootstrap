<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Loops</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Loops</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span> <span class="id" title="var">HoTT.Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HFiber</span> <span class="id" title="var">Factorization</span> <span class="id" title="var">Truncations.Core</span> <span class="id" title="var">Truncations.Connectedness</span> <span class="id" title="var">HProp</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Pointed.Core</span> <span class="id" title="var">Pointed.pEquiv</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">WildCat</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.Nat.Core</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">pointed_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1297"></a><h2 class="section">Loop spaces</h2>

<div class="paragraph"> </div>

 The type <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">x</span></span> is pointed. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ispointed_loops</span> <span class="id" title="var">A</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">IsPointed</span> (<span class="id" title="var">a</span> = <span class="id" title="var">a</span>) := 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loops</span> (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>) : <span class="id" title="var">pType</span><br/>
&nbsp;&nbsp;:= [<span class="id" title="var">point</span> <span class="id" title="var">A</span> = <span class="id" title="var">point</span> <span class="id" title="var">A</span>, 1].<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iterated_loops</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>) : <span class="id" title="var">pType</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">nat_iter</span> <span class="id" title="var">n</span> <span class="id" title="var">loops</span> <span class="id" title="var">A</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Inner&nbsp;unfolding&nbsp;for&nbsp;iterated&nbsp;loops&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfold_iterated_loops</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">X</span> = <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> (<span class="id" title="var">loops</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">nat_iter_succ_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
The loop space decreases the truncation level by one.  We don't bother making this an instance because it is automatically found by typeclass search, but we record it here in case anyone is looking for it. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">istrunc_loops</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>) `{<span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">loops</span> <span class="id" title="var">A</span>) := <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
Similarly for connectedness. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isconnected_loops</span> `{<span class="id" title="var">Univalence</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;`{<span class="id" title="var">IsConnected</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">A</span>} : <span class="id" title="var">IsConnected</span> <span class="id" title="var">n</span> (<span class="id" title="var">loops</span> <span class="id" title="var">A</span>) := <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pequiv_loops_punit</span> : <span class="id" title="var">loops</span> <span class="id" title="var">pUnit</span> &lt;~&gt;* <span class="id" title="var">pUnit</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">srapply</span> (<span class="id" title="var">equiv_adjointify</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tt</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">idpath</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">path_contr</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1298"></a><h2 class="section">Functoriality of loop spaces</h2>

<div class="paragraph"> </div>

 Action on 1-cells 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is0functor_loops</span> : <span class="id" title="var">Is0Functor</span> <span class="id" title="var">loops</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Build_Is0Functor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Build_pMap</span> (<span class="id" title="var">loops</span> <span class="id" title="var">A</span>) (<span class="id" title="var">loops</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>)^ @ (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> @ <span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">concat_Vp</span> (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerL</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_1p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is1functor_loops</span> : <span class="id" title="var">Is1Functor</span> <span class="id" title="var">loops</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Build_Is1Functor</span>.<br/>
</div>

<div class="doc">
Action on 2-cells 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pointed_reduce</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pHomotopy</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span>)^ @ (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">concat_Ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">p</span> <span class="id" title="var">x</span> @ 1)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">generalize</span> (<span class="id" title="var">p</span> <span class="id" title="var">point0</span>). <span class="id" title="tactic">generalize</span> (<span class="id" title="var">g</span> <span class="id" title="var">point0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span> []. <span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<div class="doc">
Preservation of identity. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span> @ <span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ap_idmap</span> <span class="id" title="var">_</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<div class="doc">
Preservation of compositon. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">c</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">inv_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @@ 1) @ <span class="id" title="var">concat_pp_p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (((<span class="id" title="var">ap_V</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^ @@ 1) @ <span class="id" title="var">_</span> @ <span class="id" title="var">concat_p_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ ((<span class="id" title="var">ap_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^ @@ 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">concat_p_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ ((<span class="id" title="var">ap_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^ @@ 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap_compose</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">pointed_reduce</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1299"></a><h3 class="section">Properties of loops functor</h3>

<div class="paragraph"> </div>

 Loops functor distributes over concatenation 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmap_loops_pp</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt;* <span class="id" title="var">Y</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">loops</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span> (<span class="id" title="var">x</span> @ <span class="id" title="var">y</span>) = <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> @ <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">pointed_reduce_rewrite</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap_pp</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Loops is a pointed functor 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ispointedfunctor_loops</span> : <span class="id" title="var">IsPointedFunctor</span> <span class="id" title="var">loops</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_IsPointedFunctor'</span>.<br/>
&nbsp;&nbsp;1-4: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">pequiv_loops_punit</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmap_loops_pconst</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>} : <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (@<span class="id" title="var">pconst</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) ==* <span class="id" title="var">pconst</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">fmap_zero_morphism</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1300"></a><h3 class="section">Iterated loops functor</h3>

<div class="paragraph"> </div>

 Action on 1-cells 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is0functor_iterated_loops</span> <span class="id" title="var">n</span> : <span class="id" title="var">Is0Functor</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">is0functor_compose</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is1functor_iterated_loops</span> <span class="id" title="var">n</span> : <span class="id" title="var">Is1Functor</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">is1functor_compose</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmap_iterated_loops_pp</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt;* <span class="id" title="var">Y</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1) <span class="id" title="var">f</span> (<span class="id" title="var">x</span> @ <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1) <span class="id" title="var">f</span> <span class="id" title="var">x</span> @ <span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1) <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">fmap_loops_pp</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The fiber of <span class="inlinecode"><span class="id" title="var">fmap</span></span> <span class="inlinecode"><span class="id" title="var">loops</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> is equivalent to a fiber of <span class="inlinecode"><span class="id" title="var">ap</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_fmap_loops</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">loops</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: {<span class="id" title="var">q</span> : <span class="id" title="var">loops</span> <span class="id" title="var">A</span> &amp; <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span> = (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span> @ <span class="id" title="var">p</span>) @ (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>)^}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">hfiber</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>) <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_moveR_Vp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_moveR_pM</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The loop space functor decreases the truncation level by one.  
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">istrunc_fmap_loops</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;`{<span class="id" title="var">IsTruncMap</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>} : <span class="id" title="var">IsTruncMap</span> <span class="id" title="var">n</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">istrunc_equiv_istrunc</span> <span class="id" title="var">_</span> (<span class="id" title="var">hfiber_fmap_loops</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
And likewise the connectedness.  
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isconnected_fmap_loops</span> `{<span class="id" title="var">Univalence</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>) `{<span class="id" title="var">IsConnMap</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">n</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">eapply</span> <span class="id" title="var">isconnected_equiv'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> (<span class="id" title="var">hfiber_fmap_loops</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">hfiber_ap</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isconnected_iterated_fmap_loops</span> `{<span class="id" title="var">Univalence</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">C</span> : <span class="id" title="var">IsConnMap</span> (<span class="id" title="var">trunc_index_inc'</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span>) <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">n</span> (<span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">k</span>) <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">k</span> <span class="id" title="tactic">in</span> <span class="id" title="var">n</span>, <span class="id" title="var">C</span> |- *.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">C</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">isconnected_fmap_loops</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">C</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
It follows that loop spaces "commute with images". 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_loops_image</span> `{<span class="id" title="var">Univalence</span>} <span class="id" title="var">n</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loops</span> ([<span class="id" title="var">image</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">f</span>, <span class="id" title="var">factor1</span> (<span class="id" title="var">image</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">f</span>) (<span class="id" title="var">point</span> <span class="id" title="var">A</span>)])<br/>
&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">image</span> <span class="id" title="var">n</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">C</span> := [<span class="id" title="var">image</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">f</span>, <span class="id" title="var">factor1</span> (<span class="id" title="var">image</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">f</span>) (<span class="id" title="var">point</span> <span class="id" title="var">A</span>)]).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">g</span> := <span class="id" title="var">Build_pMap</span> <span class="id" title="var">A</span> <span class="id" title="var">C</span> (<span class="id" title="var">factor1</span> (<span class="id" title="var">image</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">f</span>)) 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">h</span> := <span class="id" title="var">Build_pMap</span> <span class="id" title="var">C</span> <span class="id" title="var">B</span> (<span class="id" title="var">factor2</span> (<span class="id" title="var">image</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">f</span>)) (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">transparent</span> <span class="id" title="tactic">assert</span> (<span class="id" title="var">I</span> : (<span class="id" title="var">Factorization</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">IsConnMap</span> <span class="id" title="var">n</span>) (@<span class="id" title="var">MapIn</span> <span class="id" title="var">n</span>) (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>))).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (@<span class="id" title="var">Build_Factorization</span> (@<span class="id" title="var">IsConnMap</span> <span class="id" title="var">n</span>) (@<span class="id" title="var">MapIn</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">loops</span> <span class="id" title="var">A</span>) (<span class="id" title="var">loops</span> <span class="id" title="var">B</span>) (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>) (<span class="id" title="var">loops</span> <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">g</span>) (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">h</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">concat_1p</span>; <span class="id" title="tactic">reflexivity</span>). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">path_intermediate</span> (<span class="id" title="var">path_factor</span> (<span class="id" title="var">O_factsys</span> <span class="id" title="var">n</span>) (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>) <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">image</span> <span class="id" title="var">n</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>)))).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Loop inversion is a pointed equivalence 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loops_inv</span> (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>) : <span class="id" title="var">loops</span> <span class="id" title="var">A</span> &lt;~&gt;* <span class="id" title="var">loops</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pEquiv</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">Build_pMap</span> (<span class="id" title="var">loops</span> <span class="id" title="var">A</span>) (<span class="id" title="var">loops</span> <span class="id" title="var">A</span>) <span class="id" title="var">inverse</span> 1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_path_inverse</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Loops functor preserves equivalences 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pequiv_fmap_loops</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">A</span> $&lt;~&gt; <span class="id" title="var">B</span> -&gt; <span class="id" title="var">loops</span> <span class="id" title="var">A</span> $&lt;~&gt; <span class="id" title="var">loops</span> <span class="id" title="var">B</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">emap</span> <span class="id" title="var">loops</span>.<br/>

<br/>
</div>

<div class="doc">
A version of <span class="inlinecode"><span class="id" title="var">unfold_iterated_loops</span></span> that's an equivalence rather than an equality.  We could get this from the equality, but it's more useful to construct it explicitly since then we can reason about it. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfold_iterated_loops'</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">X</span> &lt;~&gt;* <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> (<span class="id" title="var">loops</span> <span class="id" title="var">X</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+2 <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">loops</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pequiv_fmap_loops</span>, <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
For instance, we can prove that it's natural. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unfold_iterated_fmap_loops</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">unfold_iterated_loops'</span> <span class="id" title="var">n</span> <span class="id" title="var">B</span>) <span class="id" title="var">o</span>* (<span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>.+1) <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;==* (<span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>) (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>)) <span class="id" title="var">o</span>* (<span class="id" title="var">unfold_iterated_loops'</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">srefine</span> (<span class="id" title="var">Build_pHomotopy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_pV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">ap_idmap</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> ((<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @* (<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">fmap2</span> <span class="id" title="var">loops</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Iterated loops preserves equivalences 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pequiv_fmap_iterated_loops</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">A</span> &lt;~&gt;* <span class="id" title="var">B</span> -&gt; <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span> &lt;~&gt;* <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> <span class="id" title="var">B</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">emap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>).<br/>

<br/>
</div>

<div class="doc">
Loops preserves products. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loops_prod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>) : <span class="id" title="var">loops</span> (<span class="id" title="var">X</span> * <span class="id" title="var">Y</span>) &lt;~&gt;* <span class="id" title="var">loops</span> <span class="id" title="var">X</span> * <span class="id" title="var">loops</span> <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_path_prod</span> (<span class="id" title="var">point</span> (<span class="id" title="var">X</span> * <span class="id" title="var">Y</span>)) (<span class="id" title="var">point</span> (<span class="id" title="var">X</span> * <span class="id" title="var">Y</span>)))^-1%<span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
There is a natural map from <span class="inlinecode"><span class="id" title="var">loops</span></span> <span class="inlinecode">(<span class="id" title="var">X</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">Y</span>)</span> to <span class="inlinecode"><span class="id" title="var">loops</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">loops</span></span> <span class="inlinecode"><span class="id" title="var">Y</span></span>, and ideally it would definitionally underly the equivalence <span class="inlinecode"><span class="id" title="var">loops_prod</span></span>.  That's not the case, but we show that <span class="inlinecode"><span class="id" title="var">loops_prod</span></span> is homotopic to the expected maps after projecting to each factor. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pfst_loops_prod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">pfst</span> <span class="id" title="var">o</span>* <span class="id" title="var">loops_prod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ==* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">pfst</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">psnd_loops_prod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">psnd</span> <span class="id" title="var">o</span>* <span class="id" title="var">loops_prod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ==* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">psnd</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">concat_1p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Iterated loops of products are products of iterated loops. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iterated_loops_prod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>) {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> (<span class="id" title="var">X</span> * <span class="id" title="var">Y</span>) &lt;~&gt;* (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> <span class="id" title="var">X</span>) * (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> <span class="id" title="var">Y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">emap</span> <span class="id" title="var">loops</span> <span class="id" title="var">IHn</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Similarly, we compute the projections here. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pfst_iterated_loops_prod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>) {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">pfst</span> <span class="id" title="var">o</span>* <span class="id" title="var">iterated_loops_prod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ==* <span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>) <span class="id" title="var">pfst</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">_</span> ==* ?<span class="id" title="var">R</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">pfst</span> <span class="id" title="var">o</span>* (<span class="id" title="var">loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">iterated_loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) ==* <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_prewhisker</span> <span class="id" title="var">_</span> (<span class="id" title="var">pfst_loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (?<span class="id" title="var">L</span> ==* <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">L</span> ==* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>) <span class="id" title="var">pfst</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">fmap2</span> <span class="id" title="var">loops</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">psnd_iterated_loops_prod</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>) {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">psnd</span> <span class="id" title="var">o</span>* <span class="id" title="var">iterated_loops_prod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> ==* <span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>) <span class="id" title="var">psnd</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<span class="id" title="var">_</span> ==* ?<span class="id" title="var">R</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">psnd</span> <span class="id" title="var">o</span>* (<span class="id" title="var">loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">iterated_loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) ==* <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_prewhisker</span> <span class="id" title="var">_</span> (<span class="id" title="var">psnd_loops_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (?<span class="id" title="var">L</span> ==* <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">L</span> ==* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">fmap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span>) <span class="id" title="var">psnd</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">fmap2</span> <span class="id" title="var">loops</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;A&nbsp;dependent&nbsp;form&nbsp;of&nbsp;loops&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loopsD</span> {<span class="id" title="var">A</span>} : <span class="id" title="var">pFam</span> <span class="id" title="var">A</span> -&gt; <span class="id" title="var">pFam</span> (<span class="id" title="var">loops</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">Pp</span> =&gt; <span class="id" title="var">Build_pFam</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> : <span class="id" title="var">loops</span> <span class="id" title="var">A</span> =&gt; <span class="id" title="var">transport</span> <span class="id" title="var">Pp</span> <span class="id" title="var">q</span> (<span class="id" title="var">dpoint</span> <span class="id" title="var">Pp</span>) = (<span class="id" title="var">dpoint</span> <span class="id" title="var">Pp</span>)) 1.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">istrunc_pfam_loopsD</span> {<span class="id" title="var">n</span>} {<span class="id" title="var">A</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">pFam</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">H</span> :<span class="id" title="var">IsTrunc_pFam</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">P</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsTrunc_pFam</span> <span class="id" title="var">n</span> (<span class="id" title="var">loopsD</span> <span class="id" title="var">P</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">H</span> (<span class="id" title="var">point</span> <span class="id" title="var">A</span>)). <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;psigma&nbsp;and&nbsp;loops&nbsp;'commute'&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loops_psigma_commute</span> (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">pFam</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loops</span> (<span class="id" title="var">psigma</span> <span class="id" title="var">P</span>) &lt;~&gt;* <span class="id" title="var">psigma</span> (<span class="id" title="var">loopsD</span> <span class="id" title="var">P</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1%<span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;product&nbsp;and&nbsp;loops&nbsp;'commute'&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loops_pproduct_commute</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loops</span> (<span class="id" title="var">pproduct</span> <span class="id" title="var">F</span>) &lt;~&gt;* <span class="id" title="var">pproduct</span> (<span class="id" title="var">loops</span> <span class="id" title="var">o</span> <span class="id" title="var">F</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_apD10</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;product&nbsp;and&nbsp;iterated&nbsp;loops&nbsp;commute&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iterated_loops_pproduct_commute</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">F</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">pType</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> (<span class="id" title="var">pproduct</span> <span class="id" title="var">F</span>) &lt;~&gt;* <span class="id" title="var">pproduct</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> <span class="id" title="var">o</span> <span class="id" title="var">F</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">loops_pproduct_commute</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">emap</span> <span class="id" title="var">loops</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">IHn</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Loops&nbsp;neutralise&nbsp;sigmas&nbsp;when&nbsp;truncated&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">loops_psigma_trunc</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">Aa</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Pp</span> : <span class="id" title="var">pFam</span> <span class="id" title="var">Aa</span>) (<span class="id" title="var">istrunc_Pp</span> : <span class="id" title="var">IsTrunc_pFam</span> (<span class="id" title="var">trunc_index_inc</span> <span class="id" title="var">minus_two</span> <span class="id" title="var">n</span>) <span class="id" title="var">Pp</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> (<span class="id" title="var">psigma</span> <span class="id" title="var">Pp</span>) &lt;~&gt;* <span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> <span class="id" title="var">Aa</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Aa</span>, <span class="id" title="var">Pp</span>, <span class="id" title="var">istrunc_Pp</span> |- *.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">refine</span> (@<span class="id" title="var">equiv_sigma_contr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">istrunc_Pp</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pequiv_inverse</span> (<span class="id" title="var">unfold_iterated_loops'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">unfold_iterated_loops'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">IHn</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">emap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">loops_psigma_commute</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;can&nbsp;convert&nbsp;between&nbsp;loops&nbsp;in&nbsp;a&nbsp;type&nbsp;and&nbsp;loops&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="keyword">Type</span></span>&nbsp;at&nbsp;that&nbsp;type.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loops_type</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>})<br/>
&nbsp;&nbsp;: <span class="id" title="var">loops</span> [<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}, <span class="id" title="var">A</span>] &lt;~&gt;* [<span class="id" title="var">A</span> &lt;~&gt; <span class="id" title="var">A</span>, <span class="id" title="var">equiv_idmap</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">issig_pequiv'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">equiv_equiv_path</span> <span class="id" title="var">A</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;An&nbsp;iterated&nbsp;version.&nbsp;&nbsp;Note&nbsp;that&nbsp;the&nbsp;statement&nbsp;with&nbsp;"-1"&nbsp;substituted&nbsp;for&nbsp;<span class="inlinecode"><span class="id" title="var">n</span></span>&nbsp;is&nbsp;<span class="inlinecode"><span class="id" title="var">loops</span></span> <span class="inlinecode">[<span class="id" title="keyword">Type</span>,</span> <span class="inlinecode"><span class="id" title="var">A</span>]</span> <span class="inlinecode">&lt;~&gt;*</span> <span class="inlinecode">[<span class="id" title="var">A</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">A</span>,</span> <span class="inlinecode"><span class="id" title="var">idmap</span>]</span>,&nbsp;which&nbsp;is&nbsp;not&nbsp;true&nbsp;in&nbsp;general.&nbsp;Compare&nbsp;the&nbsp;previous&nbsp;result.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">local_global_looping</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">iterated_loops@</span>{<span class="id" title="var">j</span>} <span class="id" title="var">n</span>.+2 [<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}, <span class="id" title="var">A</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt;* <span class="id" title="var">pproduct</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="var">iterated_loops@</span>{<span class="id" title="var">j</span>} <span class="id" title="var">n</span>.+1 [<span class="id" title="var">A</span>, <span class="id" title="var">a</span>]).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">emap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">loops_type</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">issig_pequiv'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">equiv_inverse</span> (<span class="id" title="var">equiv_path_arrow</span> 1%<span class="id" title="var">equiv</span> 1%<span class="id" title="var">equiv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> <span class="id" title="var">equiv_inverse</span> (<span class="id" title="var">equiv_path_equiv</span> 1%<span class="id" title="var">equiv</span> 1%<span class="id" title="var">equiv</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">loops_pproduct_commute</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>*<span class="id" title="var">E</span> <span class="id" title="var">emap</span> <span class="id" title="var">loops</span> <span class="id" title="var">IHn</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;7.2.7&nbsp;*)</span><br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">equiv_istrunc_istrunc_loops</span> `{<span class="id" title="var">Funext</span>} <span class="id" title="var">n</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span>.+2 <span class="id" title="var">X</span> &lt;~&gt; <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>), <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span>.+1 (<span class="id" title="var">loops</span> [<span class="id" title="var">X</span>, <span class="id" title="var">x</span>]).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">equiv_iff_hprop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">tr_loops</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_S</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_S</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">tr_loops</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;7.2.9,&nbsp;with&nbsp;<span class="inlinecode"><span class="id" title="var">n</span></span>&nbsp;here&nbsp;meaning&nbsp;the&nbsp;same&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">n</span>-1</span>&nbsp;there.&nbsp;Note&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">n</span>.-1</span>&nbsp;in&nbsp;the&nbsp;statement&nbsp;is&nbsp;short&nbsp;for&nbsp;<span class="inlinecode"><span class="id" title="var">trunc_index_pred</span></span> <span class="inlinecode">(<span class="id" title="var">nat_to_trunc_index</span></span> <span class="inlinecode"><span class="id" title="var">n</span>)</span>&nbsp;which&nbsp;is&nbsp;definitionally&nbsp;equal&nbsp;to&nbsp;<span class="inlinecode">(<span class="id" title="var">trunc_index_inc</span></span> <span class="inlinecode"><span class="id" title="var">minus_two</span></span> <span class="inlinecode"><span class="id" title="var">n</span>).+1</span>.&nbsp;*)</span><br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">equiv_istrunc_contr_iterated_loops</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span>.-1 <span class="id" title="var">A</span> &lt;~&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> : <span class="id" title="var">A</span>, <span class="id" title="var">Contr</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">n</span> [<span class="id" title="var">A</span>, <span class="id" title="var">a</span>]).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">A</span> |- *.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">cbn</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">equiv_hprop_inhabited_contr</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_istrunc_istrunc_loops</span> <span class="id" title="var">n</span>.-2 <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">equiv_functor_forall_id</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="keyword">beta</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">IHn</span> (<span class="id" title="var">loops</span> [<span class="id" title="var">A</span>, <span class="id" title="var">a</span>])).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_inO_equiv</span> (-2) (<span class="id" title="var">unfold_iterated_loops'</span> <span class="id" title="var">n</span> [<span class="id" title="var">A</span>,<span class="id" title="var">a</span>])^-1 <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">equiv_iff_hprop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<span class="id" title="var">contr_equiv'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">emap</span> (<span class="id" title="var">iterated_loops</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_concat_lr</span> <span class="id" title="var">p</span> 1).<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">ispointed_loops</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span> @ <span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">loops_inv</span></span> is a natural transformation. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is1natural_loops_inv</span> : <span class="id" title="var">Is1Natural</span> <span class="id" title="var">loops</span> <span class="id" title="var">loops</span> <span class="id" title="var">loops_inv</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Is1Natural</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">refine</span> (<span class="id" title="var">inv_Vp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">whiskerR</span> <span class="id" title="var">_</span> (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>) @ <span class="id" title="var">concat_pp_p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">inv_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">whiskerL</span> (<span class="id" title="var">point_eq</span> <span class="id" title="var">f</span>)^ (<span class="id" title="var">ap_V</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>)^).<br/>
&nbsp;&nbsp;+ <span class="id" title="var">pointed_reduce</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Loops on the pointed type of dependent pointed maps correspond to pointed dependent maps into a family of loops.  We define this in this direction, because the forward map is pointed by reflexivity. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_loops_ppforall</span> `{<span class="id" title="var">Funext</span>} {<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">B</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loops</span> (<span class="id" title="var">ppforall</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">B</span> <span class="id" title="var">x</span>) &lt;~&gt;* (<span class="id" title="var">ppforall</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">loops</span> (<span class="id" title="var">B</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_path_pforall</span> (<span class="id" title="var">point_pforall</span> <span class="id" title="var">B</span>) (<span class="id" title="var">point_pforall</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>