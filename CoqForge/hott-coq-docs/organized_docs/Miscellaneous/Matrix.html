<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Matrix</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Matrix</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Basics.Overture</span> <span class="id" title="var">Basics.Trunc</span> <span class="id" title="var">Basics.Tactics</span> <span class="id" title="var">Basics.Decidable</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Types.Sigma</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.List.Core</span> <span class="id" title="var">Spaces.List.Theory</span> <span class="id" title="var">Spaces.List.Paths</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Algebra.Rings.Ring</span> <span class="id" title="var">Algebra.Rings.Module</span> <span class="id" title="var">Algebra.Rings.CRing</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Algebra.Rings.KroneckerDelta</span> <span class="id" title="var">Algebra.Rings.Vector</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">abstract_algebra</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">WildCat.Core</span> <span class="id" title="var">WildCat.Paths</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Modalities.ReflectiveSubuniverse</span>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Minimization</span> <span class="id" title="var">ToSet</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">mc_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab262"></a><h1 class="section">Matrices</h1>

<div class="paragraph"> </div>

<a id="lab263"></a><h2 class="section">Definition</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Matrix@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">Vector</span> (<span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>) <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">istrunc_matrix</span> (<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">k</span> `{<span class="id" title="var">IsTrunc</span> <span class="id" title="var">k</span>.+2 <span class="id" title="var">R</span>} <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">IsTrunc</span> <span class="id" title="var">k</span>.+2 (<span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
Building a matrix from a function that takes row and column indices. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Build_Matrix</span> (<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">M_fun</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">j</span> : <span class="id" title="var">nat</span>), (<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span> -&gt; (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span> -&gt; <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">M_fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The length conditions here are decidable so can be inferred in proofs. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Build_Matrix'</span> (<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">l</span> : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">R</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">wf_row</span> : <span class="id" title="var">length</span> <span class="id" title="var">l</span> = <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">wf_col</span> : <span class="id" title="var">for_all</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">row</span> =&gt; <span class="id" title="var">length</span> <span class="id" title="var">row</span> = <span class="id" title="var">n</span>) <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">_</span>; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="var">snrapply</span> <span class="id" title="var">list_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> <span class="id" title="var">wf_col</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">length_list_sigma</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">entries@</span>{<span class="id" title="var">i</span>|} {<span class="id" title="var">R</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">list_map@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} <span class="id" title="var">pr1</span> (<span class="id" title="var">pr1</span> <span class="id" title="var">M</span>).<br/>

<br/>
</div>

<div class="doc">
The entry at row <span class="inlinecode"><span class="id" title="var">i</span></span> and column <span class="inlinecode"><span class="id" title="var">j</span></span> of a matrix <span class="inlinecode"><span class="id" title="var">M</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">entry</span> {<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">H1</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>} {<span class="id" title="var">H2</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Vector.entry</span> (<span class="id" title="var">Vector.entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span>) <span class="id" title="var">j</span>.<br/>

<br/>
</div>

<div class="doc">
Mapping a function on all the entries of a matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_map</span> {<span class="id" title="var">R</span> <span class="id" title="var">S</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">R</span> -&gt; <span class="id" title="var">S</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">S</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> =&gt; <span class="id" title="var">Build_Matrix</span> <span class="id" title="var">S</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">f</span> (<span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_map2</span> {<span class="id" title="var">R</span> <span class="id" title="var">S</span> <span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">R</span> -&gt; <span class="id" title="var">S</span> -&gt; <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">S</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">T</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> =&gt; <span class="id" title="var">Build_Matrix</span> <span class="id" title="var">T</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">f</span> (<span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>) (<span class="id" title="var">entry</span> <span class="id" title="var">N</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>)).<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode">(<span class="id" title="var">i</span>,</span> <span class="inlinecode"><span class="id" title="var">j</span>)</span>-entry of <span class="inlinecode"><span class="id" title="var">Build_Matrix</span></span> <span class="inlinecode"><span class="id" title="var">R</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">M_fun</span></span> is <span class="inlinecode"><span class="id" title="var">M_fun</span></span> <span class="inlinecode"><span class="id" title="var">i</span></span> <span class="inlinecode"><span class="id" title="var">j</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">entry_Build_Matrix</span> {<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M_fun</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>, (<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span> -&gt; (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span> -&gt; <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">H1</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">H2</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">entry</span> (<span class="id" title="var">Build_Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">M_fun</span>) <span class="id" title="var">i</span> <span class="id" title="var">j</span> = <span class="id" title="var">M_fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">entry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Two matrices are equal if all their entries are equal. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_matrix</span> {<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> (<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>), <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> = <span class="id" title="var">entry</span> <span class="id" title="var">N</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">M</span> = <span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">H</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab264"></a><h2 class="section">Addition and module structure</h2>

<div class="paragraph"> </div>

 Here we define the abelian group of (n x m)-matrices over a ring. This follows from the abelian group structure of the underlying vectors. We are also able to derive a left module strucutre when the entries come from a left module. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">abgroup_matrix</span> (<span class="id" title="var">A</span> : <span class="id" title="var">AbGroup</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">AbGroup</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">abgroup_vector</span> (<span class="id" title="var">abgroup_vector</span> <span class="id" title="var">A</span> <span class="id" title="var">n</span>) <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_plus</span> {<span class="id" title="var">A</span> : <span class="id" title="var">AbGroup</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= @<span class="id" title="var">sg_op</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_zero</span> (<span class="id" title="var">A</span> : <span class="id" title="var">AbGroup</span>) <span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= @<span class="id" title="var">mon_unit</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_negate</span> {<span class="id" title="var">A</span> : <span class="id" title="var">AbGroup</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= @<span class="id" title="var">negate</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isleftmodule_isleftmodule_matrix</span> (<span class="id" title="var">A</span> : <span class="id" title="var">AbGroup</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} `{<span class="id" title="var">IsLeftModule</span> <span class="id" title="var">R</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLeftModule</span> <span class="id" title="var">R</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">A</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">isleftmodule_isleftmodule_vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">isleftmodule_isleftmodule_vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
As a special case, we get the left module of matrices over a ring. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isleftmodule_abgroup_matrix</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLeftModule</span> <span class="id" title="var">R</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_lact</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">lact</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab265"></a><h2 class="section">Multiplication</h2>

<div class="paragraph"> </div>

 Matrix multiplication is defined such that the entry at row <span class="inlinecode"><span class="id" title="var">i</span></span> and column <span class="inlinecode"><span class="id" title="var">j</span></span> of the resulting matrix is the sum of the products of the corresponding entries from the <span class="inlinecode"><span class="id" title="var">i</span></span>th row of the first matrix and the <span class="inlinecode"><span class="id" title="var">j</span></span>th column of the second matrix. Matrices correspond to module homomorphisms between free modules of finite rank (think vector spaces), and matrix multiplication represents the composition of these homomorphisms. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_mult</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ab_sum</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span> =&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">k</span> * <span class="id" title="var">entry</span> <span class="id" title="var">N</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix is the matrix with ones on the diagonal and zeros elsewhere. It acts as the multiplicative identity for matrix multiplication. We define it here using the <span class="inlinecode"><span class="id" title="var">kronecker_delta</span></span> function which will make proving properties about it conceptually easier later. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">identity_matrix</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">kronecker_delta</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>

<br/>
</div>

<div class="doc">
This is the most general statement of associativity for matrix multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">associative_matrix_mult</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">HeteroAssociative</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">q</span>) (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> <span class="id" title="var">P</span>; <span class="id" title="var">nrapply</span> <span class="id" title="var">path_matrix</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rng_sum_dist_l</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ab_sum_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;2: <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">rng_sum_dist_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="keyword">associativity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Matrix multiplication distributes over addition of matrices on the left. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">left_distribute_matrix_mult</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">LeftHeteroDistribute</span> (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>) <span class="id" title="var">matrix_plus</span> <span class="id" title="var">matrix_plus</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (?<span class="id" title="var">x</span> = ?<span class="id" title="var">y</span> + ?<span class="id" title="var">z</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> = <span class="id" title="var">sg_op</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ab_sum_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rng_dist_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Matrix multiplication distributes over addition of matrices on the right. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">right_distribute_matrix_mult</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">RightHeteroDistribute</span> (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>) <span class="id" title="var">matrix_plus</span> <span class="id" title="var">matrix_plus</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (?<span class="id" title="var">x</span> = ?<span class="id" title="var">y</span> + ?<span class="id" title="var">z</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> = <span class="id" title="var">sg_op</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ab_sum_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rng_dist_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix acts as a left identity for matrix multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">left_identity_matrix_mult</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span>: <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">LeftIdentity</span> (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">rng_sum_kronecker_delta_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix acts as a right identity for matrix multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">right_identity_matrix_mult</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">RightIdentity</span> (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">rng_sum_kronecker_delta_r'</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
TODO: define this as an R-algebra. What is an R-algebra over a non-commutative right however? (Here we have a bimodule which might be important)  Matrices over a ring form a (generally) non-commutative ring. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_ring</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">Ring</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Ring</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">matrix_mult</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">associative_matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">left_distribute_matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">right_distribute_matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">left_identity_matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">right_identity_matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Matrix multiplication on the right preserves scalar multiplication in the sense that <span class="inlinecode"><span class="id" title="var">matrix_lact</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> <span class="inlinecode">(<span class="id" title="var">matrix_mult</span></span> <span class="inlinecode"><span class="id" title="var">M</span></span> <span class="inlinecode"><span class="id" title="var">N</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">matrix_mult</span></span> <span class="inlinecode">(<span class="id" title="var">matrix_lact</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">M</span>)</span> <span class="inlinecode"><span class="id" title="var">N</span></span> for <span class="inlinecode"><span class="id" title="var">r</span></span> a ring element and <span class="inlinecode"><span class="id" title="var">M</span></span> and <span class="inlinecode"><span class="id" title="var">N</span></span> matrices of compatible sizes. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_mult_lact_l</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">HeteroAssociative</span> (@<span class="id" title="var">matrix_lact</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>) (@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">matrix_mult</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>) (@<span class="id" title="var">matrix_lact</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">rng_sum_dist_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">rng_mult_assoc</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The same doesn't hold for the right matrix, since the ring is not commutative. However we could say an analagous statement for the right action. We haven't yet stated a definition of right module yet though. 
<div class="paragraph"> </div>

 In a commutative ring, matrix multiplication over the ring and the opposite ring agree. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_mult_rng_op</span> {<span class="id" title="var">R</span> : <span class="id" title="var">CRing</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_mult</span> (<span class="id" title="var">R</span>:=<span class="id" title="var">rng_op</span> <span class="id" title="var">R</span>) <span class="id" title="var">M</span> <span class="id" title="var">N</span> = <span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_ab_sum</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rng_mult_comm</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab266"></a><h2 class="section">Transpose</h2>

<div class="paragraph"> </div>

 The transpose of a matrix is the matrix with the rows and columns swapped. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> -&gt; <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> =&gt; <span class="id" title="var">Build_Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span> =&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>).<br/>

<br/>
</div>

<div class="doc">
Tranposing a matrix is involutive. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>) = <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Transpose distributes over addition. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_plus</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>) (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Transpose commutes with scalar multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_lact</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The negation of a transposed matrix is the same as the transposed matrix of the negation. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_negate</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>) = <span class="id" title="var">matrix_negate</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Transpose distributes over multiplication when you reverse the ring multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_mult</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_mult</span> (<span class="id" title="var">R</span>:=<span class="id" title="var">rng_op</span> <span class="id" title="var">R</span>) (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">N</span>) (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
When the ring is commutative, there is no need to reverse the multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_mult_comm</span> {<span class="id" title="var">R</span> : <span class="id" title="var">CRing</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_mult</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">N</span>) (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">matrix_transpose_mult</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">matrix_mult_rng_op</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of the zero matrix is the zero matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) = <span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of the identity matrix is the identity matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_identity@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>) = <span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">kronecker_delta_symm</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab267"></a><h2 class="section">Diagonal matrices</h2>

<div class="paragraph"> </div>

 A diagonal matrix is a matrix with zeros everywhere except on the diagonal. Its entries are given by a vector. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_diag</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">kronecker_delta</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> * <span class="id" title="var">Vector.entry</span> <span class="id" title="var">v</span> <span class="id" title="var">i</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Addition of diagonal matrices is the same as addition of the corresponding vectors. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_diag_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> <span class="id" title="var">w</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_plus</span> (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">v</span>) (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">w</span>) = <span class="id" title="var">matrix_diag</span> (<span class="id" title="var">vector_plus</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>, 5 <span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">rng_dist_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Matrix multiplication of diagonal matrices is the same as multiplying the corresponding vectors pointwise. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_diag_mult</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> <span class="id" title="var">w</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_mult</span> (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">v</span>) (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_diag</span> (<span class="id" title="var">vector_map2</span> (.*.) <span class="id" title="var">v</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">snrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">rng_mult_assoc</span> (<span class="id" title="var">kronecker_delta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">kronecker_delta_comm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- 2 <span class="id" title="var">rng_mult_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">rng_sum_kronecker_delta_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hi</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of a diagonal matrix is the same diagonal matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_transpose_diag</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">v</span>) = <span class="id" title="var">matrix_diag</span> <span class="id" title="var">v</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">kronecker_delta_symm</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">kronecker_delta</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">i</span> = <span class="id" title="var">j</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span>|<span class="id" title="var">np</span>].<br/>
&nbsp;&nbsp;1: <span class="id" title="var">f_ap</span>; <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">path_entry_vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">rng_mult_zero_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The diagonal matrix construction is injective. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isinj_matrix_diag</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsInjective</span> (@<span class="id" title="var">matrix_diag</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v1</span> <span class="id" title="var">v2</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> =&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">kronecker_delta_refl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">rng_mult_one_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A matrix is diagonal if it is equal to a diagonal matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsDiagonal@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} := {<br/>
&nbsp;&nbsp;<span class="id" title="var">isdiagonal_diag_vector</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">isdiagonal_diag</span> : <span class="id" title="var">M</span> = <span class="id" title="var">matrix_diag</span> <span class="id" title="var">isdiagonal_diag_vector</span>;<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">isdiagonal_diag_vector</span> {<span class="id" title="var">R</span> <span class="id" title="var">n</span>} <span class="id" title="var">M</span> {<span class="id" title="var">_</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">isdiagonal_diag</span> {<span class="id" title="var">R</span> <span class="id" title="var">n</span>} <span class="id" title="var">M</span> {<span class="id" title="var">_</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issig_IsDiagonal</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} {<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">_</span> &lt;~&gt; <span class="id" title="var">IsDiagonal</span> <span class="id" title="var">M</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">issig</span>).<br/>

<br/>
</div>

<div class="doc">
A matrix is diagonal in a unique way. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_isdiagonal</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsHProp</span> (<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">hprop_allpath</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> ((<span class="id" title="var">equiv_ap'</span> <span class="id" title="var">issig_IsDiagonal</span>^-1%<span class="id" title="var">equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> )^-1%<span class="id" title="var">equiv</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">path_sigma_hprop</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isinj_matrix_diag</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> ((<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">M</span>)^ @ <span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The zero matrix is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_matrix_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">vector_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>, <span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_zero_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_identity_matrix</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">Build_Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; 1)).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">entry_Build_Matrix</span>, <span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_one_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two diagonal matrices is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_matrix_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">M</span>} `{<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">vector_plus</span> (<span class="id" title="var">isdiagonal_diag_vector</span> <span class="id" title="var">M</span>) (<span class="id" title="var">isdiagonal_diag_vector</span> <span class="id" title="var">N</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">M</span>), (<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">N</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">matrix_diag_plus</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The negative of a diagonal matrix is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_matrix_negate</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> (<span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">vector_neg</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">isdiagonal_diag_vector</span> <span class="id" title="var">M</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_negate_r</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The product of two diagonal matrices is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_matrix_mult</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">M</span>} `{<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">vector_map2</span> (.*.) (<span class="id" title="var">isdiagonal_diag_vector</span> <span class="id" title="var">M</span>) (<span class="id" title="var">isdiagonal_diag_vector</span> <span class="id" title="var">N</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">M</span>), (<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">N</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">matrix_diag_mult</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of a diagonal matrix is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_matrix_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{<span class="id" title="var">IsDiagonal</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">isdiagonal_diag_vector</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">isdiagonal_diag</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">matrix_transpose_diag</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Given a square matrix, we can extract the diagonal as a vector. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_diag_vector</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>).<br/>

<br/>
</div>

<div class="doc">
Diagonal matrices form a subring of the ring of square matrices. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_diag_ring@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Subring@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} (<span class="id" title="var">matrix_ring</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">Build_Subring'</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> : <span class="id" title="var">matrix_ring</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">IsDiagonal</span> <span class="id" title="var">M</span>) <span class="id" title="var">_</span>); <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">dx</span> <span class="id" title="var">dy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">isdiagonal_matrix_plus</span>; <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">isdiagonal_matrix_negate</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">nrapply</span> <span class="id" title="var">isdiagonal_matrix_mult</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">nrapply</span> <span class="id" title="var">isdiagonal_identity_matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab268"></a><h2 class="section">Trace</h2>

<div class="paragraph"> </div>

 The trace of a square matrix is the sum of the diagonal entries. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_trace</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) : <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">ab_sum</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span> =&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span>).<br/>

<br/>
</div>

<div class="doc">
The trace of a matrix preserves addition. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_trace_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_trace</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) = (<span class="id" title="var">matrix_trace</span> <span class="id" title="var">M</span>) + (<span class="id" title="var">matrix_trace</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">matrix_trace</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ab_sum_plus</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The trace of a matrix preserves scalar multiplication. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_trace_lact</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_trace</span> (<span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span>) = <span class="id" title="var">r</span> * <span class="id" title="var">matrix_trace</span> <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">matrix_trace</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_sum_dist_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The trace of a matrix multiplication is the same as the trace of the reverse multiplication. This holds only in a commutative ring. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_trace_mult</span> {<span class="id" title="var">R</span> : <span class="id" title="var">CRing</span>} {<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) (<span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_trace</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>) = <span class="id" title="var">matrix_trace</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">N</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">rng_mult_comm</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">ab_sum_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The trace of the transpose of a matrix is the same as the trace of the matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">trace_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} {<span class="id" title="var">n</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_trace</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>) = <span class="id" title="var">matrix_trace</span> <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_ab_sum</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab269"></a><h2 class="section">Matrix minors</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">skip</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">dec</span> (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span> <span class="id" title="keyword">then</span> <span class="id" title="var">i</span> <span class="id" title="keyword">else</span> <span class="id" title="var">i</span>.+1%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isinjective_skip</span> <span class="id" title="var">n</span> : <span class="id" title="var">IsInjective</span> (<span class="id" title="var">skip</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">skip</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">x</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>], (<span class="id" title="var">dec</span> (<span class="id" title="var">y</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H'</span>|<span class="id" title="var">H'</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>^.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H'</span> (<span class="id" title="var">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contradiction</span> (<span class="id" title="var">H</span> (<span class="id" title="var">leq_trans</span> <span class="id" title="var">_</span> <span class="id" title="var">H'</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">path_nat_succ</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">lt_n1_skip</span> <span class="id" title="var">k</span> <span class="id" title="var">i</span> <span class="id" title="var">n</span> (<span class="id" title="var">H</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">H'</span> : (<span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">skip</span> <span class="id" title="var">i</span> <span class="id" title="var">k</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">skip</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">k</span> &lt; <span class="id" title="var">i</span>))%<span class="id" title="var">nat</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H''</span>|<span class="id" title="var">H''</span>]; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_minor</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>} {<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">n</span>.+1)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> (<span class="id" title="var">skip</span> <span class="id" title="var">i</span> <span class="id" title="var">k</span>) (<span class="id" title="var">skip</span> <span class="id" title="var">j</span> <span class="id" title="var">l</span>)).<br/>

<br/>
</div>

<div class="doc">
A minor of the zero matrix is again the zero matrix. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_minor_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">n</span>.+1) = <span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span> <span class="id" title="var">Hk</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_minor_identity</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">i</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">i</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.+1) = <span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">Hj</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 3 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">kronecker_delta_map_inj</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_minor_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">n</span>.+1)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_plus</span> (<span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">M</span>) (<span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span> <span class="id" title="var">Hk</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_minor_scale</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">n</span>.+1)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> (<span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span>) = <span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> (<span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span> <span class="id" title="var">Hk</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">entry_Build_Matrix</span>, !<span class="id" title="var">entry_Build_Vector</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">matrix_minor_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">i</span> <span class="id" title="var">j</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>.+1)%<span class="id" title="var">nat</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">n</span>.+1)<br/>
&nbsp;&nbsp;: <span class="id" title="var">matrix_minor</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">matrix_transpose</span> (<span class="id" title="var">matrix_minor</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span> <span class="id" title="var">Hk</span> <span class="id" title="var">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> 4 <span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab270"></a><h2 class="section">Triangular matrices</h2>

<div class="paragraph"> </div>

 A matrix is upper triangular if all the entries below the diagonal are zero. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsUpperTriangular@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix@</span>{<span class="id" title="var">i</span>} <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">upper_triangular</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">merely@</span>{<span class="id" title="var">i</span>} (<span class="id" title="keyword">forall</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> (<span class="id" title="var">Hi</span> : (<span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>) (<span class="id" title="var">Hj</span> : (<span class="id" title="var">j</span> &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>), (<span class="id" title="var">i</span> &lt; <span class="id" title="var">j</span>)%<span class="id" title="var">nat</span> -&gt; <span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> = 0).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_isuppertriangular@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsHProp</span> (<span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_truncation@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A matrix is lower triangular if all the entries above the diagonal are zero. We define it as the transpose being upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsLowerTriangular</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix@</span>{<span class="id" title="var">i</span>} <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">upper_triangular_transpose</span> :: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_islowertriangular@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsHProp</span> (<span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_truncation@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of a matrix is lower triangular if and only if the matrix is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_transpose</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two upper triangular matrices is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">upper_triangular_plus@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">H1</span> : <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>} {<span class="id" title="var">H2</span> : <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsUpperTriangular</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;use&nbsp;<span class="inlinecode"><span class="id" title="var">strip_reflections</span></span>&nbsp;rather&nbsp;than&nbsp;<span class="inlinecode"><span class="id" title="var">strip_truncations</span></span>&nbsp;here&nbsp;and&nbsp;below&nbsp;because&nbsp;it&nbsp;generates&nbsp;fewer&nbsp;universe&nbsp;variables&nbsp;in&nbsp;some&nbsp;versions&nbsp;of&nbsp;Coq.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">strip_reflections</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H1</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H2</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">Vector.entry</span> (<span class="id" title="var">Vector.entry</span> ?<span class="id" title="var">M</span> ?<span class="id" title="var">i</span>) ?<span class="id" title="var">j</span>) <span class="id" title="keyword">with</span> (<span class="id" title="var">entry</span> <span class="id" title="var">M</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>, <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_plus_zero_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two lower triangular matrices is lower triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">M</span>} `{!<span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">upper_triangular_plus</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The negation of an upper triangular matrix is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">upper_triangular_negate@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">H</span> : <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsUpperTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">strip_reflections</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">rng_negate_zero</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The negation of a lower triangular matrix is lower triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_negate</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_negate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The product of two upper triangular matrices is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">upper_triangular_mult@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) {<span class="id" title="var">H1</span> : <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>} {<span class="id" title="var">H2</span> : <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsUpperTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">strip_reflections</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ab_sum_zero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">Hk</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">k</span> &lt;= <span class="id" title="var">i</span>)%<span class="id" title="var">nat</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">leq_k_i</span>|<span class="id" title="var">gt_k_i</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_zero_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">lt_leq_lt_trans</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">gt_iff_not_leq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">gt_k_i</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_zero_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The product of two lower triangular matrices is lower triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_mult</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) {<span class="id" title="var">H1</span> : <span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">M</span>} {<span class="id" title="var">H2</span> : <span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_mult</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">upper_triangular_mult</span> (<span class="id" title="var">R</span>:=<span class="id" title="var">rng_op</span> <span class="id" title="var">R</span>)); <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The zero matrix is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">upper_triangular_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The zero matrix is lower triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_zero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">upper_triangular_identity@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsUpperTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr@</span>{<span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix@</span>{<span class="id" title="var">i</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">kronecker_delta_lt</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix is lower triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_identity@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_identity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A diagonal matrix is upper triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">upper_triangular_diag</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsUpperTriangular</span> (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">v</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsUpperTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span> <span class="id" title="var">lt_i_j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">kronecker_delta_lt</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_zero_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A diagonal matrix is lower triangular. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">lower_triangular_diag</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">Vector</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsLowerTriangular</span> (<span class="id" title="var">matrix_diag</span> <span class="id" title="var">v</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsLowerTriangular</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_diag</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">upper_triangular_diag</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Upper triangular matrices are a subring of the ring of matrices. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">upper_triangular_matrix_ring@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Subring@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} (<span class="id" title="var">matrix_ring@</span>{<span class="id" title="var">i</span>} <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">Build_Subring'</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> : <span class="id" title="var">matrix_ring</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;These&nbsp;can&nbsp;all&nbsp;be&nbsp;found&nbsp;by&nbsp;typeclass&nbsp;search,&nbsp;but&nbsp;being&nbsp;explicit&nbsp;makes&nbsp;this&nbsp;faster.&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ? ?; <span class="id" title="tactic">exact</span> (<span class="id" title="var">upper_triangular_plus</span> <span class="id" title="var">x</span> (-<span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">upper_triangular_mult</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">upper_triangular_identity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Lower triangular matrices are a subring of the ring of matrices. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lower_triangular_matrix_ring@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Subring@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} (<span class="id" title="var">matrix_ring</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">Build_Subring'@</span>{<span class="id" title="var">i</span> <span class="id" title="var">i</span>} (<span class="id" title="keyword">fun</span> <span class="id" title="var">M</span> : <span class="id" title="var">matrix_ring</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">M</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;These&nbsp;can&nbsp;all&nbsp;be&nbsp;found&nbsp;by&nbsp;typeclass&nbsp;search,&nbsp;but&nbsp;being&nbsp;explicit&nbsp;makes&nbsp;this&nbsp;faster.&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ? ?; <span class="id" title="tactic">exact</span> (<span class="id" title="var">lower_triangular_plus</span> <span class="id" title="var">x</span> (-<span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">lower_triangular_mult</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">lower_triangular_identity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab271"></a><h2 class="section">Symmetric Matrices</h2>

<div class="paragraph"> </div>

 A matrix is symmetric when it is equal to its transpose. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsSymmetric</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix@</span>{<span class="id" title="var">i</span>} <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">matrix_transpose_issymmetric</span> : <span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span> = <span class="id" title="var">M</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">matrix_transpose_issymmetric</span> {<span class="id" title="var">R</span> <span class="id" title="var">n</span>} <span class="id" title="var">M</span> {<span class="id" title="var">_</span>}.<br/>

<br/>
</div>

<div class="doc">
The zero matrix is symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issymmetric_matrix_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSymmetric</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">matrix_transpose_zero</span>.<br/>

<br/>
</div>

<div class="doc">
The identity matrix is symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issymmetric_matrix_identity</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSymmetric</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">matrix_transpose_identity</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two symmetric matrices is symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issymmetric_matrix_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">M</span>} `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSymmetric</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The negation of a symmetric matrix is symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issymmetric_matrix_negate</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSymmetric</span> (<span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_negate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A scalar multiple of a symmetric matrix is symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issymmetric_matrix_scale</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSymmetric</span> (<span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_lact</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of a symmetric matrix is symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issymmetric_matrix_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSymmetric</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_transpose</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">symmetry</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A symmetric upper triangular matrix is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_upper_triangular_issymmetric</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">M</span>} {<span class="id" title="var">H</span> : <span class="id" title="var">IsUpperTriangular</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">matrix_diag_vector</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">path_matrix</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hj</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>, <span class="id" title="var">entry_Build_Vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">strip_truncations</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">i</span> = <span class="id" title="var">j</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span>|<span class="id" title="var">np</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">kronecker_delta_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_one_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_ishprop</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">neq_iff_lt_or_gt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">np</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">np</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">l</span> | <span class="id" title="var">l</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">kronecker_delta_lt</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_zero_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">kronecker_delta_gt</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rng_mult_zero_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">matrix_transpose_issymmetric</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">entry_Build_Matrix</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A symmetric lower triangular matrix is diagonal. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isdiagonal_lower_triangular_issymmetric</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSymmetric</span> <span class="id" title="var">M</span>} `{!<span class="id" title="var">IsLowerTriangular</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsDiagonal</span> <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">matrix_transpose_issymmetric</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">isdiagonal_upper_triangular_issymmetric</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Note that symmetric matrices do not form a subring (or subalgebra) but they do form a submodule of the module of matrices. 
<div class="paragraph"> </div>

<a id="lab272"></a><h2 class="section">Skew-symmetric Matrices</h2>

<div class="paragraph"> </div>

 A matrix is skew-symmetric when it is equal to the negation of its transpose. 
</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsSkewSymmetric</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix@</span>{<span class="id" title="var">i</span>} <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}<br/>
&nbsp;&nbsp;:= <span class="id" title="var">matrix_transpose_isskewsymmetric</span> : <span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span> = <span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">matrix_transpose_isskewsymmetric</span> {<span class="id" title="var">R</span> <span class="id" title="var">n</span>} <span class="id" title="var">M</span> {<span class="id" title="var">_</span>}.<br/>

<br/>
</div>

<div class="doc">
The zero matrix is skew-symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isskewsymmetric_matrix_zero</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSkewSymmetric</span> (<span class="id" title="var">matrix_zero</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSkewSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_zero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">rng_negate_zero</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">matrix_ring</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The negation of a skew-symmetric matrix is skew-symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isskewsymmetric_matrix_negate</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSkewSymmetric</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSkewSymmetric</span> (<span class="id" title="var">matrix_negate</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSkewSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_negate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A scalar multiple of a skew-symmetric matrix is skew-symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isskewsymmetric_matrix_scale</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">r</span> : <span class="id" title="var">R</span>) (<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSkewSymmetric</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSkewSymmetric</span> (<span class="id" title="var">matrix_lact</span> <span class="id" title="var">r</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSkewSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_lact</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">lm_neg</span> (<span class="id" title="var">M</span>:=<span class="id" title="var">Build_LeftModule</span> <span class="id" title="var">_</span> (<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) <span class="id" title="var">_</span>) <span class="id" title="var">r</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The transpose of a skew-symmetric matrix is skew-symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isskewsymmetric_matrix_transpose</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSkewSymmetric</span> <span class="id" title="var">M</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSkewSymmetric</span> (<span class="id" title="var">matrix_transpose</span> <span class="id" title="var">M</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSkewSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">matrix_transpose_negate</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two skew-symmetric matrices is skew-symmetric. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isskewsymmetric_matrix_plus</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring@</span>{<span class="id" title="var">i</span>}} {<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">M</span> <span class="id" title="var">N</span> : <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>) `{!<span class="id" title="var">IsSkewSymmetric</span> <span class="id" title="var">M</span>} `{!<span class="id" title="var">IsSkewSymmetric</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsSkewSymmetric</span> (<span class="id" title="var">matrix_plus</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsSkewSymmetric</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">matrix_transpose_plus</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">grp_inv_op</span> (<span class="id" title="var">G</span>:=<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">AbelianGroup.ab_comm</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">abgroup_matrix</span> <span class="id" title="var">R</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Skew-symmetric matrices degenerate to symmetric matrices in rings with characteristic 2. In odd characteristic the module of matrices can be decomposed into the direct sum of symmetric and skew-symmetric matrices. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">MatrixCat</span>.<br/>

<br/>
</div>

<div class="doc">
The wild category <span class="inlinecode"><span class="id" title="var">MatrixCat</span></span> <span class="inlinecode"><span class="id" title="var">R</span></span> of <span class="inlinecode"><span class="id" title="var">R</span></span>-valued matrices. This category has natural numbers as objects and m x n matrices as the arrows between <span class="inlinecode"><span class="id" title="var">m</span></span> and <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MatrixCat</span> (<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>) := <span class="id" title="var">nat</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isgraph_matrixcat</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} : <span class="id" title="var">IsGraph</span> (<span class="id" title="var">MatrixCat</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= {| <span class="id" title="var">Hom</span> := <span class="id" title="var">Matrix</span> <span class="id" title="var">R</span> |}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is01cat_matrixcat</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} : <span class="id" title="var">Is01Cat</span> (<span class="id" title="var">MatrixCat</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Is01Cat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">identity_matrix</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">matrix_mult</span> <span class="id" title="var">N</span> <span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is2graph_matrixcat</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} : <span class="id" title="var">Is2Graph</span> (<span class="id" title="var">MatrixCat</span> <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">is2graph_paths</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
MatrixCat R forms a strong 1-category. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is1catstrong_matrixcat</span> {<span class="id" title="var">R</span> : <span class="id" title="var">Ring</span>} : <span class="id" title="var">Is1Cat_Strong</span> (<span class="id" title="var">MatrixCat</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Is1Cat_Strong</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Most&nbsp;of&nbsp;the&nbsp;structure&nbsp;comes&nbsp;from&nbsp;typeclasses&nbsp;in&nbsp;WildCat.Paths.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;1-4: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">associative_matrix_mult</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">M</span> <span class="id" title="var">N</span> <span class="id" title="var">P</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">inverse</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">associative_matrix_mult</span> <span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">right_identity_matrix_mult</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">left_identity_matrix_mult</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
TODO: Define HasEquivs for MatrixCat.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">MatrixCat</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>