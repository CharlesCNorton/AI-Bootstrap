<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>GCHtoAC</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library GCHtoAC</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">HoTT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">TruncType</span> <span class="id" title="var">ExcludedMiddle</span> <span class="id" title="var">abstract_algebra</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HoTT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Universes.Smallness</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HoTT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.Nat.Core</span> <span class="id" title="var">Spaces.Card</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HoTT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Equiv.BiInv</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HoTT</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HIT.unique_choice</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">HoTT.Sets</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Ordinals</span> <span class="id" title="var">Hartogs</span> <span class="id" title="var">Powers</span> <span class="id" title="var">GCH</span> <span class="id" title="var">AC</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="keyword">type</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">trunc_scope</span>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;proof&nbsp;of&nbsp;Sierpinski's&nbsp;results&nbsp;that&nbsp;GCH&nbsp;implies&nbsp;AC&nbsp;given&nbsp;in&nbsp;this&nbsp;file&nbsp;consists&nbsp;of&nbsp;two&nbsp;ingredients:<br/>
&nbsp;&nbsp;&nbsp;1.&nbsp;Adding&nbsp;powers&nbsp;of&nbsp;infinite&nbsp;sets&nbsp;does&nbsp;not&nbsp;increase&nbsp;the&nbsp;cardinality&nbsp;(path_infinite_power).<br/>
&nbsp;&nbsp;&nbsp;2.&nbsp;A&nbsp;variant&nbsp;of&nbsp;Cantor's&nbsp;theorem&nbsp;saying&nbsp;that&nbsp;P(X)&nbsp;&lt;=&nbsp;(X&nbsp;+&nbsp;Y)&nbsp;implies&nbsp;P(X)&nbsp;&lt;=&nbsp;Y&nbsp;for&nbsp;large&nbsp;X&nbsp;(Cantor_injects_injects).<br/>
&nbsp;&nbsp;&nbsp;Those&nbsp;are&nbsp;used&nbsp;to&nbsp;obtain&nbsp;that&nbsp;cardinality-controlled&nbsp;functions&nbsp;are&nbsp;well-behaved&nbsp;in&nbsp;the&nbsp;presence&nbsp;of&nbsp;GCH&nbsp;(Sierpinski),&nbsp;from&nbsp;which&nbsp;we&nbsp;obtain&nbsp;by&nbsp;instantiation&nbsp;with&nbsp;the&nbsp;Hartogs&nbsp;number&nbsp;that&nbsp;every&nbsp;set&nbsp;embeds&nbsp;into&nbsp;an&nbsp;ordinal,&nbsp;which&nbsp;is&nbsp;enough&nbsp;to&nbsp;conclude&nbsp;GCH&nbsp;-&gt;&nbsp;AC&nbsp;(GCH_AC)&nbsp;since&nbsp;the&nbsp;well-ordering&nbsp;theorem&nbsp;implies&nbsp;AC&nbsp;(WO_AC).&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab1317"></a><h1 class="section">Constructive equivalences</h1>

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;For&nbsp;the&nbsp;first&nbsp;ingredient,&nbsp;we&nbsp;establish&nbsp;a&nbsp;bunch&nbsp;of&nbsp;paths&nbsp;and&nbsp;conclude&nbsp;the&nbsp;desired&nbsp;result&nbsp;by&nbsp;equational&nbsp;reasoning.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Preparation</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">UA</span> : <span class="id" title="var">Univalence</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_sum_prod</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> :<br/>
&nbsp;&nbsp;(<span class="id" title="var">X</span> -&gt; <span class="id" title="var">Z</span>) * (<span class="id" title="var">Y</span> -&gt; <span class="id" title="var">Z</span>) = ((<span class="id" title="var">X</span> + <span class="id" title="var">Y</span>) -&gt; <span class="id" title="var">Z</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_sum_distributive</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_sum_assoc</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">X</span> + (<span class="id" title="var">Y</span> + <span class="id" title="var">Z</span>) = <span class="id" title="var">X</span> + <span class="id" title="var">Y</span> + <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_sum_assoc</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_sum_bool</span> <span class="id" title="var">X</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">X</span> + <span class="id" title="var">X</span> = <span class="id" title="var">Bool</span> * <span class="id" title="var">X</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="var">srapply</span> <span class="id" title="var">equiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">inl</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">true</span>, <span class="id" title="var">x</span>) | <span class="id" title="var">inr</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">false</span>, <span class="id" title="var">x</span>) <span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">true</span>, <span class="id" title="var">x</span>) =&gt; <span class="id" title="var">inl</span> <span class="id" title="var">x</span> | (<span class="id" title="var">false</span>, <span class="id" title="var">x</span>) =&gt; <span class="id" title="var">inr</span> <span class="id" title="var">x</span> <span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[]]; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_unit_nat</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">Unit</span> + <span class="id" title="var">nat</span> = <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="var">srapply</span> <span class="id" title="var">equiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">inl</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">O</span> | <span class="id" title="var">inr</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">S</span> <span class="id" title="var">n</span> <span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> <span class="id" title="var">O</span> =&gt; <span class="id" title="var">inl</span> <span class="id" title="var">tt</span> | <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">inr</span> <span class="id" title="var">n</span> <span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [[]|<span class="id" title="var">n</span>].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_unit_fun</span> <span class="id" title="var">X</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">X</span> = (<span class="id" title="var">Unit</span> -&gt; <span class="id" title="var">X</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_unit_rec</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1318"></a><h1 class="section">Equivalences relying on LEM</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">EM</span> : <span class="id" title="var">ExcludedMiddle</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_bool_prop</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">HProp</span> = <span class="id" title="var">Bool</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="var">srapply</span> <span class="id" title="var">equiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">P</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">LEM</span> <span class="id" title="var">P</span> <span class="id" title="var">_</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> : <span class="id" title="var">Bool</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">merely</span> <span class="id" title="var">Unit</span> <span class="id" title="keyword">else</span> <span class="id" title="var">merely</span> <span class="id" title="var">Empty</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">destruct</span> <span class="id" title="var">LEM</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">H</span> (<span class="id" title="var">tr</span> <span class="id" title="var">tt</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (@<span class="id" title="var">merely_destruct</span> <span class="id" title="var">Empty</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">LEM</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>]; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_iff_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">tt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">HE</span>. <span class="id" title="tactic">apply</span> (@<span class="id" title="var">merely_destruct</span> <span class="id" title="var">Empty</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">done</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_bool_subsingleton</span> :<br/>
&nbsp;&nbsp;(<span class="id" title="var">Unit</span> -&gt; <span class="id" title="var">HProp</span>) = <span class="id" title="var">Bool</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">path_unit_fun</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_bool_prop</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_pred_sum</span> <span class="id" title="var">X</span> (<span class="id" title="var">p</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">X</span> = <span class="id" title="var">sig</span> <span class="id" title="var">p</span> + <span class="id" title="var">sig</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; ~ <span class="id" title="var">p</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="var">srapply</span> <span class="id" title="var">equiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">LEM</span> (<span class="id" title="var">p</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>]; [<span class="id" title="tactic">left</span> | <span class="id" title="tactic">right</span>]; <span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[<span class="id" title="var">x</span> <span class="id" title="var">_</span>]|[<span class="id" title="var">x</span> <span class="id" title="var">_</span>]]; <span class="id" title="tactic">exact</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> [[<span class="id" title="var">x</span> <span class="id" title="var">Hx</span>]|[<span class="id" title="var">x</span> <span class="id" title="var">Hx</span>]]; <span class="id" title="tactic">destruct</span> <span class="id" title="var">LEM</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>]; <span class="id" title="tactic">try</span> <span class="id" title="var">contradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">enough</span> (<span class="id" title="var">H</span> = <span class="id" title="var">Hx</span>) <span class="id" title="keyword">as</span> -&gt; <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_ishprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">enough</span> (<span class="id" title="var">H</span> = <span class="id" title="var">Hx</span>) <span class="id" title="keyword">as</span> -&gt; <span class="id" title="tactic">by</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_forall</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">LEM</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ran</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">hexists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_ran</span> {<span class="id" title="var">X</span>} {<span class="id" title="var">Y</span> : <span class="id" title="var">HSet</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">IsInjective</span> <span class="id" title="var">f</span> -&gt; <span class="id" title="var">sig</span> (<span class="id" title="var">ran</span> <span class="id" title="var">f</span>) = <span class="id" title="var">X</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hf</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>. <span class="id" title="var">srapply</span> <span class="id" title="var">equiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">y</span> <span class="id" title="var">H</span>]. <span class="id" title="tactic">destruct</span> (<span class="id" title="keyword">iota</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> <span class="id" title="var">Hx</span>]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hy</span> <span class="id" title="var">Hy'</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hy'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hy</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="keyword">iota</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> <span class="id" title="var">H</span>]. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hf</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">y</span> <span class="id" title="var">x</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sigma_hprop</span>. <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="keyword">iota</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> <span class="id" title="var">Hx</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1319"></a><h1 class="section">Equivalences on infinite sets</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_infinite_unit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">HSet</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">infinite</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Unit</span> + <span class="id" title="var">X</span> = <span class="id" title="var">X</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> <span class="id" title="var">Hf</span>]. <span class="id" title="tactic">rewrite</span> (@<span class="id" title="var">path_pred_sum</span> <span class="id" title="var">X</span> (<span class="id" title="var">ran</span> <span class="id" title="var">f</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">path_ran</span> <span class="id" title="var">_</span> <span class="id" title="var">Hf</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">path_sum_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">path_unit_nat</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <span class="id" title="var">path_infinite_power</span> (<span class="id" title="var">X</span> : <span class="id" title="var">HSet</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">infinite</span> <span class="id" title="var">X</span> -&gt; (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) + (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) = (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">path_sum_bool</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">path_bool_subsingleton</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">path_sum_prod</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">path_infinite_unit</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1320"></a><h1 class="section">Variants of Cantors's theorem</h1>

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;For&nbsp;the&nbsp;second&nbsp;ingredient,&nbsp;we&nbsp;give&nbsp;a&nbsp;preliminary&nbsp;version&nbsp;(Cantor_path_inject)&nbsp;to&nbsp;see&nbsp;the&nbsp;idea,&nbsp;as&nbsp;well&nbsp;as&nbsp;a&nbsp;stronger&nbsp;refinement&nbsp;(Cantor_injects_injects)&nbsp;which&nbsp;is&nbsp;then&nbsp;a&nbsp;mere&nbsp;reformulation.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">PR</span> : <span class="id" title="var">PropResizing</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cantor</span> <span class="id" title="var">X</span> (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>) :<br/>
&nbsp;&nbsp;{ <span class="id" title="var">p</span> | <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> &lt;&gt; <span class="id" title="var">p</span> }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; ~ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">Hx</span> : <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> &lt;-&gt; ~ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">pattern</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">hCantor</span> {<span class="id" title="var">X</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) :<br/>
&nbsp;&nbsp;{ <span class="id" title="var">p</span> | <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> &lt;&gt; <span class="id" title="var">p</span> }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Build_HProp</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">Empty</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">Hx</span> : <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> &lt;-&gt; ~ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">pattern</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">at</span> 1. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">clean_sum</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> + <span class="id" title="var">Z</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> &lt;&gt; <span class="id" title="var">inl</span> <span class="id" title="var">y</span>) -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, { <span class="id" title="var">z</span> | <span class="id" title="var">inr</span> <span class="id" title="var">z</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hf</span>. <span class="id" title="var">enough</span> (<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>, <span class="id" title="var">a</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> -&gt; {<span class="id" title="var">z</span> : <span class="id" title="var">Z</span> &amp; <span class="id" title="var">inr</span> <span class="id" title="var">z</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>}).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">H</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">Hxa</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hf</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">y</span>|<span class="id" title="var">z</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Empty_rect</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">Hf</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <span class="id" title="var">Cantor_path_injection</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>} :<br/>
&nbsp;&nbsp;(<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) = (<span class="id" title="var">X</span> + <span class="id" title="var">Y</span>) -&gt; (<span class="id" title="var">X</span> + <span class="id" title="var">X</span>) = <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Injection</span> (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> : <span class="id" title="var">X</span> + <span class="id" title="var">Y</span> = (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) * (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span>, <span class="id" title="var">path_sum_prod</span>, <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">f</span> [<span class="id" title="var">g</span> <span class="id" title="var">Hfg</span> <span class="id" title="var">Hgf</span> <span class="id" title="var">_</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">f'</span> <span class="id" title="var">x</span> := <span class="id" title="var">fst</span> (<span class="id" title="var">f</span> (<span class="id" title="var">inl</span> <span class="id" title="var">x</span>))). <span class="id" title="tactic">destruct</span> (<span class="id" title="var">hCantor</span> <span class="id" title="var">f'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">Hp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">g'</span> <span class="id" title="var">q</span> := <span class="id" title="var">g</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>)). <span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span> <span class="id" title="var">x</span>, <span class="id" title="var">g'</span> <span class="id" title="var">q</span> &lt;&gt; <span class="id" title="var">inl</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Hp</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="var">f'</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">g'</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hfg</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">proj1</span> (<span class="id" title="var">clean_sum</span> <span class="id" title="var">_</span> <span class="id" title="var">H'</span> <span class="id" title="var">x</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">q'</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hqq'</span> : <span class="id" title="var">g'</span> <span class="id" title="var">q</span> = <span class="id" title="var">g'</span> <span class="id" title="var">q'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">clean_sum</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> &lt;-]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">clean_sum</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z'</span> &lt;-]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">unfold</span> <span class="id" title="var">g'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hqq'</span>. <span class="id" title="tactic">change</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>) = <span class="id" title="var">snd</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q'</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">Hfg</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>)), &lt;- (<span class="id" title="var">Hfg</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q'</span>)). <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hqq'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Version&nbsp;just&nbsp;requiring&nbsp;propositional&nbsp;injections&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Cantor_rel</span> <span class="id" title="var">X</span> (<span class="id" title="var">R</span> : <span class="id" title="var">X</span> -&gt; (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) -&gt; <span class="id" title="var">HProp</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> -&gt; <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">p'</span> -&gt; <span class="id" title="var">merely</span> (<span class="id" title="var">p</span> = <span class="id" title="var">p'</span>)) -&gt; { <span class="id" title="var">p</span> | <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, ~ <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> }.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">HR</span>. <span class="id" title="tactic">pose</span> (<span class="id" title="var">pc</span> <span class="id" title="var">x</span> := <span class="id" title="var">Build_HProp</span> (<span class="id" title="var">smalltype</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> -&gt; ~ <span class="id" title="var">p</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">pc</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>. <span class="id" title="var">enough</span> (<span class="id" title="var">Hpc</span> : <span class="id" title="var">pc</span> <span class="id" title="var">x</span> &lt;-&gt; ~ <span class="id" title="var">pc</span> <span class="id" title="var">x</span>). 2: <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">Hpc</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hpc</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>; <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hpc</span>. }<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_smalltype</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_smalltype</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> (<span class="id" title="var">HR</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hp</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InjectsInto_power_morph</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">InjectsInto</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) (<span class="id" title="var">Y</span> -&gt; <span class="id" title="var">HProp</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">HF</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">HF</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> <span class="id" title="var">Hf</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">hexists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">p</span> <span class="id" title="var">x</span> /\ <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_forall</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_iff_hprop</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hp</span> : (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : <span class="id" title="var">Y</span> =&gt; <span class="id" title="var">hexists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span> =&gt; <span class="id" title="var">p</span> <span class="id" title="var">x</span> * (<span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)). { <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">trivial</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hp</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hp</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [<span class="id" title="var">x'</span>[<span class="id" title="var">Hq</span> &lt;- % <span class="id" title="var">Hf</span>]].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hq</span> : (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : <span class="id" title="var">Y</span> =&gt; <span class="id" title="var">hexists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">X</span> =&gt; <span class="id" title="var">q</span> <span class="id" title="var">x</span> * (<span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>))) (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)). { <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">trivial</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pattern</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hq</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hq</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hq</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> [<span class="id" title="var">x'</span>[<span class="id" title="var">Hp</span> &lt;- % <span class="id" title="var">Hf</span>]].<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <span class="id" title="var">Cantor_injects_injects</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">HSet</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">InjectsInto</span> (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) (<span class="id" title="var">X</span> + <span class="id" title="var">Y</span>) -&gt; <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">X</span> + <span class="id" title="var">X</span>) <span class="id" title="var">X</span> -&gt; <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) <span class="id" title="var">Y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">HF</span> : <span class="id" title="var">InjectsInto</span> ((<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>) * (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>)) (<span class="id" title="var">X</span> + <span class="id" title="var">Y</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">InjectsInto_trans</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">InjectsInto_trans</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">InjectsInto_power_morph</span>, <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">path_sum_prod</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">HF</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> <span class="id" title="var">Hf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> := <span class="id" title="var">hexists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> =&gt; <span class="id" title="var">f</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>) = <span class="id" title="var">inl</span> <span class="id" title="var">x</span>)). <span class="id" title="tactic">destruct</span> (@<span class="id" title="var">Cantor_rel</span> <span class="id" title="var">_</span> <span class="id" title="var">R</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span> <span class="id" title="var">Hp</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> <span class="id" title="var">H3</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">q</span> <span class="id" title="var">Hq</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">q'</span> <span class="id" title="var">Hq'</span>]. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>)). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Hf</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>) (<span class="id" title="var">p'</span>, <span class="id" title="var">q'</span>)); <span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hq</span>, <span class="id" title="var">Hq'</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">f'</span> <span class="id" title="var">q</span> := <span class="id" title="var">f</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>)). <span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span> <span class="id" title="var">x</span>, <span class="id" title="var">f'</span> <span class="id" title="var">q</span> &lt;&gt; <span class="id" title="var">inl</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">x</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Hp</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">q</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">proj1</span> (<span class="id" title="var">clean_sum</span> <span class="id" title="var">_</span> <span class="id" title="var">H'</span> <span class="id" title="var">x</span>)). <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">q'</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hqq'</span> : <span class="id" title="var">f'</span> <span class="id" title="var">q</span> = <span class="id" title="var">f'</span> <span class="id" title="var">q'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">clean_sum</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> &lt;-]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">clean_sum</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z'</span> &lt;-]. <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">Hf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hqq'</span>. <span class="id" title="tactic">change</span> <span class="id" title="var">q</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">p</span>, <span class="id" title="var">q</span>)). <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hqq'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Preparation</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1321"></a><h1 class="section">Sierpinski's Theorem</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Sierpinski</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">UA</span> : <span class="id" title="var">Univalence</span>}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">EM</span> : <span class="id" title="var">ExcludedMiddle</span>}.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">PR</span> : <span class="id" title="var">PropResizing</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">powfix</span> <span class="id" title="var">X</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span> + <span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span>) = (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">HN</span> : <span class="id" title="var">HSet</span> -&gt; <span class="id" title="var">HSet</span>.<br/>

<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">HN_ninject</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span>, ~ <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">HN</span> <span class="id" title="var">X</span>) <span class="id" title="var">X</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">HN_bound</span> : <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">HN_inject</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span>, <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">HN</span> <span class="id" title="var">X</span>) (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">HN_bound</span>).<br/>

<br/>
<span class="comment">(*&nbsp;This&nbsp;section&nbsp;then&nbsp;concludes&nbsp;the&nbsp;intermediate&nbsp;result&nbsp;that&nbsp;abstractly,&nbsp;any&nbsp;function&nbsp;HN&nbsp;behaving&nbsp;like&nbsp;the&nbsp;Hartogs&nbsp;number&nbsp;is&nbsp;tamed&nbsp;in&nbsp;the&nbsp;presence&nbsp;of&nbsp;GCH.&nbsp;&nbsp;Morally&nbsp;we&nbsp;show&nbsp;that&nbsp;X&nbsp;&lt;=&nbsp;HN(X)&nbsp;for&nbsp;all&nbsp;X,&nbsp;we&nbsp;just&nbsp;ensure&nbsp;that&nbsp;X&nbsp;is&nbsp;large&nbsp;enough&nbsp;by&nbsp;considering&nbsp;P(N&nbsp;+&nbsp;X).&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">InjectsInto_sum</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">X'</span> <span class="id" title="var">Y'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">InjectsInto</span> <span class="id" title="var">X</span> <span class="id" title="var">X'</span> -&gt; <span class="id" title="var">InjectsInto</span> <span class="id" title="var">Y</span> <span class="id" title="var">Y'</span> -&gt; <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">X</span> + <span class="id" title="var">Y</span>) (<span class="id" title="var">X'</span> + <span class="id" title="var">Y'</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> <span class="id" title="var">Hf</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">intros</span> [<span class="id" title="var">g</span> <span class="id" title="var">Hg</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">z</span> <span class="id" title="keyword">with</span> <span class="id" title="var">inl</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) | <span class="id" title="var">inr</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">end</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span>|<span class="id" title="var">y</span>] [<span class="id" title="var">x'</span>|<span class="id" title="var">y'</span>] <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hf</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sum_inl</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Y'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">inl_ne_inr</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">inr_ne_inl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hg</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sum_inr</span> <span class="id" title="keyword">with</span> <span class="id" title="var">X'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;main&nbsp;proof&nbsp;is&nbsp;by&nbsp;induction&nbsp;on&nbsp;the&nbsp;cardinality&nbsp;bound&nbsp;for&nbsp;HN.&nbsp;&nbsp;As&nbsp;the&nbsp;Hartogs&nbsp;number&nbsp;is&nbsp;bounded&nbsp;by&nbsp;P^3(X),&nbsp;we'd&nbsp;actually&nbsp;just&nbsp;need&nbsp;finitely&nbsp;many&nbsp;instances&nbsp;of&nbsp;GCH.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Sierpinski_step</span> (<span class="id" title="var">X</span> : <span class="id" title="var">HSet</span>) <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">GCH</span> -&gt; <span class="id" title="var">infinite</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">powfix</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">InjectsInto</span> (<span class="id" title="var">HN</span> <span class="id" title="var">X</span>) (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span>) -&gt; <span class="id" title="var">InjectsInto</span> <span class="id" title="var">X</span> (<span class="id" title="var">HN</span> <span class="id" title="var">X</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">gch</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span> <span class="id" title="var">Hi</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">HN_ninject</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">gch</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span>)) (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> <span class="id" title="var">n</span> + <span class="id" title="var">HN</span> <span class="id" title="var">X</span>))) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">infinite_power_iterated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">inl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">x'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sum_inl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">InjectsInto_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">InjectsInto_sum</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">Hi</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>, <span class="id" title="var">Injection_power</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">cbn</span>. <span class="id" title="tactic">specialize</span> (<span class="id" title="var">H2</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)). <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>, <span class="id" title="var">Injection_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InjectsInto_trans</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">inr</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sum_inr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">InjectsInto_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">power_iterated</span> <span class="id" title="var">X</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)); <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>, <span class="id" title="var">Injection_power_iterated</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Cantor_injects_injects</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H2</span> <span class="id" title="var">n</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>, <span class="id" title="var">Injection_refl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">GCH_injects'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">HSet</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">GCH</span> -&gt; <span class="id" title="var">infinite</span> <span class="id" title="var">X</span> -&gt; <span class="id" title="var">InjectsInto</span> <span class="id" title="var">X</span> (<span class="id" title="var">HN</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>))).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">gch</span> <span class="id" title="var">HX</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InjectsInto_trans</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>, <span class="id" title="var">Injection_power</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">Sierpinski_step</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">X</span> -&gt; <span class="id" title="var">HProp</span>)) <span class="id" title="var">HN_bound</span> <span class="id" title="var">gch</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">infinite_inject</span> <span class="id" title="keyword">with</span> <span class="id" title="var">X</span>; <span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Injection_power</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">power_iterated_shift</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">path_infinite_power</span>. <span class="id" title="var">cbn</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">infinite_power_iterated</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">HN_inject</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">GCH_injects</span> (<span class="id" title="var">X</span> : <span class="id" title="var">HSet</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">GCH</span> -&gt; <span class="id" title="var">InjectsInto</span> <span class="id" title="var">X</span> (<span class="id" title="var">HN</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">nat</span> + <span class="id" title="var">X</span>) -&gt; <span class="id" title="var">HProp</span>))).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">gch</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">InjectsInto_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">nat</span> + <span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">inr</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sum_inr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">GCH_injects'</span>; <span class="id" title="tactic">trivial</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">inl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_sum_inl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Sierpinski</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Main&nbsp;result:&nbsp;GCH&nbsp;implies&nbsp;AC&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">GCH_AC</span> {<span class="id" title="var">UA</span> : <span class="id" title="var">Univalence</span>} {<span class="id" title="var">PR</span> : <span class="id" title="var">PropResizing</span>} {<span class="id" title="var">LEM</span> : <span class="id" title="var">ExcludedMiddle</span>} :<br/>
&nbsp;&nbsp;<span class="id" title="var">GCH</span> -&gt; <span class="id" title="var">Choice_type</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">gch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">WO_AC</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">hartogs_number</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">Build_HSet</span> (<span class="id" title="var">nat</span> + <span class="id" title="var">X</span>) -&gt; <span class="id" title="var">HProp</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">eapply</span> (@<span class="id" title="var">GCH_injects</span> <span class="id" title="var">UA</span> <span class="id" title="var">LEM</span> <span class="id" title="var">PR</span> <span class="id" title="var">hartogs_number</span> <span class="id" title="var">_</span> 3 <span class="id" title="var">_</span> <span class="id" title="var">X</span> <span class="id" title="var">gch</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Y</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">merely_destruct</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hartogs_number_no_injection</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">hartogs_number_injection</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Note&nbsp;that&nbsp;the&nbsp;assumption&nbsp;of&nbsp;LEM&nbsp;is&nbsp;actually&nbsp;not&nbsp;necessary&nbsp;due&nbsp;to&nbsp;GCH_LEM.&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>