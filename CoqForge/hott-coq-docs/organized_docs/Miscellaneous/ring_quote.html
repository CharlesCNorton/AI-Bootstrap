<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>ring_quote</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ring_quote</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.abstract_algebra</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">AlmostNegate</span> <span class="id" title="var">A</span> := <span class="id" title="var">almost_negate</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">AlmostRing</span> <span class="id" title="var">A</span> {<span class="id" title="var">Aplus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Amult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">Azero</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Aone</span> : <span class="id" title="var">One</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Anegate</span> : <span class="id" title="var">AlmostNegate</span> <span class="id" title="var">A</span>} :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">almost_ring_semiring</span> : <span class="id" title="var">IsSemiCRing</span> <span class="id" title="var">A</span><br/>
&nbsp;&nbsp;; <span class="id" title="var">almost_ring_neg_pr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">almost_negate</span> <span class="id" title="var">x</span> = (<span class="id" title="var">almost_negate</span> 1) * <span class="id" title="var">x</span> }.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">almostring_mor</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">Aplus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Bplus</span> : <span class="id" title="var">Plus</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">Amult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Bmult</span> : <span class="id" title="var">Mult</span> <span class="id" title="var">B</span>} {<span class="id" title="var">Azero</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Bzero</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">Aone</span> : <span class="id" title="var">One</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Bone</span> : <span class="id" title="var">One</span> <span class="id" title="var">B</span>} {<span class="id" title="var">Aneg</span> : <span class="id" title="var">AlmostNegate</span> <span class="id" title="var">A</span>} {<span class="id" title="var">Bneg</span> : <span class="id" title="var">AlmostNegate</span> <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">AlmostRingPreserving</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">almostring_mor_sr_mor</span> : <span class="id" title="var">IsSemiRingPreserving</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;; <span class="id" title="var">almostring_mor_neg</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> (<span class="id" title="var">almost_negate</span> <span class="id" title="var">x</span>) = <span class="id" title="var">almost_negate</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) }.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">almostring_mor</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Quoting</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Expr</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) : <span class="id" title="var">Type0</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">Var</span> (<span class="id" title="var">v</span> : <span class="id" title="var">V</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Zero</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">One</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Plus</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">Expr</span> <span class="id" title="var">V</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Mult</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">Expr</span> <span class="id" title="var">V</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Neg</span> (<span class="id" title="var">a</span> : <span class="id" title="var">Expr</span> <span class="id" title="var">V</span>)<br/>
.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Var</span> {<span class="id" title="var">V</span>} <span class="id" title="var">v</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Zero</span> {<span class="id" title="var">V</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">One</span> {<span class="id" title="var">V</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Plus</span> {<span class="id" title="var">V</span>} <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Mult</span> {<span class="id" title="var">V</span>} <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Neg</span> {<span class="id" title="var">V</span>} <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">contents</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">U</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">R</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">U</span>}) `{<span class="id" title="var">AlmostRing</span> <span class="id" title="var">R</span>}.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Vars</span> <span class="id" title="var">V</span> := (<span class="id" title="var">V</span> -&gt; <span class="id" title="var">R</span>).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="tactic">eval</span> {<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>} (<span class="id" title="var">vs</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">Expr</span> <span class="id" title="var">V</span>) : <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Var</span> <span class="id" title="var">v</span> =&gt; <span class="id" title="var">vs</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Zero</span> =&gt; 0<br/>
&nbsp;&nbsp;| <span class="id" title="var">One</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id" title="var">Plus</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="tactic">eval</span> <span class="id" title="var">vs</span> <span class="id" title="var">a</span> + <span class="id" title="tactic">eval</span> <span class="id" title="var">vs</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Mult</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="tactic">eval</span> <span class="id" title="var">vs</span> <span class="id" title="var">a</span> * <span class="id" title="tactic">eval</span> <span class="id" title="var">vs</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Neg</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="var">almost_negate</span> (<span class="id" title="tactic">eval</span> <span class="id" title="var">vs</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eval_ext</span> {<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>} (<span class="id" title="var">vs</span> <span class="id" title="var">vs'</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">pointwise_paths@</span>{<span class="id" title="keyword">Set</span> <span class="id" title="var">U</span>} <span class="id" title="var">vs</span> <span class="id" title="var">vs'</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">pointwise_paths@</span>{<span class="id" title="keyword">Set</span> <span class="id" title="var">U</span>} (<span class="id" title="tactic">eval</span> <span class="id" title="var">vs</span>) (<span class="id" title="tactic">eval</span> <span class="id" title="var">vs'</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span> <span class="id" title="var">e</span>;<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>;<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">auto</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">noVars</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">Empty</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> []. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">singleton</span> <span class="id" title="var">x</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">Unit</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">merge</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">va</span>:<span class="id" title="var">Vars</span> <span class="id" title="var">A</span>) (<span class="id" title="var">vb</span>:<span class="id" title="var">Vars</span> <span class="id" title="var">B</span>) : <span class="id" title="var">Vars</span> (<span class="id" title="var">sum@</span>{<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Set</span>} <span class="id" title="var">A</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">i</span> <span class="id" title="keyword">with</span> <span class="id" title="var">inl</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">va</span> <span class="id" title="var">i</span> | <span class="id" title="var">inr</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">vb</span> <span class="id" title="var">i</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Lookup</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Class</span> <span class="id" title="var">Lookup</span> {<span class="id" title="var">A</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">x</span>: <span class="id" title="var">R</span>) (<span class="id" title="var">f</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">lookup</span>: <span class="id" title="var">A</span>; <span class="id" title="var">lookup_correct</span>: <span class="id" title="var">f</span> <span class="id" title="var">lookup</span> = <span class="id" title="var">x</span> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Arguments</span> <span class="id" title="var">lookup</span> {<span class="id" title="var">A</span>} <span class="id" title="var">x</span> <span class="id" title="var">f</span> {<span class="id" title="var">_</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">x</span>:<span class="id" title="var">R</span>) {<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">va</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">A</span>) (<span class="id" title="var">vb</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">B</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">lookup_l</span> `{!<span class="id" title="var">Lookup</span> <span class="id" title="var">x</span> <span class="id" title="var">va</span>} : <span class="id" title="var">Lookup</span> <span class="id" title="var">x</span> (<span class="id" title="var">merge</span> <span class="id" title="var">va</span> <span class="id" title="var">vb</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">lookup</span> <span class="id" title="var">x</span> <span class="id" title="var">va</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">lookup_correct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">lookup_r</span> `{!<span class="id" title="var">Lookup</span> <span class="id" title="var">x</span> <span class="id" title="var">vb</span>} : <span class="id" title="var">Lookup</span> <span class="id" title="var">x</span> (<span class="id" title="var">merge</span> <span class="id" title="var">va</span> <span class="id" title="var">vb</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">lookup</span> <span class="id" title="var">x</span> <span class="id" title="var">vb</span>)). <span class="id" title="tactic">apply</span> <span class="id" title="var">lookup_correct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">lookup_single</span> : <span class="id" title="var">Lookup</span> <span class="id" title="var">x</span> (<span class="id" title="var">singleton</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">tt</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Lookup</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">expr_map</span> {<span class="id" title="var">V</span> <span class="id" title="var">W</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">f</span> : <span class="id" title="var">V</span> -&gt; <span class="id" title="var">W</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">Expr</span> <span class="id" title="var">V</span>) : <span class="id" title="var">Expr</span> <span class="id" title="var">W</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Var</span> <span class="id" title="var">v</span> =&gt; <span class="id" title="var">Var</span> (<span class="id" title="var">f</span> <span class="id" title="var">v</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Zero</span> =&gt; <span class="id" title="var">Zero</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">One</span> =&gt; <span class="id" title="var">One</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Plus</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">Plus</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span>) (<span class="id" title="var">expr_map</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Mult</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">Mult</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span>) (<span class="id" title="var">expr_map</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Neg</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="var">Neg</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eval_map</span> {<span class="id" title="var">V</span> <span class="id" title="var">W</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">f</span> : <span class="id" title="var">V</span> -&gt; <span class="id" title="var">W</span>) <span class="id" title="var">v</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;: <span class="id" title="tactic">eval</span> <span class="id" title="var">v</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">f</span> <span class="id" title="var">e</span>) = <span class="id" title="tactic">eval</span> (<span class="id" title="var">Compose@</span>{<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">U</span>} <span class="id" title="var">v</span> <span class="id" title="var">f</span>) <span class="id" title="var">e</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">e</span>;<span class="id" title="tactic">simpl</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Quote</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Class</span> <span class="id" title="var">Quote</span> {<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">l</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) (<span class="id" title="var">n</span>: <span class="id" title="var">R</span>) {<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">r</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">quote</span> : <span class="id" title="var">Expr</span> (<span class="id" title="var">V</span> |<span class="id" title="var">_</span>| <span class="id" title="var">V'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">eval_quote</span> : @<span class="id" title="tactic">eval</span> (<span class="id" title="var">V</span> |<span class="id" title="var">_</span>| <span class="id" title="var">V'</span>) (<span class="id" title="var">merge</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) <span class="id" title="tactic">quote</span> = <span class="id" title="var">n</span> }.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Arguments</span> <span class="id" title="tactic">quote</span> {<span class="id" title="var">V</span> <span class="id" title="var">l</span>} <span class="id" title="var">n</span> {<span class="id" title="var">V'</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Arguments</span> <span class="id" title="var">eval_quote</span> {<span class="id" title="var">V</span> <span class="id" title="var">l</span>} <span class="id" title="var">n</span> {<span class="id" title="var">V'</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">sum_assoc</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>}: (<span class="id" title="var">A</span> |<span class="id" title="var">_</span>| <span class="id" title="var">B</span>) |<span class="id" title="var">_</span>| <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span> |<span class="id" title="var">_</span>| (<span class="id" title="var">B</span> |<span class="id" title="var">_</span>| <span class="id" title="var">C</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[?|?]|?];<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">sum_aux</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>}: (<span class="id" title="var">A</span> |<span class="id" title="var">_</span>| <span class="id" title="var">B</span>) -&gt; <span class="id" title="var">A</span> |<span class="id" title="var">_</span>| (<span class="id" title="var">B</span> |<span class="id" title="var">_</span>| <span class="id" title="var">C</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [?|?];<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_zero</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>): <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> 0 <span class="id" title="var">noVars</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">Zero</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_one</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>): <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> 1 <span class="id" title="var">noVars</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">One</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quote_plus_ok</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) <span class="id" title="var">m</span> (<span class="id" title="var">V''</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v''</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>} `{!<span class="id" title="var">Quote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">m</span> <span class="id" title="var">v''</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Plus</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_aux</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">n</span>)) (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_assoc</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">m</span>))) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> + <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">n</span>), &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2!<span class="id" title="var">eval_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [?|?];<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[?|?]|?];<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_plus</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) <span class="id" title="var">m</span> (<span class="id" title="var">V''</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v''</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V''</span>)<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>} `{!<span class="id" title="var">Quote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">m</span> <span class="id" title="var">v''</span>}: <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">quote_plus_ok</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quote_mult_ok</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) <span class="id" title="var">m</span> (<span class="id" title="var">V''</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v''</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>} `{!<span class="id" title="var">Quote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">m</span> <span class="id" title="var">v''</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Mult</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_aux</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">n</span>)) (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_assoc</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">m</span>))) = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> * <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">n</span>), &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">m</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2!<span class="id" title="var">eval_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [?|?];<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[?|?]|?];<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_mult</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) <span class="id" title="var">m</span> (<span class="id" title="var">V''</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v''</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>} `{!<span class="id" title="var">Quote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">m</span> <span class="id" title="var">v''</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> (<span class="id" title="var">n</span> * <span class="id" title="var">m</span>) (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">quote_mult_ok</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quote_neg_ok@</span>{} (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span> (<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) (<span class="id" title="var">Neg</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">n</span>)) = <span class="id" title="var">almost_negate</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>,<span class="id" title="var">eval_quote</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_neg</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span> (<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span> : <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> (<span class="id" title="var">almost_negate</span> <span class="id" title="var">n</span>) <span class="id" title="var">v'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">Neg</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">quote_neg_ok</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_old_var</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">x</span> {<span class="id" title="var">i</span>: <span class="id" title="var">Lookup</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">x</span> <span class="id" title="var">noVars</span> | 8.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">Var</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">lookup</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lookup_correct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">quote_new_var</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">x</span> (<span class="id" title="var">singleton</span> <span class="id" title="var">x</span>) | 9.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">Var</span> (<span class="id" title="var">inr</span> <span class="id" title="var">tt</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Quote</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">quote'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> {<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span> } {<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>} {<span class="id" title="var">d</span>: <span class="id" title="var">Quote</span> <span class="id" title="var">noVars</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>}, <span class="id" title="var">Expr</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;:= @<span class="id" title="tactic">quote</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eval_quote'</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> {<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>} {<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>} {<span class="id" title="var">d</span>: <span class="id" title="var">Quote</span> <span class="id" title="var">noVars</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>},<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">noVars</span> <span class="id" title="var">v</span>) (<span class="id" title="tactic">quote</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;:= @<span class="id" title="var">eval_quote</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">EqQuote</span> {<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">l</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) (<span class="id" title="var">n</span> <span class="id" title="var">m</span>: <span class="id" title="var">R</span>) {<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span> } (<span class="id" title="var">r</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">eqquote_l</span> : <span class="id" title="var">Expr</span> <span class="id" title="var">V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">eqquote_r</span> : <span class="id" title="var">Expr</span> (<span class="id" title="var">V</span> |<span class="id" title="var">_</span>| <span class="id" title="var">V'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">eval_eqquote</span> : <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) (<span class="id" title="var">expr_map</span> <span class="id" title="var">inl</span> <span class="id" title="var">eqquote_l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span>) <span class="id" title="var">eqquote_r</span> -&gt; <span class="id" title="var">n</span> = <span class="id" title="var">m</span> }.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_quote_ok</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) <span class="id" title="var">m</span> (<span class="id" title="var">V''</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v''</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V''</span>)<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>} `{!<span class="id" title="var">Quote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">m</span> <span class="id" title="var">v''</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>)) (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_aux</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">n</span>))<br/>
&nbsp;&nbsp;= <span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>)) (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_assoc</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">m</span>))<br/>
&nbsp;&nbsp;-&gt; <span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">n</span>), &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="var">path_via</span> (<span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>)) (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_aux</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">n</span>)));<br/>
[|<span class="id" title="var">path_via</span> (<span class="id" title="tactic">eval</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v'</span> <span class="id" title="var">v''</span>)) (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_assoc</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">m</span>)))].<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eval_map</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [?|?];<span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">eval_map</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[?|?]|?];<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Instance</span> <span class="id" title="var">eq_quote</span> (<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>) <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>) <span class="id" title="var">m</span> (<span class="id" title="var">V''</span>:<span class="id" title="var">Type0</span>) (<span class="id" title="var">v''</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V''</span>)<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">n</span> <span class="id" title="var">v'</span>} `{!<span class="id" title="var">Quote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">m</span> <span class="id" title="var">v''</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">EqQuote</span> (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">v''</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">econstructor</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">eq_quote_ok</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Quote0</span> <span class="id" title="var">Quote1</span>).<br/>
<span class="id" title="var">etransitivity</span>;[<span class="id" title="var">etransitivity</span>;[|<span class="id" title="tactic">exact</span> <span class="id" title="var">E</span>]|].<br/>
- <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">eval_map</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>. <span class="id" title="tactic">intros</span> [?|?];<span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">eval_map</span> <span class="id" title="var">sum_assoc</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>. <span class="id" title="tactic">intros</span> [[?|?]|?];<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sum_forget</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} : <span class="id" title="var">Empty</span> |<span class="id" title="var">_</span>| <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span> |<span class="id" title="var">_</span>| <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [[]|?];<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quote_equality</span> {<span class="id" title="var">V</span>:<span class="id" title="var">Type0</span>} {<span class="id" title="var">v</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">V'</span>:<span class="id" title="var">Type0</span>} {<span class="id" title="var">v'</span>: <span class="id" title="var">Vars</span> <span class="id" title="var">V'</span>} (<span class="id" title="var">l</span> <span class="id" title="var">r</span>: <span class="id" title="var">R</span>)<br/>
&nbsp;&nbsp;`{!<span class="id" title="var">Quote</span> <span class="id" title="var">noVars</span> <span class="id" title="var">l</span> <span class="id" title="var">v</span>} `{!<span class="id" title="var">Quote</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> <span class="id" title="var">v'</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">let</span> <span class="id" title="var">heap</span> := (<span class="id" title="var">merge</span> <span class="id" title="var">v</span> <span class="id" title="var">v'</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">eval</span> <span class="id" title="var">heap</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_forget</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">l</span>)) = <span class="id" title="tactic">eval</span> <span class="id" title="var">heap</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">r</span>) -&gt; <span class="id" title="var">l</span> = <span class="id" title="var">r</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> ? <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">l</span>),&lt;-(<span class="id" title="var">eval_quote</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="var">path_via</span> (<span class="id" title="tactic">eval</span> <span class="id" title="var">heap</span> (<span class="id" title="var">expr_map</span> <span class="id" title="var">sum_forget</span> (<span class="id" title="tactic">quote</span> <span class="id" title="var">l</span>))).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">eval_map</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eval_ext</span>.<br/>
<span class="id" title="tactic">intros</span> [[]|?]. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">contents</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Instances</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Existing Instances</span> <span class="id" title="var">lookup_l</span> <span class="id" title="var">lookup_r</span> <span class="id" title="var">lookup_single</span> <span class="id" title="var">quote_zero</span> <span class="id" title="var">quote_one</span> <span class="id" title="var">quote_plus</span> <span class="id" title="var">quote_mult</span> <span class="id" title="var">quote_neg</span> <span class="id" title="var">eq_quote</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">quote_old_var</span> | 8.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">quote_new_var</span> | 9.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Instances</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Quoting</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>