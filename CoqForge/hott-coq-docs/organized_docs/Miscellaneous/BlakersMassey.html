<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>BlakersMassey</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library BlakersMassey</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span> <span class="id" title="var">HoTT.Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Colimits.Pushout</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Colimits.SpanPushout</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Homotopy.Join.Core</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Truncations</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1100"></a><h1 class="section">The Generalized Blakers-Massey Theorem</h1>

<div class="paragraph"> </div>

<a id="lab1101"></a><h2 class="section">Path algebra helper lemma</h2>

<div class="paragraph"> </div>

 Here is a strange-looking path algebra helper lemma that is easier to prove by lifting to a general case and doing a path-induction blast.  It says something about what happens when we transport from the center of a based path-space to some other point, assuming we know a particular way to "compute" the action of the type family in question. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transport_singleton</span> `{<span class="id" title="var">Univalence</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">B</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">y</span> : <span class="id" title="var">A</span>), (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>) -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">u</span> : <span class="id" title="var">B</span> <span class="id" title="var">x</span> <span class="id" title="var">idpath</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">q</span>:<span class="id" title="var">x</span>=<span class="id" title="var">x</span>), <span class="id" title="var">B</span> <span class="id" title="var">x</span> <span class="id" title="var">q</span> &lt;~&gt; <span class="id" title="var">B</span> <span class="id" title="var">y</span> (<span class="id" title="var">q</span> @ <span class="id" title="var">p</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ev</span> : <span class="id" title="var">ap10</span> (<span class="id" title="var">apD</span> <span class="id" title="var">B</span> <span class="id" title="var">p</span>) <span class="id" title="var">p</span> =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">transport_arrow_toconst</span> <span class="id" title="var">p</span> (<span class="id" title="var">B</span> <span class="id" title="var">x</span>) <span class="id" title="var">p</span> @<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">path_universe_uncurried</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> (<span class="id" title="var">B</span> <span class="id" title="var">y</span>) ((<span class="id" title="var">p</span> @ <span class="id" title="var">p</span>^) @ <span class="id" title="var">p</span>) <span class="id" title="var">p</span> (<span class="id" title="var">concat_pV_p</span> <span class="id" title="var">p</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> (<span class="id" title="var">f</span> (<span class="id" title="var">p</span> @ <span class="id" title="var">p</span>^))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> @<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> (<span class="id" title="var">B</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) <span class="id" title="var">p</span>^ <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> @ <span class="id" title="var">p</span>^) (<span class="id" title="var">transport_paths_r</span> <span class="id" title="var">p</span>^ <span class="id" title="var">p</span>)))<br/>
&nbsp;&nbsp;: <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">yp</span>:{<span class="id" title="var">y</span>:<span class="id" title="var">A</span> &amp; <span class="id" title="var">x</span>=<span class="id" title="var">y</span>} =&gt; <span class="id" title="var">B</span> <span class="id" title="var">yp</span>.1 <span class="id" title="var">yp</span>.2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">path_contr</span> (<span class="id" title="var">A</span> := {<span class="id" title="var">y</span>:<span class="id" title="var">A</span> &amp; <span class="id" title="var">x</span>=<span class="id" title="var">y</span>}) (<span class="id" title="var">x</span>;<span class="id" title="var">idpath</span>) (<span class="id" title="var">y</span>;<span class="id" title="var">p</span>)) <span class="id" title="var">u</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">transport</span> (<span class="id" title="var">B</span> <span class="id" title="var">y</span>) (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>) (<span class="id" title="var">f</span> <span class="id" title="var">idpath</span> <span class="id" title="var">u</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">e</span> @ <span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_equiv_V</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">equiv_fun</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap10</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">ev</span> <span class="id" title="var">u</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ev</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">ev</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1102"></a><h2 class="section">Setup</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">GBM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> -&gt; <span class="id" title="keyword">Type</span>).<br/>

<br/>
</div>

<div class="doc">
Here's the hypothesis of ABFJ generalized Blakers-Massey.  It works for any reflective subuniverse, not only modalities! 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">O</span> : <span class="id" title="var">ReflectiveSubuniverse</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">isconnected_cogap</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">x1</span> <span class="id" title="var">x3</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">y2</span> <span class="id" title="var">y4</span> : <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">q12</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">y2</span>) (<span class="id" title="var">q32</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x3</span> <span class="id" title="var">y2</span>) (<span class="id" title="var">q34</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x3</span> <span class="id" title="var">y4</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> (<span class="id" title="var">Join</span> ((<span class="id" title="var">x1</span>;<span class="id" title="var">q12</span>) = (<span class="id" title="var">x3</span>;<span class="id" title="var">q32</span>) :&gt; {<span class="id" title="var">x</span>:<span class="id" title="var">X</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y2</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">y2</span>;<span class="id" title="var">q32</span>) = (<span class="id" title="var">y4</span>;<span class="id" title="var">q34</span>) :&gt; {<span class="id" title="var">y</span>:<span class="id" title="var">Y</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x3</span> <span class="id" title="var">y</span>}))).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">P</span> := <span class="id" title="var">SPushout</span> <span class="id" title="var">Q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Local Notation</span> <span class="id" title="tactic">left</span> := (<span class="id" title="var">spushl</span> <span class="id" title="var">Q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Local Notation</span> <span class="id" title="tactic">right</span> := (<span class="id" title="var">spushr</span> <span class="id" title="var">Q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Local Notation</span> <span class="id" title="var">glue</span> := (<span class="id" title="var">spglue</span> <span class="id" title="var">Q</span>).<br/>

<br/>
</div>

<div class="doc">
Here's a lemma that's a sort of "singleton contractibility" equivalence, but expressed in a particularly strange way.  As we'll see, this form of the lemma comes up naturally *twice* in the proof, and proving it once here to use in both places is crucial so that the two uses can be identified later on. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">frobnicate</span> {<span class="id" title="var">x0</span> <span class="id" title="var">x1</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="tactic">left</span> <span class="id" title="var">x1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">Y</span>) (<span class="id" title="var">q1</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: {<span class="id" title="var">q0</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">w</span> : <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">s</span> <span class="id" title="var">q0</span> = <span class="id" title="var">q1</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">glue</span> <span class="id" title="var">q0</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q1</span>)^ = <span class="id" title="var">r</span> } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_sigma_assoc'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_functor_sigma'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Q</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">qt</span> =&gt; <span class="id" title="var">glue</span> <span class="id" title="var">qt</span>.1 @ (<span class="id" title="var">glue</span> <span class="id" title="var">q1</span>)^ = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">equiv_functor_sigma_id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q0</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">equiv_moveL_transport_V</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">s</span> <span class="id" title="var">q0</span> <span class="id" title="var">q1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">qt</span> =&gt; <span class="id" title="var">equiv_idmap</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_contr_sigma</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">ap_transport</span> <span class="id" title="var">s</span>^ (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">q</span> =&gt; <span class="id" title="var">glue</span> <span class="id" title="var">q</span>) <span class="id" title="var">q1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_paths_FlFr</span> <span class="id" title="var">s</span>^ (<span class="id" title="var">glue</span> <span class="id" title="var">q1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_V</span>, <span class="id" title="var">inv_V</span>, <span class="id" title="var">ap_const</span>, <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_concat_l</span> (<span class="id" title="var">concat_pp_V</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^ <span class="id" title="var">_</span>).<br/>
</div>

<div class="doc">
Although we proved this lemma with <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>, we make it transparent, not so that *we* can reason about it, but so that Coq can evaluate it. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;But&nbsp;except&nbsp;in&nbsp;one&nbsp;place,&nbsp;we&nbsp;don't&nbsp;want&nbsp;it&nbsp;to&nbsp;try&nbsp;(otherwise&nbsp;things&nbsp;get&nbsp;really&nbsp;slow).&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Opaque</span> <span class="id" title="var">frobnicate</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1103"></a><h2 class="section">Codes</h2>

<div class="paragraph"> </div>

<a id="lab1104"></a><h3 class="section">Right-hand codes</h3>

<div class="paragraph"> </div>

 The right-hand codes family is easy. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">coderight</span> {<span class="id" title="var">x0</span> : <span class="id" title="var">X</span>} {<span class="id" title="var">y</span> : <span class="id" title="var">Y</span>} (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="tactic">right</span> <span class="id" title="var">y</span>) : <span class="id" title="keyword">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">O</span> (<span class="id" title="var">hfiber</span> <span class="id" title="var">glue</span> <span class="id" title="var">r</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab1105"></a><h3 class="section">Left-hand codes</h3>

<div class="paragraph"> </div>

 We enhance the HFLL and ABFJ theorems by defining a version of code-left that doesn't depend on one map being surjective. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">CodeLeft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">x0</span> <span class="id" title="var">x1</span> : <span class="id" title="var">X</span>} (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="tactic">left</span> <span class="id" title="var">x1</span>).<br/>

<br/>
</div>

<div class="doc">
The left codes are themselves a pushout, of what is morally also a dependent span, but we formulate it as an ordinary pushout of projections between iterated Sigma-types, most of which we express as records for performance reasons.  The span is <span class="inlinecode"><span class="id" title="var">codeleft1</span></span> &lt;- <span class="inlinecode"><span class="id" title="var">codeleft0</span></span> -&gt; <span class="inlinecode"><span class="id" title="var">codeleft2</span></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeleft1</span> : <span class="id" title="keyword">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;v&nbsp;:&nbsp;*)</span> <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">codeleft2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">codeleft2_y0</span>  : <span class="id" title="var">Y</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft2_q00</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">codeleft2_y0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft2_q10</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">codeleft2_y0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft2_u</span>   : <span class="id" title="var">glue</span> <span class="id" title="var">codeleft2_q00</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">codeleft2_q10</span>)^ = <span class="id" title="var">r</span> }.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">codeleft0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">codeleft0_s</span>   : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_y0</span>  : <span class="id" title="var">Y</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_v</span>   : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">codeleft0_s</span> = <span class="id" title="var">r</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_q00</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">codeleft0_y0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_q10</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">codeleft0_y0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_w</span>   : <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">codeleft0_y0</span>) <span class="id" title="var">codeleft0_s</span> <span class="id" title="var">codeleft0_q00</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">codeleft0_q10</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_u</span>   : <span class="id" title="var">glue</span> <span class="id" title="var">codeleft0_q00</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">codeleft0_q10</span>)^ = <span class="id" title="var">r</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Note the first use of frobnicate here. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeleft0_d</span>   : <span class="id" title="var">frobnicate</span> <span class="id" title="var">r</span> <span class="id" title="var">codeleft0_s</span> <span class="id" title="var">codeleft0_y0</span> <span class="id" title="var">codeleft0_q10</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">codeleft0_q00</span> ; <span class="id" title="var">codeleft0_w</span> ; <span class="id" title="var">codeleft0_u</span>) = <span class="id" title="var">codeleft0_v</span> }.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeleft01</span> : <span class="id" title="var">codeleft0</span> -&gt; <span class="id" title="var">codeleft1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">s</span> <span class="id" title="var">y0</span> <span class="id" title="var">v</span> <span class="id" title="var">q00</span> <span class="id" title="var">q10</span> <span class="id" title="var">w</span> <span class="id" title="var">u</span> <span class="id" title="var">d</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeleft02</span> : <span class="id" title="var">codeleft0</span> -&gt; <span class="id" title="var">codeleft2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">s</span> <span class="id" title="var">y0</span> <span class="id" title="var">v</span> <span class="id" title="var">q00</span> <span class="id" title="var">q10</span> <span class="id" title="var">w</span> <span class="id" title="var">u</span> <span class="id" title="var">d</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">Build_codeleft2</span> <span class="id" title="var">y0</span> <span class="id" title="var">q00</span> <span class="id" title="var">q10</span> <span class="id" title="var">u</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeleft</span> : <span class="id" title="keyword">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">codeleft02</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab1106"></a><h3 class="section">Codes for glue</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">CodeGlue</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">y1</span> : <span class="id" title="var">Y</span>} (<span class="id" title="var">q11</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">y1</span>).<br/>

<br/>
</div>

<div class="doc">
We prove that codes respect glue as a chain of equivalences between types built from pushouts and double-pushouts.  The first step is to add the data of our hypothesized-to-be-connected type inside <span class="inlinecode"><span class="id" title="var">codeleft2</span></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeleft2plus</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">yqqu</span> : <span class="id" title="var">codeleft2</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Join</span> ((<span class="id" title="var">x0</span>; <span class="id" title="var">codeleft2_q00</span> <span class="id" title="var">yqqu</span>) = (<span class="id" title="var">x1</span>; <span class="id" title="var">codeleft2_q10</span> <span class="id" title="var">yqqu</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&gt; {<span class="id" title="var">x</span>:<span class="id" title="var">X</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> (<span class="id" title="var">codeleft2_y0</span> <span class="id" title="var">yqqu</span>)})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">codeleft2_y0</span> <span class="id" title="var">yqqu</span>; <span class="id" title="var">codeleft2_q10</span> <span class="id" title="var">yqqu</span>) = (<span class="id" title="var">y1</span>; <span class="id" title="var">q11</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&gt; {<span class="id" title="var">y</span>:<span class="id" title="var">Y</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">y</span>})}.<br/>

<br/>
</div>

<div class="doc">
Since this connected type is itself a join, hence a pushout, the second step is to distribute this and reexpress the whole thing as another pushout of iterated Sigma-types (again mostly expressed as records for performance reasons). 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">Ocodeleft2b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">Ocodeleft2b_s</span>   : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2b_y0</span>  : <span class="id" title="var">Y</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2b_q00</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">Ocodeleft2b_y0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2b_q10</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">Ocodeleft2b_y0</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2b_w</span>   : <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">Ocodeleft2b_y0</span>) <span class="id" title="var">Ocodeleft2b_s</span> <span class="id" title="var">Ocodeleft2b_q00</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">Ocodeleft2b_q10</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2b_u</span>   : <span class="id" title="var">glue</span> <span class="id" title="var">Ocodeleft2b_q00</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">Ocodeleft2b_q10</span>)^ = <span class="id" title="var">r</span> }.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft2c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">q01</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y1</span> &amp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;u:&nbsp;*)</span> <span class="id" title="var">glue</span> <span class="id" title="var">q01</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^ = <span class="id" title="var">r</span> }.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">Ocodeleft2a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= { <span class="id" title="var">Ocodeleft2a_s</span>   : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2a_q01</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y1</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2a_w</span>   : <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y1</span>) <span class="id" title="var">Ocodeleft2a_s</span> <span class="id" title="var">Ocodeleft2a_q01</span> = <span class="id" title="var">q11</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2a_u</span>   : <span class="id" title="var">glue</span> <span class="id" title="var">Ocodeleft2a_q01</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^ = <span class="id" title="var">r</span> }.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft2ab</span> : <span class="id" title="var">Ocodeleft2a</span> -&gt; <span class="id" title="var">Ocodeleft2b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">s</span> <span class="id" title="var">q01</span> <span class="id" title="var">w</span> <span class="id" title="var">u</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">Build_Ocodeleft2b</span> <span class="id" title="var">s</span> <span class="id" title="var">y1</span> <span class="id" title="var">q01</span> <span class="id" title="var">q11</span> <span class="id" title="var">w</span> <span class="id" title="var">u</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft2ac</span> : <span class="id" title="var">Ocodeleft2a</span> -&gt; <span class="id" title="var">Ocodeleft2c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">s</span> <span class="id" title="var">q01</span> <span class="id" title="var">w</span> <span class="id" title="var">u</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">q01</span>;<span class="id" title="var">u</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
This proof is basically just rearranging Sigma-types/records and paths in Sigma-types and contracting based path spaces. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_Ocodeleft2plus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Pushout</span> <span class="id" title="var">Ocodeleft2ab</span> <span class="id" title="var">Ocodeleft2ac</span> &lt;~&gt; <span class="id" title="var">codeleft2plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">equiv_sigma_pushout</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1 <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srefine</span> (<span class="id" title="var">equiv_pushout</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">srefine</span> (<span class="id" title="var">equiv_functor_sigma_id</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id" title="tactic">intro</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_functor_prod'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv_contr_basedpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">srefine</span> (<span class="id" title="var">equiv_functor_sigma_id</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id" title="tactic">intro</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">srefine</span> (<span class="id" title="var">equiv_functor_sigma_id</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id" title="tactic">intro</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv_contr_basedpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Now we combine this equivalence with the insertion of our connected type. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_Ocodeleft2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> <span class="id" title="var">Ocodeleft2ab</span> <span class="id" title="var">Ocodeleft2ac</span>) &lt;~&gt; <span class="id" title="var">O</span> <span class="id" title="var">codeleft2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">equiv_O_functor</span> <span class="id" title="var">O</span> (<span class="id" title="var">equiv_sigma_contr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">yqqu</span> : <span class="id" title="var">codeleft2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O</span> (<span class="id" title="var">Join</span> ((<span class="id" title="var">x0</span>; <span class="id" title="var">codeleft2_q00</span> <span class="id" title="var">yqqu</span>) = (<span class="id" title="var">x1</span>; <span class="id" title="var">codeleft2_q10</span> <span class="id" title="var">yqqu</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">codeleft2_y0</span> <span class="id" title="var">yqqu</span> ; <span class="id" title="var">codeleft2_q10</span> <span class="id" title="var">yqqu</span>) = (<span class="id" title="var">y1</span>; <span class="id" title="var">q11</span>)))))) <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">equiv_O_sigma_O</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span>)^-1 <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_O_functor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_Ocodeleft2plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The next step is to reassociate the resulting double-pushout and "contract" both of them, one after the other, because they are pushouts along equivalences.  In order to do this, we need first of all to know that the resulting map from <span class="inlinecode"><span class="id" title="var">codeleft0</span></span> to the above pushout factors through <span class="inlinecode"><span class="id" title="var">Ocodeleft2b</span></span> via an equivalence.  Here's the equivalence: 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft02b</span> : <span class="id" title="var">codeleft0</span> &lt;~&gt; <span class="id" title="var">Ocodeleft2b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv_contr_basedpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft02</span> (<span class="id" title="var">c</span> : <span class="id" title="var">codeleft0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Pushout</span> <span class="id" title="var">Ocodeleft2ab</span> <span class="id" title="var">Ocodeleft2ac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">pushl'</span> <span class="id" title="var">Ocodeleft2ab</span> <span class="id" title="var">Ocodeleft2ac</span> (<span class="id" title="var">Ocodeleft02b</span> <span class="id" title="var">c</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft02plus_02b</span> (<span class="id" title="var">c</span> : <span class="id" title="var">codeleft0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">equiv_Ocodeleft2plus</span> (<span class="id" title="var">Ocodeleft02</span> <span class="id" title="var">c</span>)).1 = <span class="id" title="var">codeleft02</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
And here we show that this equivalence is indeed a factor of the relevant map in the original pushout. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft02_02b</span> (<span class="id" title="var">c</span> : <span class="id" title="var">codeleft0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">equiv_Ocodeleft2</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">Ocodeleft02</span> <span class="id" title="var">c</span>)) = <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">codeleft02</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv_Ocodeleft2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Opaque</span> <span class="id" title="var">equiv_Ocodeleft2plus</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">Ocodeleft02plus_02b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Thus, our pushout in which one vertex is itself a pushout can be written as a "double pushout"

<div class="paragraph"> </div>

<span class="inlinecode"><span class="id" title="var">codeleft1</span></span> &lt;- <span class="inlinecode"><span class="id" title="var">codeleft0</span></span> -&gt; <span class="inlinecode"><span class="id" title="var">codeleft2b</span></span> &lt;- <span class="inlinecode"><span class="id" title="var">codeleft2a</span></span> -&gt; <span class="inlinecode"><span class="id" title="var">codeleft2c</span></span>.

<div class="paragraph"> </div>

Since the map <span class="inlinecode"><span class="id" title="var">codeleft0</span></span> -&gt; <span class="inlinecode"><span class="id" title="var">codeleft2b</span></span> is an equivalence, the pushout of the left-hand span is equivalent to <span class="inlinecode"><span class="id" title="var">codeleft1</span></span>, and thus the whole thing is equivalent to a pushout

<div class="paragraph"> </div>

<span class="inlinecode"><span class="id" title="var">codeleft1</span></span> &lt;- <span class="inlinecode"><span class="id" title="var">codeleft2a</span></span> -&gt; <span class="inlinecode"><span class="id" title="var">codeleft2c</span></span>

<div class="paragraph"> </div>

Now we claim that the left-hand map of this span is also an equivalence.  Rather than showing this directly, it seems to be much easier to first construct *an* equivalence from <span class="inlinecode"><span class="id" title="var">codeleft2a</span></span> to <span class="inlinecode"><span class="id" title="var">codeleft1</span></span> and then show that it is equal (as a function) to the induced one.  Here's the equivalence: 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft2a1</span> : <span class="id" title="var">Ocodeleft2a</span> &lt;~&gt; <span class="id" title="var">codeleft1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etransitivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:{ <span class="id" title="var">rapply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span>.<br/>
</div>

<div class="doc">
Here's frobnicate showing up again! 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">frobnicate</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
And now we check that the two are equal.  Because we used the same proof of <span class="inlinecode"><span class="id" title="var">frobnicate</span></span> in two places, this equality becomes definitional after simply decomposing up a Sigma-type! 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ocodeleft2a1_through_2b0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Ocodeleft2a1</span> == <span class="id" title="var">codeleft01</span> <span class="id" title="var">o</span> <span class="id" title="var">Ocodeleft02b</span>^-1 <span class="id" title="var">o</span> <span class="id" title="var">Ocodeleft2ab</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Now we're finally ready to prove the glue equivalence.  Since later on we'll have to compute its action on inputs from <span class="inlinecode"><span class="id" title="var">codeleft1</span></span>, we decompose it into seven steps, each of which with a corresponding computation lemma.  (These lemmas seem to be much easier to prove step-by-step than all at once if we proved the whole equivalence in a big shebang.) 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeleft</span> &lt;~&gt; <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft01</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft02</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_O_pushout</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue1_pushl</span> (<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue1</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>))) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">s</span>; <span class="id" title="var">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_O_pushout_to_O_pushl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft01</span>) (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft02</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft01</span>) (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">Ocodeleft02</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srefine</span> (<span class="id" title="var">equiv_O_functor</span> <span class="id" title="var">O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">equiv_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">equiv_pushout</span> (<span class="id" title="var">f</span> := <span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft01</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span> := <span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">Ocodeleft02</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1%<span class="id" title="var">equiv</span> 1%<span class="id" title="var">equiv</span> <span class="id" title="var">equiv_Ocodeleft2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">O_indpaths</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">to_O_natural</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Ocodeleft02_02b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue2_pushl</span> (<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue2</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">to_O_equiv_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">codeleft01</span>) (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">Ocodeleft02</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">Ocodeleft02</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_inverse</span> (<span class="id" title="var">equiv_O_pushout</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue3_pushl</span> (<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue3</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">inverse_equiv_O_pushout_to_O_pushl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue4</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">Ocodeleft02</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">Ocodeleft2a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pushr'</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">Ocodeleft02b</span> (<span class="id" title="var">Ocodeleft2ab</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2ac</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_O_functor</span> <span class="id" title="var">O</span> (<span class="id" title="var">equiv_inverse</span> (<span class="id" title="var">equiv_pushout_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue4_pushl</span> (<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue4</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">to_O_equiv_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue5</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">Ocodeleft2a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pushr'</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">Ocodeleft02b</span> (<span class="id" title="var">Ocodeleft2ab</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ocodeleft2ac</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> <span class="id" title="var">Ocodeleft2a1</span> <span class="id" title="var">Ocodeleft2ac</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srefine</span> (<span class="id" title="var">equiv_O_functor</span> <span class="id" title="var">O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">equiv_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">equiv_pushout</span> (<span class="id" title="var">f</span> := <span class="id" title="var">Ocodeleft2a1</span>) (<span class="id" title="var">g</span> := <span class="id" title="var">Ocodeleft2ac</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1%<span class="id" title="var">equiv</span> <span class="id" title="var">_</span> 1%<span class="id" title="var">equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl'</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">Ocodeleft02b</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> (<span class="id" title="var">Ocodeleft2a1_through_2b0</span> <span class="id" title="var">x</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pglue'</span> <span class="id" title="var">codeleft01</span> <span class="id" title="var">Ocodeleft02b</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">eisretr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue5_pushl</span> (<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue5</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">to_O_equiv_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue6</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pushout</span> <span class="id" title="var">Ocodeleft2a1</span> <span class="id" title="var">Ocodeleft2ac</span>) &lt;~&gt; <span class="id" title="var">O</span> <span class="id" title="var">Ocodeleft2c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_O_functor</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O</span> (<span class="id" title="var">equiv_inverse</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushr'</span> <span class="id" title="var">Ocodeleft2a1</span> <span class="id" title="var">Ocodeleft2ac</span>) <span class="id" title="var">_</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue6_pushl</span> (<span class="id" title="var">s</span> : <span class="id" title="var">x0</span> = <span class="id" title="var">x1</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">ap</span> <span class="id" title="tactic">left</span> <span class="id" title="var">s</span> = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue6</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">pushl</span> (<span class="id" title="var">s</span>;<span class="id" title="var">v</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="keyword">let</span> <span class="id" title="var">z</span> := (<span class="id" title="var">frobnicate</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span> <span class="id" title="var">y1</span> <span class="id" title="var">q11</span>)^-1 <span class="id" title="var">v</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">Ocodeleft2c</span> (<span class="id" title="var">Ocodeleft2ac</span> (<span class="id" title="var">Build_Ocodeleft2a</span> <span class="id" title="var">s</span> <span class="id" title="var">z</span>.1 <span class="id" title="var">z</span>.2.1 <span class="id" title="var">z</span>.2.2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">to_O_equiv_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue7</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> <span class="id" title="var">Ocodeleft2c</span> &lt;~&gt; <span class="id" title="var">coderight</span> (<span class="id" title="var">r</span> @ <span class="id" title="var">glue</span> <span class="id" title="var">q11</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">coderight</span>, <span class="id" title="var">Ocodeleft2c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_O_functor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">q01</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_moveL_pM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue7_to_O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">q01</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y1</span>) (<span class="id" title="var">u</span> : <span class="id" title="var">glue</span> <span class="id" title="var">q01</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^ = <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeglue7</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">q01</span>;<span class="id" title="var">u</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">to</span> <span class="id" title="var">O</span> (<span class="id" title="var">hfiber</span> <span class="id" title="var">glue</span> (<span class="id" title="var">r</span> @ <span class="id" title="var">glue</span> <span class="id" title="var">q11</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">q01</span> ; <span class="id" title="var">moveL_pM</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>) (<span class="id" title="var">glue</span> <span class="id" title="var">q01</span>) <span class="id" title="var">r</span> <span class="id" title="var">u</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">to_O_equiv_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">codeglue</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">codeleft</span> &lt;~&gt; <span class="id" title="var">coderight</span> (<span class="id" title="var">r</span> @ <span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">codeglue7</span> <span class="id" title="var">oE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue6</span> <span class="id" title="var">oE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue5</span> <span class="id" title="var">oE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue4</span> <span class="id" title="var">oE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue3</span> <span class="id" title="var">oE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue2</span> <span class="id" title="var">oE</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue1</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">CodeGlue</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">CodeLeft</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1107"></a><h3 class="section">Completion of codes</h3>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<span class="id" title="var">Univalence</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">x0</span> : <span class="id" title="var">X</span>).<br/>

<br/>
</div>

<div class="doc">
The equivalence <span class="inlinecode"><span class="id" title="var">codeglue</span></span> requires a bit of massaging to put it into the form needed by the actual definition of <span class="inlinecode"><span class="id" title="var">code</span></span> from pushout-induction and univalence. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">ap_code_glue</span> (<span class="id" title="var">x1</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">y1</span> : <span class="id" title="var">Y</span>) (<span class="id" title="var">q11</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">y1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> : <span class="id" title="var">SPushout</span> <span class="id" title="var">Q</span> =&gt; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>) <span class="id" title="var">codeleft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">coderight</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_arrow</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">transport_arrow_toconst</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_universe_uncurried</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_transport</span> <span class="id" title="var">codeleft</span> (<span class="id" title="var">transport_paths_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">codeglue</span> <span class="id" title="var">_</span> <span class="id" title="var">q11</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_transport</span> <span class="id" title="var">coderight</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_pV_p</span> <span class="id" title="var">z</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Here's the final definition of <span class="inlinecode"><span class="id" title="var">code</span></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">code</span> (<span class="id" title="var">p</span> : <span class="id" title="var">P</span>) (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span>) : <span class="id" title="keyword">Type</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">SPushout_ind</span> <span class="id" title="var">Q</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">codeleft</span> <span class="id" title="var">x0</span>) (@<span class="id" title="var">coderight</span> <span class="id" title="var">x0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ap_code_glue</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span>.<br/>

<br/>
</div>

<div class="doc">
When we compute with <span class="inlinecode"><span class="id" title="var">code</span></span>, we'll need to extract from it the actual behavior of the function <span class="inlinecode"><span class="id" title="var">codeglue</span></span>.  Here's the mess of path algebra that we "naturally" get out when we try to do that; later we'll see how to deal with it. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">code_beta_glue</span> (<span class="id" title="var">x1</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">y1</span> : <span class="id" title="var">Y</span>) (<span class="id" title="var">q11</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x1</span> <span class="id" title="var">y1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="tactic">right</span> <span class="id" title="var">y1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">ap10</span> (<span class="id" title="var">apD</span> <span class="id" title="var">code</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)) <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">transport_arrow_toconst</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>) <span class="id" title="var">codeleft</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">path_universe_uncurried</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> <span class="id" title="var">coderight</span> ((<span class="id" title="var">r</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^) @ <span class="id" title="var">glue</span> <span class="id" title="var">q11</span>) <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">concat_pV_p</span> <span class="id" title="var">r</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> (<span class="id" title="var">codeglue</span> (<span class="id" title="var">r</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^) <span class="id" title="var">q11</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> @<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> <span class="id" title="var">codeleft</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> : <span class="id" title="var">SPushout</span> <span class="id" title="var">Q</span> =&gt; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^ <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^) (<span class="id" title="var">transport_paths_r</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q11</span>)^ <span class="id" title="var">r</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">ap10</span> <span class="id" title="var">h</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">spushout_ind_beta_sglue</span> <span class="id" title="var">Q</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">codeleft</span> <span class="id" title="var">x0</span>) (@<span class="id" title="var">coderight</span> <span class="id" title="var">x0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ap_code_glue</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x1</span> <span class="id" title="var">y1</span> <span class="id" title="var">q11</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap10_path_arrow</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1108"></a><h2 class="section">Contractibility of codes</h2>

<div class="paragraph"> </div>

 To construct a center for every type of codes, we construct one in an easy case and transport it around. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">center_code1</span> : <span class="id" title="var">code</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">x0</span>) 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">codeleft</span> (<span class="id" title="var">idpath</span> (<span class="id" title="tactic">left</span> <span class="id" title="var">x0</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">codeleft</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">to</span>, <span class="id" title="var">pushl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">codeleft1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">idpath</span>; <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">center_code</span> (<span class="id" title="var">p</span> : <span class="id" title="var">P</span>) (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span>) : <span class="id" title="var">code</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">pr</span> : {<span class="id" title="var">p</span> : <span class="id" title="var">P</span> &amp; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span>}) =&gt; <span class="id" title="var">code</span> <span class="id" title="var">pr</span>.1 <span class="id" title="var">pr</span>.2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">path_contr</span> (<span class="id" title="var">A</span> := {<span class="id" title="var">p</span> : <span class="id" title="var">P</span> &amp; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">left</span> <span class="id" title="var">x0</span>; <span class="id" title="var">idpath</span>) (<span class="id" title="var">p</span>;<span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">center_code1</span>.<br/>

<br/>
</div>

<div class="doc">
As in HFLL, we first construct a contraction in the "partially general" case of an arbitrary path from left to right. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">contraction_code_right</span> (<span class="id" title="var">y1</span> : <span class="id" title="var">Y</span>) (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="tactic">right</span> <span class="id" title="var">y1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">c</span> : <span class="id" title="var">code</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">y1</span>) <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">center_code</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">y1</span>) <span class="id" title="var">r</span> = <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">coderight</span> <span class="id" title="var">r</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">coderight</span> <span class="id" title="tactic">in</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">O_indpaths</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">intros</span> [<span class="id" title="var">q01</span> <span class="id" title="var">t</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">center_code</span>, <span class="id" title="var">center_code1</span>.<br/>
</div>

<div class="doc">
Here's how we use the apparently-unmanageable <span class="inlinecode"><span class="id" title="var">code_beta_glue</span></span>.  First we destruct the path <span class="inlinecode"><span class="id" title="var">t</span></span> to make things simpler. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span>.<br/>
</div>

<div class="doc">
Then we notice that if we tried rewriting with <span class="inlinecode"><span class="id" title="var">code_beta_glue</span></span> here, the unmanageable-looking result is actually fully general over the path <span class="inlinecode"><span class="id" title="var">glue</span></span> <span class="inlinecode"><span class="id" title="var">q01</span></span>, so we can prove by path induction that it equals the nicer expression we'd like to see.  This is the purpose of the lemma <span class="inlinecode"><span class="id" title="var">transport_singleton</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_singleton</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q01</span>) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; @<span class="id" title="var">codeglue</span> <span class="id" title="var">x0</span> <span class="id" title="var">x0</span> <span class="id" title="var">r</span> <span class="id" title="var">y1</span> <span class="id" title="var">q01</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">code_beta_glue</span> <span class="id" title="var">x0</span> <span class="id" title="var">y1</span> <span class="id" title="var">q01</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q01</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">codeglue</span>.<br/>
</div>

<div class="doc">
Now we evaluate <span class="inlinecode"><span class="id" title="var">codeglue</span></span> step by step using our lemmas. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 6 <span class="id" title="var">change_apply_equiv_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">codeglue1_pushl</span>, <span class="id" title="var">codeglue2_pushl</span>, <span class="id" title="var">codeglue3_pushl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeglue4_pushl</span>, <span class="id" title="var">codeglue5_pushl</span>, <span class="id" title="var">codeglue6_pushl</span>, <span class="id" title="var">codeglue7_to_O</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">ap_transport</span> (<span class="id" title="var">concat_1p</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q01</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">to</span> <span class="id" title="var">O</span> (<span class="id" title="var">hfiber</span> <span class="id" title="var">glue</span> <span class="id" title="var">r</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">hfiber</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_sigma'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_paths_r</span>.<br/>
</div>

<div class="doc">
Finally, we have another terrible-looking thing involving <span class="inlinecode"><span class="id" title="var">frobnicate</span></span>.  However, there are enough identity paths that <span class="inlinecode"><span class="id" title="var">frobnicate</span></span> evaluates to... something that's almost fully path-general!  So with just a little bit of further work, we can reduce it also to something we can prove with path-induction. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Transparent</span> <span class="id" title="var">frobnicate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Opaque</span> <span class="id" title="var">frobnicate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">transport_compose</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> =&gt; <span class="id" title="var">glue</span> <span class="id" title="var">q</span> @ (<span class="id" title="var">glue</span> <span class="id" title="var">q01</span>)^ = 1%<span class="id" title="var">path</span>) <span class="id" title="var">pr1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">path_sigma'</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_V</span>, <span class="id" title="var">ap_pr1_path_sigma</span>, <span class="id" title="var">transport_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">glue</span> <span class="id" title="var">q01</span>); <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
It should be possible to prove an analogous <span class="inlinecode"><span class="id" title="var">contraction_code_left</span></span> directly, but for now we follow HFLL and ABFJ by introducing a surjectivity assumption. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">contraction_code</span> {<span class="id" title="var">y0</span> : <span class="id" title="var">Y</span>} (<span class="id" title="var">q00</span> : <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y0</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pr</span> : { <span class="id" title="var">p</span> : <span class="id" title="var">P</span> &amp; <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span> }) (<span class="id" title="var">c</span> : <span class="id" title="var">code</span> <span class="id" title="var">pr</span>.1 <span class="id" title="var">pr</span>.2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">center_code</span> <span class="id" title="var">pr</span>.1 <span class="id" title="var">pr</span>.2 = <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srefine</span> (<span class="id" title="var">transport</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">pr'</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span>, <span class="id" title="var">center_code</span> <span class="id" title="var">pr'</span>.1 <span class="id" title="var">pr'</span>.2 = <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">path_contr</span> (<span class="id" title="tactic">right</span> <span class="id" title="var">y0</span> ; <span class="id" title="var">glue</span> <span class="id" title="var">q00</span>) <span class="id" title="var">pr</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">pr</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">contraction_code_right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">contr_code_inhab</span> (<span class="id" title="var">inh</span> : <span class="id" title="var">merely</span> { <span class="id" title="var">y0</span> : <span class="id" title="var">Y</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x0</span> <span class="id" title="var">y0</span> })<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">P</span>) (<span class="id" title="var">r</span> : <span class="id" title="tactic">left</span> <span class="id" title="var">x0</span> = <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Contr</span> (<span class="id" title="var">code</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">strip_truncations</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">inh</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">y0</span> <span class="id" title="var">q00</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">Build_Contr</span> <span class="id" title="var">_</span> (<span class="id" title="var">center_code</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span>) (<span class="id" title="var">contraction_code</span> <span class="id" title="var">q00</span> (<span class="id" title="var">p</span>;<span class="id" title="var">r</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
This version is sufficient for the classical Blakers-Massey theorem, as we'll see below, since its leg-wise connectivity hypothesis implies the above surjectivity assumption.  ABFJ have a different method for eliminating the surjectivity assumption using a lemma about pushouts of monos also being pullbacks, though it seems to only work for coderight. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">GBM</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1109"></a><h2 class="section">The classical Blakers-Massey Theorem</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">blakers_massey</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">m</span> <span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">Q</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">IsConnected</span> <span class="id" title="var">m</span>.+1 { <span class="id" title="var">x</span> : <span class="id" title="var">X</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">IsConnected</span> <span class="id" title="var">n</span>.+1 { <span class="id" title="var">y</span> : <span class="id" title="var">Y</span> &amp; <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> (<span class="id" title="var">m</span> +2+ <span class="id" title="var">n</span>) (@<span class="id" title="var">spglue</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Q</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">contr_code_inhab</span> <span class="id" title="var">Q</span> (<span class="id" title="var">m</span> +2+ <span class="id" title="var">n</span>) <span class="id" title="var">_</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merely_isconnected</span> <span class="id" title="var">n</span> <span class="id" title="var">_</span>) (<span class="id" title="var">spushr</span> <span class="id" title="var">Q</span> <span class="id" title="var">y</span>) <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">isconnected_join</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>