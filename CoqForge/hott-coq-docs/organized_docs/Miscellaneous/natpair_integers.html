<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>natpair_integers</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library natpair_integers</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.HIT.quotient</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Universes.TruncType</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.implementations.peano_naturals</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.abstract_algebra</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.orders</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.interfaces.integers</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.rings</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.groups</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.apartness</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.orders.sum</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.orders.rings</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.tactics.ring_tac</span><br/>
&nbsp;&nbsp;<span class="id" title="var">HoTT.Classes.theory.naturals</span>.<br/>

<br/>
<span class="id" title="keyword">Generalizable Variables</span> <span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ring_quote.Quoting.Instances</span>.<br/>
<span class="id" title="keyword">Local</span> <span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Minimization</span> <span class="id" title="var">ToSet</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">NatPair</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">PairT</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">T</span> (<span class="id" title="var">N</span> : <span class="id" title="keyword">Type</span>) := <span class="id" title="var">C</span> { <span class="id" title="var">pos</span> : <span class="id" title="var">N</span> ; <span class="id" title="var">neg</span> : <span class="id" title="var">N</span> }.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">C</span> {<span class="id" title="var">N</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">pos</span> {<span class="id" title="var">N</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">neg</span> {<span class="id" title="var">N</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">contents</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>.<br/>
<span class="id" title="keyword">Context</span> (<span class="id" title="var">N</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">UN</span>}) `{<span class="id" title="var">Naturals@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">N</span>}.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">T_set</span> : <span class="id" title="var">IsHSet</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">E</span> : <span class="id" title="var">sig</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> : <span class="id" title="var">N</span> =&gt; <span class="id" title="var">N</span>) &lt;~&gt; (<span class="id" title="var">T</span> <span class="id" title="var">N</span>)).<br/>
- <span class="id" title="var">issig</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">istrunc_equiv_istrunc</span> <span class="id" title="var">_</span> <span class="id" title="var">E</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">inject</span> : <span class="id" title="var">Cast</span> <span class="id" title="var">N</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">C</span> <span class="id" title="var">x</span> 0.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">pos</span> <span class="id" title="var">x</span> + <span class="id" title="var">neg</span> <span class="id" title="var">y</span> = <span class="id" title="var">pos</span> <span class="id" title="var">y</span> + <span class="id" title="var">neg</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">equiv_is_equiv_rel@</span>{} : <span class="id" title="var">EquivRel</span> <span class="id" title="var">equiv</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ??;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> (+) (<span class="id" title="var">neg</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_assoc</span> (<span class="id" title="var">neg</span> <span class="id" title="var">b</span>) (<span class="id" title="var">pos</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">b</span>) (<span class="id" title="var">pos</span> <span class="id" title="var">a</span>)), <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">pos</span> <span class="id" title="var">b</span>)). <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">plus_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E2</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">pos</span> <span class="id" title="var">c</span>) (<span class="id" title="var">neg</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">pl</span> : <span class="id" title="var">Plus</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">C</span> (<span class="id" title="var">pos</span> <span class="id" title="var">x</span> + <span class="id" title="var">pos</span> <span class="id" title="var">y</span>) (<span class="id" title="var">neg</span> <span class="id" title="var">x</span> + <span class="id" title="var">neg</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">ml</span> : <span class="id" title="var">Mult</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">C</span> (<span class="id" title="var">pos</span> <span class="id" title="var">x</span> * <span class="id" title="var">pos</span> <span class="id" title="var">y</span> + <span class="id" title="var">neg</span> <span class="id" title="var">x</span> * <span class="id" title="var">neg</span> <span class="id" title="var">y</span>) (<span class="id" title="var">pos</span> <span class="id" title="var">x</span> * <span class="id" title="var">neg</span> <span class="id" title="var">y</span> + <span class="id" title="var">neg</span> <span class="id" title="var">x</span> * <span class="id" title="var">pos</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">opp</span> : <span class="id" title="var">Negate</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">C</span> (<span class="id" title="var">neg</span> <span class="id" title="var">x</span>) (<span class="id" title="var">pos</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">SR0</span> : <span class="id" title="var">Zero</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) := <span class="id" title="var">C</span> 0 0.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">SR1</span> : <span class="id" title="var">One</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) := <span class="id" title="var">C</span> 1 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">pl_respects</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv</span> (<span class="id" title="var">q1</span> + <span class="id" title="var">r1</span>) (<span class="id" title="var">q2</span> + <span class="id" title="var">r2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">Eq</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="var">Er</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_assoc</span> <span class="id" title="var">_</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q2</span>)).<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_assoc</span> (<span class="id" title="var">pos</span> <span class="id" title="var">q1</span>)).<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">pos</span> <span class="id" title="var">r1</span>)).<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_assoc</span> (<span class="id" title="var">pos</span> <span class="id" title="var">q1</span>)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eq</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_assoc</span> <span class="id" title="var">_</span> (<span class="id" title="var">pos</span> <span class="id" title="var">r1</span>)). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Er</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_assoc</span> (<span class="id" title="var">pos</span> <span class="id" title="var">q2</span>)).<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span>)). <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">plus_assoc</span>.<br/>
<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ml_respects</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv</span> (<span class="id" title="var">q1</span> * <span class="id" title="var">r1</span>) (<span class="id" title="var">q2</span> * <span class="id" title="var">r2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">Eq</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="var">Er</span>. <span class="id" title="tactic">transitivity</span> (<span class="id" title="var">q1</span> * <span class="id" title="var">r2</span>);<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span> <span class="id" title="tactic">in</span> *;<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">transitivity</span> (<span class="id" title="var">pos</span> <span class="id" title="var">q1</span> * (<span class="id" title="var">pos</span> <span class="id" title="var">r1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">r2</span>) + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> * (<span class="id" title="var">neg</span> <span class="id" title="var">r1</span> + <span class="id" title="var">pos</span> <span class="id" title="var">r2</span>)).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_mult_distr_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-2!<span class="id" title="var">plus_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span> * <span class="id" title="var">neg</span> <span class="id" title="var">r1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Er</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_mult_distr_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">r1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Er</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_mult_distr_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-2!<span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span> * <span class="id" title="var">pos</span> <span class="id" title="var">r1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">pos</span> <span class="id" title="var">q1</span> * <span class="id" title="var">neg</span> <span class="id" title="var">r1</span>)). <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">transitivity</span> ((<span class="id" title="var">pos</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span>) * <span class="id" title="var">pos</span> <span class="id" title="var">r2</span> + (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span> + <span class="id" title="var">pos</span> <span class="id" title="var">q2</span>) * <span class="id" title="var">neg</span> <span class="id" title="var">r2</span>).<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_mult_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-2!<span class="id" title="var">plus_assoc</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">pos</span> <span class="id" title="var">q2</span> * <span class="id" title="var">neg</span> <span class="id" title="var">r2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span> * <span class="id" title="var">neg</span> <span class="id" title="var">r2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eq</span>,<span class="id" title="var">plus_mult_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span>)),&lt;-<span class="id" title="var">Eq</span>,<span class="id" title="var">plus_mult_distr_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-2!<span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>,(<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span> * <span class="id" title="var">pos</span> <span class="id" title="var">r2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_comm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">opp_respects</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="var">equiv</span> (<span class="id" title="var">opp</span> <span class="id" title="var">q1</span>) (<span class="id" title="var">opp</span> <span class="id" title="var">q2</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">plus_comm</span> (<span class="id" title="var">neg</span> <span class="id" title="var">_</span>)). <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Tle</span> : <span class="id" title="var">Le</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">pos</span> <span class="id" title="var">a</span> + <span class="id" title="var">neg</span> <span class="id" title="var">b</span> &lt;= <span class="id" title="var">pos</span> <span class="id" title="var">b</span> + <span class="id" title="var">neg</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Tlt</span> : <span class="id" title="var">Lt</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">pos</span> <span class="id" title="var">a</span> + <span class="id" title="var">neg</span> <span class="id" title="var">b</span> &lt; <span class="id" title="var">pos</span> <span class="id" title="var">b</span> + <span class="id" title="var">neg</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Tapart</span> : <span class="id" title="var">Apart</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> =&gt; <span class="id" title="var">apart</span> (<span class="id" title="var">pos</span> <span class="id" title="var">a</span> + <span class="id" title="var">neg</span> <span class="id" title="var">b</span>) (<span class="id" title="var">pos</span> <span class="id" title="var">b</span> + <span class="id" title="var">neg</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Tle_hprop@</span>{}<br/>
&nbsp;&nbsp;: <span class="id" title="var">is_mere_relation</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) <span class="id" title="var">Tle</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Tle</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">full_pseudo_srorder_le_hprop</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Tlt_hprop@</span>{}<br/>
&nbsp;&nbsp;: <span class="id" title="var">is_mere_relation</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) <span class="id" title="var">Tlt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Tlt</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Existing Instance</span> <span class="id" title="var">pseudo_order_apart</span>.<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Tapart_hprop@</span>{} : <span class="id" title="var">is_mere_relation</span> (<span class="id" title="var">T</span> <span class="id" title="var">N</span>) <span class="id" title="var">Tapart</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Tapart</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_respects_aux@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Tle</span> <span class="id" title="var">q1</span> <span class="id" title="var">r1</span> -&gt; <span class="id" title="var">Tle</span> <span class="id" title="var">q2</span> <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>,<span class="id" title="var">Tle</span>;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] <span class="id" title="var">Eq</span> [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>] [<span class="id" title="var">pd</span> <span class="id" title="var">nd</span>] <span class="id" title="var">Er</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_reflecting</span> (+ (<span class="id" title="var">pc</span> + <span class="id" title="var">na</span>))).<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Erw</span> : <span class="id" title="var">pb</span> + <span class="id" title="var">nd</span> + (<span class="id" title="var">pc</span> + <span class="id" title="var">na</span>)<br/>
&nbsp;&nbsp;= (<span class="id" title="var">pb</span> + <span class="id" title="var">na</span>) + (<span class="id" title="var">pc</span> + <span class="id" title="var">nd</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Erw</span>,&lt;-<span class="id" title="var">Eq</span>,<span class="id" title="var">Er</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Erw</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Erw</span> : <span class="id" title="var">pa</span> + <span class="id" title="var">nb</span> + (<span class="id" title="var">pd</span> + <span class="id" title="var">nc</span>) = <span class="id" title="var">pd</span> + <span class="id" title="var">nb</span> + (<span class="id" title="var">pa</span> + <span class="id" title="var">nc</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Erw</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> <span class="id" title="var">_</span>), <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_respects@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Tle</span> <span class="id" title="var">q1</span> <span class="id" title="var">r1</span> &lt;~&gt; <span class="id" title="var">Tle</span> <span class="id" title="var">q2</span> <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_iff_hprop_uncurried</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_respects_aux</span>;<br/>
<span class="id" title="tactic">trivial</span>;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_respects_aux@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Tlt</span> <span class="id" title="var">q1</span> <span class="id" title="var">r1</span> -&gt; <span class="id" title="var">Tlt</span> <span class="id" title="var">q2</span> <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>,<span class="id" title="var">Tlt</span>;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] <span class="id" title="var">Eq</span> [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>] [<span class="id" title="var">pd</span> <span class="id" title="var">nd</span>] <span class="id" title="var">Er</span> <span class="id" title="var">E</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_reflecting</span> (+ (<span class="id" title="var">pc</span> + <span class="id" title="var">na</span>))).<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Erw</span> : <span class="id" title="var">pb</span> + <span class="id" title="var">nd</span> + (<span class="id" title="var">pc</span> + <span class="id" title="var">na</span>)<br/>
&nbsp;&nbsp;= (<span class="id" title="var">pb</span> + <span class="id" title="var">na</span>) + (<span class="id" title="var">pc</span> + <span class="id" title="var">nd</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Erw</span>,&lt;-<span class="id" title="var">Eq</span>,<span class="id" title="var">Er</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Erw</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Erw</span> : <span class="id" title="var">pa</span> + <span class="id" title="var">nb</span> + (<span class="id" title="var">pd</span> + <span class="id" title="var">nc</span>) = <span class="id" title="var">pd</span> + <span class="id" title="var">nb</span> + (<span class="id" title="var">pa</span> + <span class="id" title="var">nc</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Erw</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_preserving</span> <span class="id" title="var">_</span>), <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_respects@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Tlt</span> <span class="id" title="var">q1</span> <span class="id" title="var">r1</span> &lt;~&gt; <span class="id" title="var">Tlt</span> <span class="id" title="var">q2</span> <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_iff_hprop_uncurried</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_respects_aux</span>;<br/>
<span class="id" title="tactic">trivial</span>;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">apart_cotrans@</span>{} : <span class="id" title="var">CoTransitive</span> <span class="id" title="var">Tapart</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Tapart</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">Eq</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_left_cancellation</span> (+) (<span class="id" title="var">neg</span> <span class="id" title="var">r</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">Eq</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">cotransitive</span> <span class="id" title="var">Eq</span> (<span class="id" title="var">pos</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span>)));<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
- <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (+ (<span class="id" title="var">neg</span> <span class="id" title="var">q2</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pos</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">neg</span> <span class="id" title="var">r</span> + (<span class="id" title="var">pos</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (+ (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pos</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> = <span class="id" title="var">pos</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pos</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> = <span class="id" title="var">neg</span> <span class="id" title="var">r</span> + (<span class="id" title="var">pos</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Existing Instance</span> <span class="id" title="var">apart_cotrans</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> : <span class="id" title="var">Symmetric</span> <span class="id" title="var">Tapart</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Tapart</span>.<br/>
<span class="id" title="tactic">intros</span> ??;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">apart_respects_aux@</span>{}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Tapart</span> <span class="id" title="var">q1</span> <span class="id" title="var">r1</span> -&gt; <span class="id" title="var">Tapart</span> <span class="id" title="var">q2</span> <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r</span>, <span class="id" title="var">Tapart</span> <span class="id" title="var">q1</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">Tapart</span> <span class="id" title="var">q2</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> <span class="id" title="var">Eq</span> <span class="id" title="var">r</span> <span class="id" title="var">Er</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Tapart</span>,<span class="id" title="var">equiv</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (+ (<span class="id" title="var">neg</span> <span class="id" title="var">q1</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pos</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> = (<span class="id" title="var">pos</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span>) + <span class="id" title="var">neg</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Eq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pos</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">r</span> = <span class="id" title="var">neg</span> <span class="id" title="var">q2</span> + (<span class="id" title="var">pos</span> <span class="id" title="var">q1</span> + <span class="id" title="var">neg</span> <span class="id" title="var">r</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pos</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q2</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span> = <span class="id" title="var">neg</span> <span class="id" title="var">q2</span> + (<span class="id" title="var">pos</span> <span class="id" title="var">r</span> + <span class="id" title="var">neg</span> <span class="id" title="var">q1</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_left_cancellation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>),<span class="id" title="var">Er</span>.<br/>
- <span class="id" title="tactic">intros</span> ?? <span class="id" title="var">Eq</span> ?? <span class="id" title="var">Er</span> <span class="id" title="var">E'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span> <span class="id" title="keyword">with</span> <span class="id" title="var">q1</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span> <span class="id" title="keyword">with</span> <span class="id" title="var">r1</span>;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">apart_respects</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">q1</span> <span class="id" title="var">q2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Tapart</span> <span class="id" title="var">q1</span> <span class="id" title="var">r1</span> &lt;~&gt; <span class="id" title="var">Tapart</span> <span class="id" title="var">q2</span> <span class="id" title="var">r2</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> ?? <span class="id" title="var">Eq</span> ?? <span class="id" title="var">Er</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_iff_hprop_uncurried</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">apart_respects_aux</span>;<br/>
<span class="id" title="tactic">trivial</span>;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">to_ring</span>.<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">B</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">UNalt</span>} } `{<span class="id" title="var">IsCRing@</span>{<span class="id" title="var">UNalt</span>} <span class="id" title="var">B</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">to_ring@</span>{} : <span class="id" title="var">T</span> <span class="id" title="var">N</span> -&gt; <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="tactic">exact</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> (<span class="id" title="var">pos</span> <span class="id" title="var">p</span>) - <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> (<span class="id" title="var">neg</span> <span class="id" title="var">p</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">to_ring_respects@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">equiv</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">to_ring</span> <span class="id" title="var">a</span> = <span class="id" title="var">to_ring</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv</span>;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">to_ring</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> (+)<br/>
&nbsp;&nbsp;(<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">na</span> + <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">nb</span>)).<br/>
<span class="id" title="var">path_via</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">pa</span> + <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">nb</span> + 0);<br/>
[<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_negate_r</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">na</span>));<span class="id" title="var">ring_with_nat</span><br/>
|<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>].<br/>
<span class="id" title="var">path_via</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">pb</span> + <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">na</span> + 0);<br/>
[<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>|<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_negate_r</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">nb</span>));<span class="id" title="var">ring_with_nat</span>].<br/>
<span class="id" title="tactic">rewrite</span> &lt;-2!<span class="id" title="var">preserves_plus</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>,<span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">to_ring</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">contents</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">equiv</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Tle</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Tlt</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Tapart</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">to_ring</span> <span class="id" title="var">N</span> {<span class="id" title="var">_</span>} <span class="id" title="var">B</span> {<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>} / <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">PairT</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">contents</span>.<br/>
<span class="id" title="keyword">Universe</span> <span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>.<br/>
<span class="id" title="keyword">Context</span> `{<span class="id" title="var">Funext</span>} `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">N</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">UN</span>})<br/>
&nbsp;&nbsp;`{<span class="id" title="var">Naturals@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">N</span>}.<br/>

<br/>
<span class="comment">(*&nbsp;Add&nbsp;Ring&nbsp;SR&nbsp;:&nbsp;(rings.stdlib_semiring_theory&nbsp;SR).&nbsp;*)</span><br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">N_fullpartial</span> : <span class="id" title="var">FullPartialOrder</span> <span class="id" title="var">Ale</span> <span class="id" title="var">Alt</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">fullpseudo_fullpartial@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">Ularge</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z@</span>{} : <span class="id" title="var">Type@</span>{<span class="id" title="var">UN</span>} := @<span class="id" title="var">quotient</span> <span class="id" title="var">_</span> <span class="id" title="var">PairT.equiv@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_of_pair</span> : <span class="id" title="var">Cast</span> (<span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>) <span class="id" title="var">Z</span> := <span class="id" title="var">class_of</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_of_N</span> : <span class="id" title="var">Cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> := <span class="id" title="var">Compose</span> <span class="id" title="var">Z_of_pair</span> (<span class="id" title="var">PairT.inject@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_path</span> {<span class="id" title="var">x</span> <span class="id" title="var">y</span>} : <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">Z_of_pair</span> <span class="id" title="var">x</span> = <span class="id" title="var">Z_of_pair</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">related_classes_eq</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">related_path</span> {<span class="id" title="var">x</span> <span class="id" title="var">y</span>} : <span class="id" title="var">Z_of_pair</span> <span class="id" title="var">x</span> = <span class="id" title="var">Z_of_pair</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">classes_eq_related@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">UN</span> <span class="id" title="var">Ularge</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_rect@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) {<span class="id" title="var">sP</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">IsHSet</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">dclass</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>, <span class="id" title="var">P</span> (' <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;(<span class="id" title="var">dequiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>, (<span class="id" title="var">Z_path</span> <span class="id" title="var">E</span>) # (<span class="id" title="var">dclass</span> <span class="id" title="var">x</span>) = (<span class="id" title="var">dclass</span> <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span>, <span class="id" title="var">P</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">quotient_ind</span> <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">P</span> <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_compute</span> <span class="id" title="var">P</span> {<span class="id" title="var">sP</span>} <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> <span class="id" title="var">x</span><br/>
&nbsp;: @<span class="id" title="var">Z_rect</span> <span class="id" title="var">P</span> <span class="id" title="var">sP</span> <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> (<span class="id" title="var">Z_of_pair</span> <span class="id" title="var">x</span>) = <span class="id" title="var">dclass</span> <span class="id" title="var">x</span> := 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_compute_path</span> <span class="id" title="var">P</span> {<span class="id" title="var">sP</span>} <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> (<span class="id" title="var">E</span> : <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">apD</span> (@<span class="id" title="var">Z_rect</span> <span class="id" title="var">P</span> <span class="id" title="var">sP</span> <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span>) (<span class="id" title="var">Z_path</span> <span class="id" title="var">E</span>) = <span class="id" title="var">dequiv</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> <span class="id" title="var">E</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">quotient_ind_compute_path</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_ind@</span>{<span class="id" title="var">i</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) {<span class="id" title="var">sP</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">IsHProp</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">dclass</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>, <span class="id" title="var">P</span> (<span class="id" title="var">cast</span> (<span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>) <span class="id" title="var">Z</span> <span class="id" title="var">x</span>)) : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_rect@</span>{<span class="id" title="var">i</span>} <span class="id" title="var">P</span> <span class="id" title="var">dclass</span>).<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_ishprop@</span>{<span class="id" title="var">i</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_ind2</span> (<span class="id" title="var">P</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="keyword">Type</span>) {<span class="id" title="var">sP</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">IsHProp</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">dclass</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>, <span class="id" title="var">P</span> (' <span class="id" title="var">x</span>) (' <span class="id" title="var">y</span>)) : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">_</span>));<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dclass</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_ind3@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>})<br/>
&nbsp;&nbsp;{<span class="id" title="var">sP</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">IsHProp</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>)}<br/>
&nbsp;&nbsp;(<span class="id" title="var">dclass</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>, <span class="id" title="var">P</span> (' <span class="id" title="var">x</span>) (' <span class="id" title="var">y</span>) (' <span class="id" title="var">z</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">Z_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>, <span class="id" title="var">_</span>));<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
2:<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} <span class="id" title="var">_</span>);<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">istrunc_forall@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">j</span> <span class="id" title="var">j</span>} <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_forall@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_rec@</span>{<span class="id" title="var">i</span>} {<span class="id" title="var">T</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">sT</span> : <span class="id" title="var">IsHSet</span> <span class="id" title="var">T</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> (<span class="id" title="var">dclass</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span> -&gt; <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">dequiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">dclass</span> <span class="id" title="var">x</span> = <span class="id" title="var">dclass</span> <span class="id" title="var">y</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">Z</span> -&gt; <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">quotient_rec</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_rec_compute</span> <span class="id" title="var">T</span> <span class="id" title="var">sT</span> <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;: @<span class="id" title="var">Z_rec</span> <span class="id" title="var">T</span> <span class="id" title="var">sT</span> <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> (' <span class="id" title="var">x</span>) = <span class="id" title="var">dclass</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;:= 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_rec2@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} {<span class="id" title="var">T</span>:<span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>} } {<span class="id" title="var">sT</span> : <span class="id" title="var">IsHSet</span> <span class="id" title="var">T</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> (<span class="id" title="var">dclass</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span> -&gt; <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span> -&gt; <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">dequiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>, <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>, <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dclass</span> <span class="id" title="var">x1</span> <span class="id" title="var">y1</span> = <span class="id" title="var">dclass</span> <span class="id" title="var">x2</span> <span class="id" title="var">y2</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;:= @<span class="id" title="var">quotient_rec2@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">j</span> <span class="id" title="var">i</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Build_HSet</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_rec2_compute</span> {<span class="id" title="var">T</span> <span class="id" title="var">sT</span>} <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;: @<span class="id" title="var">Z_rec2</span> <span class="id" title="var">T</span> <span class="id" title="var">sT</span> <span class="id" title="var">dclass</span> <span class="id" title="var">dequiv</span> (' <span class="id" title="var">x</span>) (' <span class="id" title="var">y</span>) = <span class="id" title="var">dclass</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;:= 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dec_Z_of_pair</span> `{<span class="id" title="var">DecidablePaths</span> <span class="id" title="var">N</span>} : <span class="id" title="keyword">forall</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Decidable</span> (' <span class="id" title="var">q</span> = ' <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">PairT.equiv</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>].<br/>
- <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>,<span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">right</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">E'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">related_path</span> <span class="id" title="var">E'</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">R_dec</span> `{<span class="id" title="var">DecidablePaths</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">DecidablePaths</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">dec_Z_of_pair</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Relations,&nbsp;operations&nbsp;and&nbsp;constants&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z0</span> : <span class="id" title="var">Zero</span> <span class="id" title="var">Z</span> := ' 0.<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z1</span> : <span class="id" title="var">One</span> <span class="id" title="var">Z</span> := ' 1.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_plus@</span>{} : <span class="id" title="var">Plus</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">refine</span> (<span class="id" title="var">Z_rec2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; ' (<span class="id" title="var">PairT.pl@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)) <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">eapply</span> <span class="id" title="var">PairT.pl_respects</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_plus_compute</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : (' <span class="id" title="var">q</span>) + (' <span class="id" title="var">r</span>) = ' (<span class="id" title="var">PairT.pl</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;:= 1.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_mult@</span>{} : <span class="id" title="var">Mult</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">refine</span> (<span class="id" title="var">Z_rec2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; ' (<span class="id" title="var">PairT.ml@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)) <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">eapply</span> <span class="id" title="var">PairT.ml_respects</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Without&nbsp;this,&nbsp;typeclass&nbsp;resolution&nbsp;for&nbsp;e.g.&nbsp;<span class="inlinecode"><span class="id" title="var">Monoid</span></span> <span class="inlinecode"><span class="id" title="var">Z</span></span> <span class="inlinecode"><span class="id" title="var">Z_plus</span></span>&nbsp;tries&nbsp;to&nbsp;get&nbsp;it&nbsp;from&nbsp;<span class="inlinecode"><span class="id" title="var">SemiRing</span></span> <span class="inlinecode"><span class="id" title="var">Z</span></span> <span class="inlinecode"><span class="id" title="var">Z_plus</span></span> <span class="inlinecode">?<span class="id" title="var">mult</span></span>&nbsp;and&nbsp;fills&nbsp;the&nbsp;evar&nbsp;with&nbsp;the&nbsp;unfolded&nbsp;value,&nbsp;which&nbsp;does&nbsp;case&nbsp;analysis&nbsp;on&nbsp;quotient.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Typeclasses Opaque</span> <span class="id" title="var">Z_plus</span> <span class="id" title="var">Z_mult</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_mult_compute</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> : (' <span class="id" title="var">q</span>) * (' <span class="id" title="var">r</span>) = ' (<span class="id" title="var">PairT.ml</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;:= 1.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_negate@</span>{} : <span class="id" title="var">Negate</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_rec</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; ' (<span class="id" title="var">PairT.opp@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">_</span> <span class="id" title="var">x</span>))).<br/>
<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">eapply</span> <span class="id" title="var">PairT.opp_respects</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_negate_compute</span> <span class="id" title="var">q</span> : - (' <span class="id" title="var">q</span>) = ' (<span class="id" title="var">PairT.opp</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;:= 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_ring@</span>{} : <span class="id" title="var">IsCRing</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;1,8: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">first</span> [<span class="id" title="tactic">change</span> <span class="id" title="var">sg_op</span> <span class="id" title="keyword">with</span> <span class="id" title="var">mult</span>; <span class="id" title="tactic">change</span> <span class="id" title="var">mon_unit</span> <span class="id" title="keyword">with</span> 1 |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">sg_op</span> <span class="id" title="keyword">with</span> <span class="id" title="var">plus</span>; <span class="id" title="tactic">change</span> <span class="id" title="var">mon_unit</span> <span class="id" title="keyword">with</span> 0]; <span class="id" title="tactic">hnf</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">plus_0_l</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">plus_0_r</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_l</span>,<span class="id" title="var">plus_0_r</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">plus_comm</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_l</span>,<span class="id" title="var">plus_0_r</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">plus_comm</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap011</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_comm</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;A&nbsp;final&nbsp;word&nbsp;about&nbsp;inject&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_of_N_morphism@</span>{} : <span class="id" title="var">IsSemiRingPreserving</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>).<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>. <span class="id" title="tactic">red</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>. <span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">Z_of_N_morphism</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_of_N_injective@</span>{} : <span class="id" title="var">IsInjective</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">related_path</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Npair_splits@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">N</span>, ' (<span class="id" title="var">PairT.C</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) = ' <span class="id" title="var">n</span> + - ' <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Zle_HProp@</span>{} : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">HProp@</span>{<span class="id" title="var">UN</span>}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">Z_rec2@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>} <span class="id" title="var">_</span> (@<span class="id" title="var">trunctype_istrunc@</span>{<span class="id" title="var">Ularge</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">Build_HProp</span> (<span class="id" title="var">PairT.Tle</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>))).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_hprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">PairT.le_respects</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Zle@</span>{} : <span class="id" title="var">Le</span> <span class="id" title="var">Z</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">Zle_HProp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_Zle</span> : <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">_</span> <span class="id" title="var">Zle</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Zle</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zle_def@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>,<br/>
&nbsp;&nbsp;@<span class="id" title="var">paths@</span>{<span class="id" title="var">Uhuge</span>} <span class="id" title="var">Type@</span>{<span class="id" title="var">UN</span>} (' <span class="id" title="var">a</span> &lt;= ' <span class="id" title="var">b</span>) (<span class="id" title="var">PairT.Tle@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">a</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">idpath</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_partial_order'</span> : <span class="id" title="var">PartialOrder</span> <span class="id" title="var">Zle</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|<span class="id" title="tactic">split</span>|].<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">change</span> (<span class="id" title="var">PairT.Tle</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>). <span class="id" title="tactic">red</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>]. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zle_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_reflecting</span> (+ (<span class="id" title="var">nb</span> + <span class="id" title="var">pb</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pa</span> + <span class="id" title="var">nc</span> + (<span class="id" title="var">nb</span> + <span class="id" title="var">pb</span>) = (<span class="id" title="var">pa</span> + <span class="id" title="var">nb</span>) + (<span class="id" title="var">pb</span> + <span class="id" title="var">nc</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pc</span> + <span class="id" title="var">na</span> + (<span class="id" title="var">nb</span> + <span class="id" title="var">pb</span>) = (<span class="id" title="var">pb</span> + <span class="id" title="var">na</span>) + (<span class="id" title="var">pc</span> + <span class="id" title="var">nb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">abstract</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_le_compat</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>];<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zle_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>;<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">antisymmetry</span> <span class="id" title="var">le</span>);<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Z_partial_order@</span>{} : <span class="id" title="var">PartialOrder</span> <span class="id" title="var">Zle</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_partial_order'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_partial_order'</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zle_cast_embedding'</span> : <span class="id" title="var">OrderEmbedding</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">red</span>.<br/>
- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zle_def</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_0_r</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">intros</span> ??. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zle_def</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2!<span class="id" title="var">plus_0_r</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Zle_cast_embedding@</span>{} : <span class="id" title="var">OrderEmbedding</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zle_cast_embedding'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zle_cast_embedding'</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zle_plus_preserving_l'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">OrderPreserving</span> ((+) <span class="id" title="var">z</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>] [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>]. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zle_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pc</span> + <span class="id" title="var">pa</span> + (<span class="id" title="var">nc</span> + <span class="id" title="var">nb</span>) = (<span class="id" title="var">pc</span> + <span class="id" title="var">nc</span>) + (<span class="id" title="var">pa</span> + <span class="id" title="var">nb</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pc</span> + <span class="id" title="var">pb</span> + (<span class="id" title="var">nc</span> + <span class="id" title="var">na</span>) = (<span class="id" title="var">pc</span> + <span class="id" title="var">nc</span>) + (<span class="id" title="var">pb</span> + <span class="id" title="var">na</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">order_preserving</span> <span class="id" title="var">_</span>),<span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zle_plus_preserving_l@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">OrderPreserving</span> ((+) <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zle_plus_preserving_l'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zle_plus_preserving_l'</span>]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zmult_nonneg'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">PropHolds</span> (0  <span class="id" title="var">x</span>) -&gt; <span class="id" title="var">PropHolds</span> (0  <span class="id" title="var">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">PropHolds</span> (0  <span class="id" title="var">x</span> * <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">PropHolds</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>]. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zle_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">plus_0_l</span>,!<span class="id" title="var">plus_0_r</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">decompose_le</span> <span class="id" title="var">E1</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> [<span class="id" title="var">Ea1</span> <span class="id" title="var">Ea2</span>]], (<span class="id" title="var">decompose_le</span> <span class="id" title="var">E2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> [<span class="id" title="var">Eb1</span> <span class="id" title="var">Eb2</span>]].<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Ea2</span>, <span class="id" title="var">Eb2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">compose_le</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span> * <span class="id" title="var">b</span>).<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">nonneg_mult_compat</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zmult_nonneg@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">PropHolds</span> (0  <span class="id" title="var">x</span>) -&gt; <span class="id" title="var">PropHolds</span> (0  <span class="id" title="var">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">PropHolds</span> (0  <span class="id" title="var">x</span> * <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zmult_nonneg'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zmult_nonneg'</span>]).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_order@</span>{} : <span class="id" title="var">SemiRingOrder</span> <span class="id" title="var">Zle</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">Z_ring</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">rings.from_ring_order</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Make&nbsp;this&nbsp;computable?&nbsp;Would&nbsp;need&nbsp;to&nbsp;compute&nbsp;through&nbsp;Z_ind2.&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Zle_dec</span> `{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">N</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">x</span> &lt;= <span class="id" title="var">y</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">x</span> &lt;= <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">change</span> (<span class="id" title="var">Decidable</span> (<span class="id" title="var">PairT.Tle</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)).<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tle</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Zlt_HProp@</span>{} : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">HProp@</span>{<span class="id" title="var">UN</span>}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">Z_rec2@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>} <span class="id" title="var">_</span> (@<span class="id" title="var">trunctype_istrunc@</span>{<span class="id" title="var">Ularge</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">Build_HProp</span> (<span class="id" title="var">PairT.Tlt</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>))).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_hprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">PairT.lt_respects</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Zlt@</span>{} : <span class="id" title="var">Lt</span> <span class="id" title="var">Z</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">Zlt_HProp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_Zlt</span> : <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">_</span> <span class="id" title="var">Zlt</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Zlt</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zlt_def'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, ' <span class="id" title="var">a</span> &lt; ' <span class="id" title="var">b</span> = <span class="id" title="var">PairT.Tlt</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Zlt_def@</span>{<span class="id" title="var">i</span>} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zlt_def'@</span>{<span class="id" title="var">Uhuge</span> <span class="id" title="var">i</span>}|<span class="id" title="tactic">exact</span> <span class="id" title="var">Zlt_def'@</span>{<span class="id" title="var">i</span>}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zlt_strict'</span> : <span class="id" title="var">StrictOrder</span> <span class="id" title="var">Zlt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="comment">(*&nbsp;we&nbsp;need&nbsp;to&nbsp;change&nbsp;so&nbsp;that&nbsp;it&nbsp;sees&nbsp;Empty,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needed&nbsp;to&nbsp;figure&nbsp;out&nbsp;IsHProp&nbsp;(using&nbsp;Funext)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">x</span> -&gt; <span class="id" title="var">Empty</span>). <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">irreflexivity</span>,<span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>];<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_reflecting</span> (+ (<span class="id" title="var">nb</span> + <span class="id" title="var">pb</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pa</span> + <span class="id" title="var">nc</span> + (<span class="id" title="var">nb</span> + <span class="id" title="var">pb</span>) = (<span class="id" title="var">pa</span> + <span class="id" title="var">nb</span>) + (<span class="id" title="var">pb</span> + <span class="id" title="var">nc</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pc</span> + <span class="id" title="var">na</span> + (<span class="id" title="var">nb</span> + <span class="id" title="var">pb</span>) = (<span class="id" title="var">pb</span> + <span class="id" title="var">na</span>) + (<span class="id" title="var">pc</span> + <span class="id" title="var">nb</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">plus_lt_compat</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zlt_strict@</span>{} : <span class="id" title="var">StrictOrder</span> <span class="id" title="var">Zlt</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zlt_strict'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zlt_strict'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">plus_strict_order_preserving_l'</span><br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">StrictlyOrderPreserving</span> ((+) <span class="id" title="var">z</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>; <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>].<br/>
<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pa</span> + <span class="id" title="var">pb</span> + (<span class="id" title="var">na</span> + <span class="id" title="var">nc</span>) = (<span class="id" title="var">pa</span> + <span class="id" title="var">na</span>) + (<span class="id" title="var">pb</span> + <span class="id" title="var">nc</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pa</span> + <span class="id" title="var">pc</span> + (<span class="id" title="var">na</span> + <span class="id" title="var">nb</span>) = (<span class="id" title="var">pa</span> + <span class="id" title="var">na</span>) + (<span class="id" title="var">pc</span> + <span class="id" title="var">nb</span>)) <span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_preserving</span> <span class="id" title="var">_</span>),<span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zplus_strict_order_preserving_l@</span>{}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">StrictlyOrderPreserving</span> ((+) <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">plus_strict_order_preserving_l'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">plus_strict_order_preserving_l'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zmult_pos'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">x</span>) -&gt; <span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">x</span> * <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">PropHolds</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>]. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">plus_0_l</span>,!<span class="id" title="var">plus_0_r</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">decompose_lt</span> <span class="id" title="var">E1</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">a</span> [<span class="id" title="var">Ea1</span> <span class="id" title="var">Ea2</span>]], (<span class="id" title="var">decompose_lt</span> <span class="id" title="var">E2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> [<span class="id" title="var">Eb1</span> <span class="id" title="var">Eb2</span>]].<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Ea2</span>, <span class="id" title="var">Eb2</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">compose_lt</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span> * <span class="id" title="var">b</span>).<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">pos_mult_compat</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zmult_pos@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">x</span>) -&gt; <span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">y</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">PropHolds</span> (0 &lt; <span class="id" title="var">x</span> * <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zmult_pos'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zmult_pos'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_strict_srorder</span> : <span class="id" title="var">StrictSemiRingOrder</span> <span class="id" title="var">Zlt</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">Z_ring</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">from_strict_ring_order</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Zlt_dec</span> `{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">N</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">Decidable</span> (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">change</span> (<span class="id" title="var">Decidable</span> (<span class="id" title="var">PairT.Tlt</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)).<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Local Existing Instance</span> <span class="id" title="var">pseudo_order_apart</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Zapart_HProp@</span>{} : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">HProp@</span>{<span class="id" title="var">UN</span>}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">apply</span> (@<span class="id" title="var">Z_rec2@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="var">Build_HProp</span> (<span class="id" title="var">PairT.Tapart</span> <span class="id" title="var">q</span> <span class="id" title="var">r</span>))).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_hprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">PairT.apart_respects</span> <span class="id" title="var">_</span>);<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Zapart@</span>{} : <span class="id" title="var">Apart</span> <span class="id" title="var">Z</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">Zapart_HProp</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zapart_def'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">apart</span> (' <span class="id" title="var">a</span>) (' <span class="id" title="var">b</span>) = <span class="id" title="var">PairT.Tapart</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Zapart_def@</span>{<span class="id" title="var">i</span>} := <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zapart_def'@</span>{<span class="id" title="var">Uhuge</span> <span class="id" title="var">i</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zapart_def'@</span>{<span class="id" title="var">i</span>}]).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishprop_Zapart</span> : <span class="id" title="var">is_mere_relation</span> <span class="id" title="var">_</span> <span class="id" title="var">Zapart</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">Zapart</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_trivial_apart'</span> `{!<span class="id" title="var">TrivialApart</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">TrivialApart</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>|<span class="id" title="tactic">idtac</span>].<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zapart_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tapart</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span>.<br/>
- <span class="id" title="tactic">intros</span> <span class="id" title="var">E2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">related_path</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trivial_apart</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>. <span class="id" title="tactic">auto</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">trivial_apart</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E1</span>,<span class="id" title="var">Z_path</span>. <span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_trivial_apart@</span>{} `{!<span class="id" title="var">TrivialApart</span> <span class="id" title="var">N</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">TrivialApart</span> <span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_trivial_apart'@</span>{<span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_trivial_apart'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_is_apart'</span> : <span class="id" title="var">IsApart</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>];<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zapart_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tapart</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span> <span class="id" title="var">z</span>;<span class="id" title="var">revert</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zapart_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tapart</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_left_cancellation</span> (+) (<span class="id" title="var">PairT.neg</span> <span class="id" title="var">c</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">cotransitive</span> <span class="id" title="var">E1</span> <span class="id" title="var">_</span>));<span class="id" title="tactic">intros</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (+ (<span class="id" title="var">PairT.neg</span> <span class="id" title="var">b</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">PairT.pos</span> <span class="id" title="var">a</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">c</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">b</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PairT.neg</span> <span class="id" title="var">c</span> + (<span class="id" title="var">PairT.pos</span> <span class="id" title="var">a</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (+ (<span class="id" title="var">PairT.neg</span> <span class="id" title="var">a</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">PairT.pos</span> <span class="id" title="var">c</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">b</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">a</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PairT.pos</span> <span class="id" title="var">c</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">a</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">PairT.pos</span> <span class="id" title="var">b</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">c</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">a</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PairT.neg</span> <span class="id" title="var">c</span> + (<span class="id" title="var">PairT.pos</span> <span class="id" title="var">b</span> + <span class="id" title="var">PairT.neg</span> <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zapart_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tapart</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tight_apart</span>,<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">related_path</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">tight_apart</span>,<span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Z_is_apart@</span>{} : <span class="id" title="var">IsApart</span> <span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_is_apart'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_is_apart'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_full_psorder'</span> : <span class="id" title="var">FullPseudoOrder</span> <span class="id" title="var">Zle</span> <span class="id" title="var">Zlt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|<span class="id" title="tactic">split</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>|].<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pseudo_order_antisym</span>.<br/>
- <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">E</span> <span class="id" title="var">c</span>;<span class="id" title="var">revert</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>] [<span class="id" title="var">pc</span> <span class="id" title="var">nc</span>];<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_preserving</span> (+ <span class="id" title="var">nc</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">cotransitive</span> <span class="id" title="var">E1</span> <span class="id" title="var">_</span>));<span class="id" title="tactic">intros</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_reflecting</span> ((<span class="id" title="var">nb</span>) +)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">nb</span> + (<span class="id" title="var">pa</span> + <span class="id" title="var">nc</span>) = <span class="id" title="var">pa</span> + <span class="id" title="var">nb</span> + <span class="id" title="var">nc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">strictly_order_reflecting</span> ((<span class="id" title="var">na</span>) +)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">na</span> + (<span class="id" title="var">pc</span> + <span class="id" title="var">nb</span>) = <span class="id" title="var">nb</span> + (<span class="id" title="var">pc</span> + <span class="id" title="var">na</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">na</span> + (<span class="id" title="var">pb</span> + <span class="id" title="var">nc</span>) = <span class="id" title="var">pb</span> + <span class="id" title="var">na</span> + <span class="id" title="var">nc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> @<span class="id" title="var">Z_ind2</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> @<span class="id" title="var">istrunc_prod</span>;[|<span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (@<span class="id" title="var">istrunc_arrow</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ishprop_sum</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">irreflexivity</span> <span class="id" title="var">lt</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zapart_def</span>,!<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tapart</span>,<span class="id" title="var">PairT.Tlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">apart_iff_total_lt</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Zle_def</span>,<span class="id" title="var">Zlt_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tlt</span>,<span class="id" title="var">PairT.Tle</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_iff_not_lt_flip</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Coq&nbsp;pre&nbsp;8.8&nbsp;produces&nbsp;phantom&nbsp;universes,&nbsp;see&nbsp;GitHub&nbsp;Coq/Coq1033. *)</span><br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Z_full_psorder@</span>{} : <span class="id" title="var">FullPseudoOrder</span> <span class="id" title="var">Zle</span> <span class="id" title="var">Zlt</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_full_psorder'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_full_psorder'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_full_psorder'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Zmult_strong_ext_l'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">StrongExtensionality</span> (<span class="id" title="var">z</span> *.).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind3</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span>)).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">zp</span> <span class="id" title="var">zn</span>] [<span class="id" title="var">xp</span> <span class="id" title="var">xn</span>] [<span class="id" title="var">yp</span> <span class="id" title="var">yn</span>];<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">Zapart_def</span>;<span class="id" title="tactic">unfold</span> <span class="id" title="var">PairT.Tapart</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E1</span>.<br/>
<span class="id" title="tactic">refine</span> (<span class="id" title="var">merely_destruct</span> (<span class="id" title="var">strong_binary_extensionality</span> (+)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">zp</span> * (<span class="id" title="var">xp</span> + <span class="id" title="var">yn</span>)) (<span class="id" title="var">zn</span> * (<span class="id" title="var">yp</span> + <span class="id" title="var">xn</span>)) (<span class="id" title="var">zp</span> * (<span class="id" title="var">yp</span> + <span class="id" title="var">xn</span>)) (<span class="id" title="var">zn</span> * (<span class="id" title="var">xp</span> + <span class="id" title="var">yn</span>)) <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
- <span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">zp</span> * (<span class="id" title="var">xp</span> + <span class="id" title="var">yn</span>) + <span class="id" title="var">zn</span> * (<span class="id" title="var">yp</span> + <span class="id" title="var">xn</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">zp</span> * <span class="id" title="var">xp</span> + <span class="id" title="var">zn</span> * <span class="id" title="var">xn</span> + (<span class="id" title="var">zp</span> * <span class="id" title="var">yn</span> + <span class="id" title="var">zn</span> * <span class="id" title="var">yp</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">clear</span> <span class="id" title="var">Hrw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">zp</span> * (<span class="id" title="var">yp</span> + <span class="id" title="var">xn</span>) + <span class="id" title="var">zn</span> * (<span class="id" title="var">xp</span> + <span class="id" title="var">yn</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">zp</span> * <span class="id" title="var">yp</span> + <span class="id" title="var">zn</span> * <span class="id" title="var">yn</span> + (<span class="id" title="var">zp</span> * <span class="id" title="var">xn</span> + <span class="id" title="var">zn</span> * <span class="id" title="var">xp</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hrw</span>;<span class="id" title="tactic">exact</span> <span class="id" title="var">E1</span>.<br/>
- <span class="id" title="tactic">intros</span> [<span class="id" title="var">E2</span>|<span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (<span class="id" title="var">zp</span> *.)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">apply</span> (<span class="id" title="var">strong_extensionality</span> (<span class="id" title="var">zn</span> *.)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zmult_strong_ext_l@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">StrongExtensionality</span> (<span class="id" title="var">z</span> *.)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Zmult_strong_ext_l'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Zmult_strong_ext_l'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Z_full_pseudo_srorder@</span>{}<br/>
&nbsp;&nbsp;: <span class="id" title="var">FullPseudoSemiRingOrder</span> <span class="id" title="var">Zle</span> <span class="id" title="var">Zlt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">Z_ring</span>.<br/>
<span class="id" title="tactic">first</span> [<span class="id" title="tactic">apply</span> <span class="id" title="var">from_full_pseudo_ring_order@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">from_full_pseudo_ring_order</span>]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">apartness.strong_binary_setoid_morphism_commutative</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Goal</span> <span class="id" title="var">FullPseudoSemiRingOrder</span> <span class="id" title="var">Zle</span> <span class="id" title="var">Zlt</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="var">Fail</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">Z_full_pseudo_srorder@</span>{<span class="id" title="var">i</span>}.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_to_ring@</span>{} : <span class="id" title="var">IntegersToRing@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UNalt</span>} <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">R</span> ??????.<br/>
<span class="id" title="tactic">eapply</span> <span class="id" title="var">Z_rec</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">PairT.to_ring_respects</span> <span class="id" title="var">N</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_to_ring_morphism'</span> `{<span class="id" title="var">IsCRing</span> <span class="id" title="var">B</span>} : <span class="id" title="var">IsSemiRingPreserving</span> (<span class="id" title="var">integers_to_ring</span> <span class="id" title="var">Z</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">split</span>;<span class="id" title="tactic">red</span>.<br/>
- <span class="id" title="tactic">change</span> (@<span class="id" title="var">sg_op</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">plus</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<span class="id" title="var">sg_op</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">plus</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">integers_to_ring</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">preserves_plus</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_plus_distr</span>. <span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">change</span> (@<span class="id" title="var">mon_unit</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">zero</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<span class="id" title="var">mon_unit</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">zero</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">integers_to_ring</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_0</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span>,<span class="id" title="var">plus_0_r</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">change</span> (@<span class="id" title="var">sg_op</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">mult</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<span class="id" title="var">sg_op</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">mult</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>] [<span class="id" title="var">pb</span> <span class="id" title="var">nb</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">integers_to_ring</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">preserves_plus</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">preserves_mult</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_plus</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !(<span class="id" title="var">preserves_mult</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_plus_distr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_mult_distr_r</span>,<span class="id" title="var">negate_mult_distr_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">negate_mult_negate</span> (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">na</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span> <span class="id" title="var">nb</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
- <span class="id" title="tactic">change</span> (@<span class="id" title="var">mon_unit</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">one</span> <span class="id" title="var">B</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (@<span class="id" title="var">mon_unit</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span> (@<span class="id" title="var">one</span> <span class="id" title="var">Z</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">integers_to_ring</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_1</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_0</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span>,<span class="id" title="var">plus_0_r</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Z_to_ring_morphism@</span>{} `{<span class="id" title="var">IsCRing</span> <span class="id" title="var">B</span>} : <span class="id" title="var">IsSemiRingPreserving</span> (<span class="id" title="var">integers_to_ring</span> <span class="id" title="var">Z</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_to_ring_morphism'@</span>{<span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_to_ring_morphism'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_to_ring_unique@</span>{} `{<span class="id" title="var">IsCRing</span> <span class="id" title="var">B</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">B</span>) `{!<span class="id" title="var">IsSemiRingPreserving</span> <span class="id" title="var">h</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">Z</span>, <span class="id" title="var">integers_to_ring</span> <span class="id" title="var">Z</span> <span class="id" title="var">B</span> <span class="id" title="var">x</span> = <span class="id" title="var">h</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">Z_ring</span>.<br/>
<span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_ind</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">na</span>];<span class="id" title="tactic">unfold</span> <span class="id" title="var">integers_to_ring</span>;<span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Npair_splits</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_plus</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">h</span>)),(<span class="id" title="var">preserves_negate</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">h</span>)).<br/>
<span class="id" title="tactic">change</span> (<span class="id" title="var">h</span> (' <span class="id" title="var">pa</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">h</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>) <span class="id" title="var">pa</span>).<br/>
<span class="id" title="tactic">change</span> (<span class="id" title="var">h</span> (' <span class="id" title="var">na</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">Compose</span> <span class="id" title="var">h</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>) <span class="id" title="var">na</span>).<br/>
<span class="id" title="tactic">rewrite</span> 2!(<span class="id" title="var">naturals_initial</span> (<span class="id" title="var">h</span>:=<span class="id" title="var">Compose</span> <span class="id" title="var">h</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>))).<br/>
<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_integers@</span>{} : <span class="id" title="var">Integers</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">split</span>;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>.<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_ring</span>.<br/>
- <span class="id" title="tactic">apply</span> @<span class="id" title="var">Z_to_ring_unique</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> `{!<span class="id" title="var">NatDistance</span> <span class="id" title="var">N</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_abs_aux_0@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">z</span> : <span class="id" title="var">N</span>, <span class="id" title="var">a</span> + <span class="id" title="var">z</span> = <span class="id" title="var">b</span> -&gt; <span class="id" title="var">z</span> = 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> 0 = ' {| <span class="id" title="var">PairT.pos</span> := <span class="id" title="var">a</span>; <span class="id" title="var">PairT.neg</span> := <span class="id" title="var">b</span> |}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">z</span> <span class="id" title="var">E</span> <span class="id" title="var">E'</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">preserves_0</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">N</span>)).<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E'</span>,<span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>. <span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">plus_comm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_abs_aux_neg@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">z</span> : <span class="id" title="var">N</span>, <span class="id" title="var">a</span> + <span class="id" title="var">z</span> = <span class="id" title="var">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> <span class="id" title="var">z</span> = - ' {| <span class="id" title="var">PairT.pos</span> := <span class="id" title="var">a</span>; <span class="id" title="var">PairT.neg</span> := <span class="id" title="var">b</span> |}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">z</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">naturals.to_semiring_unique</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>)).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>. <span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>,<span class="id" title="var">plus_comm</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_abs_aux_pos@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">z</span> : <span class="id" title="var">N</span>, <span class="id" title="var">b</span> + <span class="id" title="var">z</span> = <span class="id" title="var">a</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> <span class="id" title="var">z</span> = ' {| <span class="id" title="var">PairT.pos</span> := <span class="id" title="var">a</span>; <span class="id" title="var">PairT.neg</span> := <span class="id" title="var">b</span> |}.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">z</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">naturals.to_semiring_unique</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>)).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Z_path</span>;<span class="id" title="tactic">red</span>;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>,<span class="id" title="var">plus_comm</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;We&nbsp;use&nbsp;decidability&nbsp;of&nbsp;equality&nbsp;on&nbsp;N<br/>
&nbsp;&nbsp;&nbsp;to&nbsp;make&nbsp;sure&nbsp;we&nbsp;always&nbsp;go&nbsp;left&nbsp;when&nbsp;the&nbsp;inputs&nbsp;are&nbsp;equal.<br/>
&nbsp;&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;would&nbsp;have&nbsp;to&nbsp;truncate&nbsp;IntAbs.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Z_abs_def@</span>{} : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">N</span>, <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> <span class="id" title="var">n</span> = ' <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;|<span class="id" title="var">_</span>| (<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">N</span>, <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> <span class="id" title="var">n</span> = - ' <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>].<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_distance_sig</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">z</span> <span class="id" title="var">E</span>]|[<span class="id" title="var">z</span> <span class="id" title="var">E</span>]].<br/>
- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">z</span> = 0)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E'</span>|<span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> 0. <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_abs_aux_0</span> <span class="id" title="keyword">with</span> <span class="id" title="var">z</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_abs_aux_neg</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">left</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">z</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Z_abs_aux_pos</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_abs_respects'</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">PairT.T</span> <span class="id" title="var">N</span>) (<span class="id" title="var">E</span> : <span class="id" title="var">PairT.equiv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">transport</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> : <span class="id" title="var">Z</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">N</span>, <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> <span class="id" title="var">n</span> = <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">_</span>| (<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span> : <span class="id" title="var">N</span>, <span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span> <span class="id" title="var">n</span> = - <span class="id" title="var">q</span>)) (<span class="id" title="var">Z_path</span> <span class="id" title="var">E</span>) (<span class="id" title="var">Z_abs_def</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;= <span class="id" title="var">Z_abs_def</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> [<span class="id" title="var">pa</span> <span class="id" title="var">pb</span>] [<span class="id" title="var">na</span> <span class="id" title="var">nb</span>] <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">Z_abs_def</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_distance_sig</span> <span class="id" title="var">pa</span> <span class="id" title="var">pb</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">z1</span> <span class="id" title="var">E1</span>] | [<span class="id" title="var">z1</span> <span class="id" title="var">E1</span>]];<span class="id" title="tactic">simpl</span>.<br/>
- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">z1</span> = 0)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E2</span> | <span class="id" title="var">E2</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Sum.transport_sum</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Sigma.transport_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_distance_sig</span> <span class="id" title="var">na</span> <span class="id" title="var">nb</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">z2</span> <span class="id" title="var">E3</span>] | [<span class="id" title="var">z2</span> <span class="id" title="var">E3</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">z2</span> = 0)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E4</span> | <span class="id" title="var">E4</span>]|];<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Sigma.path_sigma_hprop</span>;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">PathGroupoids.transport_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">E4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span>,<span class="id" title="var">E2</span>,<span class="id" title="var">plus_0_r</span>,&lt;-(<span class="id" title="var">plus_0_r</span> (<span class="id" title="var">na</span>+<span class="id" title="var">pa</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>,(<span class="id" title="var">plus_comm</span> <span class="id" title="var">pa</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sigma.path_sigma_hprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">PathGroupoids.transport_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E2</span>,<span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E3</span>,<span class="id" title="var">E1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> (<span class="id" title="var">pb</span> + <span class="id" title="var">nb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>. <span class="id" title="var">etransitivity</span>;[<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Sum.transport_sum</span>,<span class="id" title="var">Sigma.transport_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_distance_sig</span> <span class="id" title="var">na</span> <span class="id" title="var">nb</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">z2</span> <span class="id" title="var">E3</span>] | [<span class="id" title="var">z2</span> <span class="id" title="var">E3</span>]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">z2</span> = 0)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E4</span> | <span class="id" title="var">E4</span>]|];<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E4</span>,<span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E3</span>;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> (<span class="id" title="var">pa</span>+<span class="id" title="var">na</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> <span class="id" title="var">pa</span> <span class="id" title="var">na</span>),<span class="id" title="var">plus_0_r</span>,&lt;-<span class="id" title="var">plus_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">plus_comm</span> <span class="id" title="var">na</span> <span class="id" title="var">pa</span>). <span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sigma.path_sigma_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">PathGroupoids.transport_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> (<span class="id" title="var">pa</span> + <span class="id" title="var">na</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_assoc</span> <span class="id" title="var">pa</span> <span class="id" title="var">na</span> <span class="id" title="var">z2</span>),(<span class="id" title="var">plus_comm</span> <span class="id" title="var">pa</span> <span class="id" title="var">na</span>),&lt;-<span class="id" title="var">plus_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">destruct</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Erw</span> : <span class="id" title="var">nb</span> + <span class="id" title="var">z2</span> + (<span class="id" title="var">pa</span> + <span class="id" title="var">z1</span>) = (<span class="id" title="var">pa</span> + <span class="id" title="var">nb</span>) + (<span class="id" title="var">z2</span> + <span class="id" title="var">z1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_0_r</span> (<span class="id" title="var">pa</span>+<span class="id" title="var">nb</span>)),<span class="id" title="var">Erw</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> <span class="id" title="var">_</span>),<span class="id" title="tactic">symmetry</span>,<span class="id" title="var">naturals.zero_sum</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>.<br/>
- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Sum.transport_sum</span>,<span class="id" title="var">Sigma.transport_sigma</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">nat_distance_sig</span> <span class="id" title="var">na</span> <span class="id" title="var">nb</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">z2</span> <span class="id" title="var">E3</span>] | [<span class="id" title="var">z2</span> <span class="id" title="var">E3</span>]];<br/>
&nbsp;&nbsp;[<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> (<span class="id" title="var">z2</span> = 0)) <span class="id" title="keyword">as</span> [<span class="id" title="var">E4</span> | <span class="id" title="var">E4</span>]|];<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Sigma.path_sigma_hprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">PathGroupoids.transport_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span>,<span class="id" title="var">E4</span>,<span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> (<span class="id" title="var">na</span>+<span class="id" title="var">pb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">path_via</span> (<span class="id" title="var">pb</span> + <span class="id" title="var">z1</span> + <span class="id" title="var">na</span>). <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">E4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hrw</span> : <span class="id" title="var">pb</span> + <span class="id" title="var">z1</span> + (<span class="id" title="var">na</span> + <span class="id" title="var">z2</span>) = (<span class="id" title="var">na</span> + <span class="id" title="var">pb</span>) + (<span class="id" title="var">z1</span> + <span class="id" title="var">z2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">ring_with_nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">plus_0_r</span> (<span class="id" title="var">na</span>+<span class="id" title="var">pb</span>)),<span class="id" title="var">Hrw</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>),<span class="id" title="var">naturals.zero_sum</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>,<span class="id" title="var">Sigma.path_sigma_hprop</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">PathGroupoids.transport_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">E1</span>,&lt;-<span class="id" title="var">E3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">left_cancellation</span> <span class="id" title="var">plus</span> (<span class="id" title="var">pb</span>+<span class="id" title="var">nb</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">path_via</span> (<span class="id" title="var">pb</span> + <span class="id" title="var">z1</span> + <span class="id" title="var">nb</span>);[|<span class="id" title="var">path_via</span> (<span class="id" title="var">nb</span> + <span class="id" title="var">z2</span> + <span class="id" title="var">pb</span>)];<span class="id" title="var">ring_with_nat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_abs'</span> : <span class="id" title="var">IntAbs</span> <span class="id" title="var">Z</span> <span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">red</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Z_rect</span> <span class="id" title="var">_</span> <span class="id" title="var">Z_abs_def</span>).<br/>
<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_abs_respects'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_abs@</span>{} : <span class="id" title="var">IntAbs@</span>{<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span><br/>
&nbsp;&nbsp;<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span><br/>
&nbsp;&nbsp;<span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span> <span class="id" title="var">UN</span><br/>
&nbsp;&nbsp;<span class="id" title="var">UN</span> <span class="id" title="var">UN</span>} <span class="id" title="var">Z</span> <span class="id" title="var">N</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Z_abs'</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">n_to_z</span> := (<span class="id" title="var">naturals_to_semiring</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">zero_product_aux</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">n_to_z</span> <span class="id" title="var">a</span> * <span class="id" title="var">n_to_z</span> <span class="id" title="var">b</span> = 0 -&gt; <span class="id" title="var">n_to_z</span> <span class="id" title="var">a</span> = 0 |<span class="id" title="var">_</span>| <span class="id" title="var">n_to_z</span> <span class="id" title="var">b</span> = 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">rings.preserves_mult</span>.<br/>
<span class="id" title="tactic">rewrite</span> &lt;-!(<span class="id" title="var">naturals.to_semiring_unique</span> (<span class="id" title="var">cast</span> <span class="id" title="var">N</span> <span class="id" title="var">Z</span>)).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">change</span> 0 <span class="id" title="keyword">with</span> (' 0) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">_</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_product</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>];<span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>;[<span class="id" title="tactic">left</span>|<span class="id" title="tactic">right</span>];<span class="id" title="tactic">apply</span> <span class="id" title="var">preserves_0</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_zero_product'</span> : <span class="id" title="var">ZeroProduct</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="tactic">destruct</span> (<span class="id" title="var">int_abs_sig</span> <span class="id" title="var">Z</span> <span class="id" title="var">N</span> <span class="id" title="var">x</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">a</span> <span class="id" title="var">Ea</span>]|[<span class="id" title="var">a</span> <span class="id" title="var">Ea</span>]],<br/>
&nbsp;&nbsp;(<span class="id" title="var">int_abs_sig</span> <span class="id" title="var">Z</span> <span class="id" title="var">N</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [[<span class="id" title="var">b</span> <span class="id" title="var">Eb</span>]|[<span class="id" title="var">b</span> <span class="id" title="var">Eb</span>]].<br/>
- <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Ea</span>,&lt;-<span class="id" title="var">Eb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_product_aux</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Ea</span>,&lt;-<span class="id" title="var">Eb</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">negate</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_mult_distr_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Ea</span>,&lt;-<span class="id" title="var">Eb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_product_aux</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Ea</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">negate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span>,&lt;-<span class="id" title="var">Eb</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">negate</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_mult_distr_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Ea</span>,&lt;-<span class="id" title="var">Eb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_product_aux</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">negate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span>,&lt;-<span class="id" title="var">Ea</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>;<span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Eb</span>;<span class="id" title="tactic">trivial</span>.<br/>
- <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">negate_mult_negate</span>,&lt;-<span class="id" title="var">Ea</span>,&lt;-<span class="id" title="var">Eb</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">zero_product_aux</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">E</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">E</span>|<span class="id" title="var">E</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">negate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span>,&lt;-<span class="id" title="var">Ea</span>;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">injective</span> <span class="id" title="var">negate</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_0</span>,&lt;-<span class="id" title="var">Eb</span>;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">Z_zero_product@</span>{} : <span class="id" title="var">ZeroProduct</span> <span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">first</span> [<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_zero_product'@</span>{<span class="id" title="var">Ularge</span> <span class="id" title="var">Ularge</span>}|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Z_zero_product'@</span>{}]).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">contents</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Instances</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Existing Instances</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">T_set</span> <span class="id" title="var">inject</span> <span class="id" title="var">Tle_hprop</span> <span class="id" title="var">Tlt_hprop</span> <span class="id" title="var">Tapart_hprop</span> <span class="id" title="var">Z_of_pair</span> <span class="id" title="var">Z_of_N</span> <span class="id" title="var">R_dec</span> <span class="id" title="var">Z0</span> <span class="id" title="var">Z1</span> <span class="id" title="var">Z_plus</span> <span class="id" title="var">Z_mult</span> <span class="id" title="var">Z_negate</span> <span class="id" title="var">Z_of_N_injective</span> <span class="id" title="var">Zle</span> <span class="id" title="var">ishprop_Zle</span> <span class="id" title="var">Zle_cast_embedding</span> <span class="id" title="var">Z_order</span> <span class="id" title="var">Zle_dec</span> <span class="id" title="var">Zlt</span> <span class="id" title="var">ishprop_Zlt</span> <span class="id" title="var">Z_strict_srorder</span> <span class="id" title="var">Zlt_dec</span> <span class="id" title="var">Zapart</span> <span class="id" title="var">ishprop_Zapart</span> <span class="id" title="var">Z_trivial_apart</span> <span class="id" title="var">Z_to_ring</span> <span class="id" title="var">Z_integers</span> <span class="id" title="var">Z_abs</span> <span class="id" title="var">Z_zero_product</span> <span class="id" title="var">Z_of_N_morphism</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Instances</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">NatPair</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>