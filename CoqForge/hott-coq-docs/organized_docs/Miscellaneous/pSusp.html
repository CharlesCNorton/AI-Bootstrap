<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>pSusp</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library pSusp</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Basics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Pointed.Core</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Pointed.Loops</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Pointed.pTrunc</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Pointed.pEquiv</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Homotopy.Suspension</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Homotopy.Freudenthal</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Truncations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">WildCat</span>.<br/>

<br/>
<span class="id" title="keyword">Generalizable Variables</span> <span class="id" title="var">X</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">pointed_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1306"></a><h2 class="section">Pointedness of <span class="inlinecode"><span class="id" title="var">Susp</span></span> and path spaces thereof</h2>
 We arbitrarily choose <span class="inlinecode"><span class="id" title="var">North</span></span> to be the point. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ispointed_susp</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} : <span class="id" title="var">IsPointed</span> (<span class="id" title="var">Susp</span> <span class="id" title="var">X</span>) | 0<br/>
&nbsp;&nbsp;:= <span class="id" title="var">North</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ispointed_path_susp</span> `{<span class="id" title="var">IsPointed</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsPointed</span> (<span class="id" title="var">North</span> = <span class="id" title="var">South</span> :&gt; <span class="id" title="var">Susp</span> <span class="id" title="var">X</span>) | 0 := <span class="id" title="var">merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ispointed_path_susp'</span> `{<span class="id" title="var">IsPointed</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsPointed</span> (<span class="id" title="var">South</span> = <span class="id" title="var">North</span> :&gt; <span class="id" title="var">Susp</span> <span class="id" title="var">X</span>) | 0 := (<span class="id" title="var">merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>))^.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">psusp</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="var">pType</span><br/>
&nbsp;&nbsp;:= [<span class="id" title="var">Susp</span> <span class="id" title="var">X</span>, <span class="id" title="var">_</span>].<br/>

<br/>
</div>

<div class="doc">
<a id="lab1307"></a><h2 class="section">Suspension Functor</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">psusp</span></span> has a functorial action.  TODO: make this a displayed functor 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is0functor_psusp</span> : <span class="id" title="var">Is0Functor</span> <span class="id" title="var">psusp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Is0Functor</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">psusp</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="var">Build_pMap</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">X</span>) (<span class="id" title="var">psusp</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">functor_susp</span> <span class="id" title="var">f</span>) 1).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">psusp</span></span> is a 1-functor. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is1functor_psusp</span> : <span class="id" title="var">Is1Functor</span> <span class="id" title="var">psusp</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Is1Functor</span>.<br/>
</div>

<div class="doc">
Action on 2-cells 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pointed_reduce</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Susp_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_paths_FlFr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">Susp_rec_beta_merid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">p</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">concat_Vp</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<div class="doc">
Preservation of identity. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">Build_pHomotopy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">srapply</span> <span class="id" title="var">Susp_ind</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">transport_paths_FFlr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_idmap</span>, <span class="id" title="var">Susp_rec_beta_merid</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">concat_p1</span>, <span class="id" title="var">concat_Vp</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
</div>

<div class="doc">
Preservation of composition. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="var">pointed_reduce_rewrite</span>; <span class="id" title="var">srefine</span> (<span class="id" title="var">Build_pHomotopy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">srapply</span> <span class="id" title="var">Susp_ind</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">transport_paths_FlFr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p1</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p1</span>, <span class="id" title="var">ap_compose</span>, !<span class="id" title="var">Susp_rec_beta_merid</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1308"></a><h2 class="section">Loop-Suspension Adjunction</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Book_Loop_Susp_Adjunction</span>.<br/>

<br/>
</div>

<div class="doc">
Here is the proof of the adjunction isomorphism given in the book (6.5.4); we put it in a non-exported module for reasons discussed below. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_adjoint</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">psusp</span> <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>) &lt;~&gt; (<span class="id" title="var">A</span> -&gt;* <span class="id" title="var">loops</span> <span class="id" title="var">B</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">issig_pmap</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">A</span>) <span class="id" title="var">B</span>)^-1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_functor_sigma_pb</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Q</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">NSm</span> =&gt; <span class="id" title="var">fst</span> <span class="id" title="var">NSm</span>.1 = <span class="id" title="var">point</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">equiv_Susp_rec</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> {<span class="id" title="var">bp</span> : {<span class="id" title="var">b</span>:<span class="id" title="var">B</span> &amp; <span class="id" title="var">b</span> = <span class="id" title="var">point</span> <span class="id" title="var">B</span>} &amp; {<span class="id" title="var">b</span>:<span class="id" title="var">B</span> &amp; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">bp</span>.1 = <span class="id" title="var">b</span>} }.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1:<span class="id" title="var">make_equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_contr_sigma</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_sigma_contr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">A</span> := {<span class="id" title="var">p</span> : <span class="id" title="var">B</span> &amp; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">point</span> <span class="id" title="var">B</span> = <span class="id" title="var">p</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">pm</span> =&gt; { <span class="id" title="var">q</span> : <span class="id" title="var">point</span> <span class="id" title="var">B</span> = <span class="id" title="var">pm</span>.1 &amp; <span class="id" title="var">pm</span>.2 (<span class="id" title="var">point</span> <span class="id" title="var">A</span>) = <span class="id" title="var">q</span> }))^-1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv_contr_basedpaths</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Unfortunately, with this definition it seems to be quite hard to prove that the isomorphism is natural on pointed maps.  The following proof gets partway there, but ends with a pretty intractable goal.  It's also quite slow, so we don't want to compile it all the time. 
<div class="paragraph"> </div>

<pre>
  Definition loop_susp_adjoint_nat_r `{Funext} (A B B' : pType)
             (f : psusp A -&gt;* B) (g : B -&gt;* B')
  : loop_susp_adjoint A B' (g o* f)
    ==* fmap loops g o* loop_susp_adjoint A B f.
  Proof.
    pointed_reduce. (* Very slow for some reason. *)
    srefine (Build_pHomotopy _ _).
    - intros a. simpl.
      refine (_ @ (concat_1p _)^).
      refine (_ @ (concat_p1 _)^).
      rewrite !transport_sigma. simpl.
      rewrite !(transport_arrow_fromconst (B := A)).
      rewrite !transport_paths_Fr.
      rewrite !ap_V, !ap_pr1_path_basedpaths.
      Fail rewrite ap_pp, !(ap_compose f g), ap_V. (* This line fails with current versions of the library. *)
      Fail reflexivity.
      admit.
    - cbn.
      Fail reflexivity.
  Abort.
</pre>
   
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Book_Loop_Susp_Adjunction</span>.<br/>

<br/>
</div>

<div class="doc">
Thus, instead we will construct the adjunction in terms of a unit and counit natural transformation. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_unit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>) : <span class="id" title="var">X</span> -&gt;* <span class="id" title="var">loops</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_pMap</span> <span class="id" title="var">X</span> (<span class="id" title="var">loops</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">X</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">merid</span> <span class="id" title="var">x</span> @ (<span class="id" title="var">merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>))^) (<span class="id" title="var">concat_pV</span> <span class="id" title="var">_</span>).<br/>

<br/>
</div>

<div class="doc">
By Freudenthal, we have that this map is (2n+2)-connected when <span class="inlinecode"><span class="id" title="var">X</span></span> is (n+1)-connected. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">conn_map_loop_susp_unit</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>) `{<span class="id" title="var">IsConnected</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> (<span class="id" title="var">n</span> +2+ <span class="id" title="var">n</span>) (<span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">X</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">conn_map_compose</span> <span class="id" title="var">_</span> <span class="id" title="var">merid</span> (<span class="id" title="var">equiv_concat_r</span> (<span class="id" title="var">merid</span> <span class="id" title="var">pt</span>)^ <span class="id" title="var">_</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We also have this corollary: 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pequiv_ptr_loop_psusp</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>) <span class="id" title="var">n</span> `{<span class="id" title="var">IsConnected</span> <span class="id" title="var">n</span>.+1 <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">pTr</span> (<span class="id" title="var">n</span> +2+ <span class="id" title="var">n</span>) <span class="id" title="var">X</span> &lt;~&gt;* <span class="id" title="var">pTr</span> (<span class="id" title="var">n</span> +2+ <span class="id" title="var">n</span>) (<span class="id" title="var">loops</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">X</span>)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv</span>.<br/>
&nbsp;&nbsp;1:<span class="id" title="var">rapply</span> (<span class="id" title="var">fmap</span> (<span class="id" title="var">pTr</span> <span class="id" title="var">_</span>) (<span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">O_inverts_conn_map</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_unit_natural</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt;* <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">Y</span> <span class="id" title="var">o</span>* <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;==* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">psusp</span> <span class="id" title="var">f</span>) <span class="id" title="var">o</span>* <span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">X</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">pointed_reduce</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Build_pHomotopy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_@</span> (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap_pp</span> (<span class="id" title="var">Susp_rec</span> <span class="id" title="var">North</span> <span class="id" title="var">South</span> (<span class="id" title="var">merid</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merid</span> <span class="id" title="var">x</span>) (<span class="id" title="var">merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>))^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((1 @@ <span class="id" title="var">ap_V</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Susp_rec_beta_merid</span> <span class="id" title="var">_</span> @@ <span class="id" title="var">inverse2</span> (<span class="id" title="var">Susp_rec_beta_merid</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_pV</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">inv_pp</span>, !<span class="id" title="var">concat_pp_p</span>, <span class="id" title="var">concat_1p</span>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_pV_inverse2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Susp_rec_beta_merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>)) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_Vp</span>, <span class="id" title="var">moveL_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap_pp_concat_pV</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_Vp</span>, <span class="id" title="var">moveL_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p1_1</span>, <span class="id" title="var">concat_1p_1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>; <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap_compose</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> =&gt; (<span class="id" title="var">ap</span> (<span class="id" title="var">Susp_rec</span> <span class="id" title="var">North</span> <span class="id" title="var">South</span> (<span class="id" title="var">merid</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>))) <span class="id" title="var">p'</span> @ 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> =&gt; 1 @ <span class="id" title="var">p'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">concat_pV</span> (<span class="id" title="var">merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>))) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap_compose</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">Susp_rec</span> <span class="id" title="var">North</span> <span class="id" title="var">South</span> (<span class="id" title="var">merid</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">p'</span> =&gt; <span class="id" title="var">p'</span> @ 1) <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_counit</span> (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>) : <span class="id" title="var">psusp</span> (<span class="id" title="var">loops</span> <span class="id" title="var">X</span>) -&gt;* <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;:=  <span class="id" title="var">Build_pMap</span> (<span class="id" title="var">psusp</span> (<span class="id" title="var">loops</span> <span class="id" title="var">X</span>)) <span class="id" title="var">X</span> (<span class="id" title="var">Susp_rec</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>) (<span class="id" title="var">point</span> <span class="id" title="var">X</span>) <span class="id" title="var">idmap</span>) 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_counit_natural</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="var">pType</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt;* <span class="id" title="var">Y</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">f</span> <span class="id" title="var">o</span>* <span class="id" title="var">loop_susp_counit</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;==* <span class="id" title="var">loop_susp_counit</span> <span class="id" title="var">Y</span> <span class="id" title="var">o</span>* <span class="id" title="var">fmap</span> <span class="id" title="var">psusp</span> (<span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">pointed_reduce</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Build_pHomotopy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Susp_ind</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_paths_FlFr</span>, <span class="id" title="var">ap_compose</span>, <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap_compose</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Susp_rec</span> <span class="id" title="var">North</span> <span class="id" title="var">South</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> =&gt; <span class="id" title="var">merid</span> (1 @ (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">x0</span> @ 1))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Susp_rec</span> (<span class="id" title="var">point</span> <span class="id" title="var">Y</span>) (<span class="id" title="var">point</span> <span class="id" title="var">Y</span>) <span class="id" title="var">idmap</span>) (<span class="id" title="var">merid</span> <span class="id" title="var">p</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Susp_rec_beta_merid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>). <span class="id" title="var">f_ap</span>. <span class="id" title="var">f_ap</span>. <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Susp_rec_beta_merid</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now the triangle identities 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_triangle1</span> (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> (<span class="id" title="var">loop_susp_counit</span> <span class="id" title="var">X</span>) <span class="id" title="var">o</span>* <span class="id" title="var">loop_susp_unit</span> (<span class="id" title="var">loops</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;==* <span class="id" title="var">pmap_idmap</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Build_pHomotopy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span> @ (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap_pp</span> (<span class="id" title="var">Susp_rec</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>) (<span class="id" title="var">point</span> <span class="id" title="var">X</span>) <span class="id" title="var">idmap</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">merid</span> <span class="id" title="var">p</span>) (<span class="id" title="var">merid</span> (<span class="id" title="var">point</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span> = <span class="id" title="var">point</span> <span class="id" title="var">X</span>)))^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((1 @@ <span class="id" title="var">ap_V</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">Susp_rec_beta_merid</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ <span class="id" title="var">inverse2</span> (<span class="id" title="var">Susp_rec_beta_merid</span> (<span class="id" title="var">point</span> (<span class="id" title="var">loops</span> <span class="id" title="var">X</span>)))) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_pV</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span> <span class="id" title="var">x</span>]; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">point</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_pV_inverse2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ap</span> (<span class="id" title="var">Susp_rec</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> <span class="id" title="var">idmap</span>) (<span class="id" title="var">merid</span> 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 (<span class="id" title="var">Susp_rec_beta_merid</span> 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">ap_pp_concat_pV</span> (<span class="id" title="var">Susp_rec</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> <span class="id" title="var">idmap</span>) (<span class="id" title="var">merid</span> 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_compose</span>, (<span class="id" title="var">ap_compose</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">p</span> @ 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_1p_1</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">concat_p1_1</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_triangle2</span> (<span class="id" title="var">X</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">loop_susp_counit</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">X</span>) <span class="id" title="var">o</span>* <span class="id" title="var">fmap</span> <span class="id" title="var">psusp</span> (<span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;==* <span class="id" title="var">pmap_idmap</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Build_pHomotopy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;[ <span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">Susp_ind</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) | ]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">merid</span> (<span class="id" title="var">point</span> <span class="id" title="var">X</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_paths_FlFr</span>, <span class="id" title="var">ap_idmap</span>, <span class="id" title="var">ap_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Susp_rec_beta_merid</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_pM</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">inverse2</span> (<span class="id" title="var">Susp_rec_beta_merid</span> <span class="id" title="var">_</span>) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">inv_pp</span>, <span class="id" title="var">inv_V</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now we can finally construct the adjunction equivalence. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_adjoint</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">psusp</span> <span class="id" title="var">A</span> -&gt;** <span class="id" title="var">B</span>) &lt;~&gt;* (<span class="id" title="var">A</span> -&gt;** <span class="id" title="var">loops</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_pEquiv'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_adjointify</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> =&gt; <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span> <span class="id" title="var">o</span>* <span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">g</span> =&gt; <span class="id" title="var">loop_susp_counit</span> <span class="id" title="var">B</span> <span class="id" title="var">o</span>* <span class="id" title="var">fmap</span> <span class="id" title="var">psusp</span> <span class="id" title="var">g</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">g</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_pforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_prewhisker</span> <span class="id" title="var">_</span> (<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_postwhisker</span> <span class="id" title="var">_</span> (<span class="id" title="var">loop_susp_unit_natural</span> <span class="id" title="var">g</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_prewhisker</span> <span class="id" title="var">g</span> (<span class="id" title="var">loop_susp_triangle1</span> <span class="id" title="var">B</span>) @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pmap_postcompose_idmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_pforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_postwhisker</span> <span class="id" title="var">_</span> (<span class="id" title="var">fmap_comp</span> <span class="id" title="var">psusp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_prewhisker</span> <span class="id" title="var">_</span> (<span class="id" title="var">loop_susp_counit_natural</span> <span class="id" title="var">f</span>)^* @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pmap_postwhisker</span> <span class="id" title="var">f</span> (<span class="id" title="var">loop_susp_triangle2</span> <span class="id" title="var">A</span>) @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pmap_precompose_idmap</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">path_pforall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv_adjointify</span>, <span class="id" title="var">equiv_fun</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">pmap_prewhisker</span> <span class="id" title="var">_</span> <span class="id" title="var">fmap_loops_pconst</span> @* <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">cat_zero_l</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
And its naturality is easy. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_adjoint_nat_r</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">psusp</span> <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt;* <span class="id" title="var">B'</span>) : <span class="id" title="var">loop_susp_adjoint</span> <span class="id" title="var">A</span> <span class="id" title="var">B'</span> (<span class="id" title="var">g</span> <span class="id" title="var">o</span>* <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;==* <span class="id" title="var">fmap</span> <span class="id" title="var">loops</span> <span class="id" title="var">g</span> <span class="id" title="var">o</span>* <span class="id" title="var">loop_susp_adjoint</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @* <span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pmap_prewhisker</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">loop_susp_adjoint_nat_l</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt;* <span class="id" title="var">loops</span> <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">A'</span> -&gt;* <span class="id" title="var">A</span>) : (<span class="id" title="var">loop_susp_adjoint</span> <span class="id" title="var">A'</span> <span class="id" title="var">B</span>)^-1 (<span class="id" title="var">f</span> <span class="id" title="var">o</span>* <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;==* (<span class="id" title="var">loop_susp_adjoint</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)^-1 <span class="id" title="var">f</span> <span class="id" title="var">o</span>* <span class="id" title="var">fmap</span> <span class="id" title="var">psusp</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @* (<span class="id" title="var">pmap_compose_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^*).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pmap_postwhisker</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">fmap_comp</span> <span class="id" title="var">psusp</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">is1natural_loop_susp_adjoint_r</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">Is1Natural</span> (<span class="id" title="var">opyon</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">A</span>)) (<span class="id" title="var">opyon</span> <span class="id" title="var">A</span> <span class="id" title="var">o</span> <span class="id" title="var">loops</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">loop_susp_adjoint</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_Is1Natural</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">B</span> <span class="id" title="var">B'</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ( <span class="id" title="var">_</span> @ <span class="id" title="var">cat_assoc_strong</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> <span class="id" title="var">o</span>* <span class="id" title="var">loop_susp_unit</span> <span class="id" title="var">A</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_pforall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">fmap_comp</span> <span class="id" title="var">loops</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">natequiv_loop_susp_adjoint_r</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">A</span> : <span class="id" title="var">pType</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">NatEquiv</span> (<span class="id" title="var">opyon</span> (<span class="id" title="var">psusp</span> <span class="id" title="var">A</span>)) (<span class="id" title="var">opyon</span> <span class="id" title="var">A</span> <span class="id" title="var">o</span> <span class="id" title="var">loops</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">Build_NatEquiv</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>