<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Pullback</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Pullback</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span> <span class="id" title="var">HoTT.Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HFiber</span> <span class="id" title="var">PathAny</span> <span class="id" title="var">Cubical.PathSquare</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Diagrams.CommutativeSquares</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1193"></a><h1 class="section">Pullbacks</h1>

<div class="paragraph"> </div>

 The pullback as an object 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Pullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;:= { <span class="id" title="var">b</span> : <span class="id" title="var">B</span> &amp; { <span class="id" title="var">c</span> : <span class="id" title="var">C</span> &amp; <span class="id" title="var">f</span> <span class="id" title="var">b</span> = <span class="id" title="var">g</span> <span class="id" title="var">c</span> }}.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <span class="id" title="var">Pullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>}%<span class="id" title="var">_type_scope</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>)%<span class="id" title="var">_function_scope</span>.<br/>

<br/>
</div>

<div class="doc">
The universal commutative square 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_pr1</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>}<br/>
: <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">B</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="var">z</span>.1).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_pr2</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>}<br/>
: <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">C</span> := (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="var">z</span>.2.1).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_commsq</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
: <span class="id" title="var">f</span> <span class="id" title="var">o</span> <span class="id" title="var">pullback_pr1</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">pullback_pr2</span><br/>
:= (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="var">z</span>.2.2).<br/>

<br/>
</div>

<div class="doc">
The universally induced map into it by any commutative square 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_corec</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
: <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span><br/>
:= <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; (<span class="id" title="var">f</span> <span class="id" title="var">a</span> ; <span class="id" title="var">h</span> <span class="id" title="var">a</span> ; <span class="id" title="var">p</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_corec_uncurried</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>)<br/>
&nbsp;&nbsp;: { <span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> &amp; { <span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span> &amp; <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span> }} -&gt; (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">f</span> [<span class="id" title="var">h</span> <span class="id" title="var">p</span>]].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pullback_corec</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isequiv_pullback_corec</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsEquiv</span> (@<span class="id" title="var">pullback_corec_uncurried</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">isequiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">pullback_pr1</span> <span class="id" title="var">o</span> <span class="id" title="var">m</span> ; <span class="id" title="var">pullback_pr2</span> <span class="id" title="var">o</span> <span class="id" title="var">m</span> ; (<span class="id" title="var">pullback_commsq</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>) <span class="id" title="var">o</span> <span class="id" title="var">m</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_pullback_corec</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>)<br/>
&nbsp;&nbsp;: { <span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> &amp; { <span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span> &amp; <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span> }} &lt;~&gt; (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">isequiv_pullback_corec</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>).<br/>

<br/>
</div>

<div class="doc">
A homotopy commutative square is equivalent to a pullback of arrow types 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_ispullback_commsq</span> `{<span class="id" title="var">Funext</span>} {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} (<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>)<br/>
&nbsp;&nbsp;: { <span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span> &amp; { <span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span> &amp; <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span> }}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; @<span class="id" title="var">Pullback</span> (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> =&gt; <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_forall</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The diagonal of a map 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">diagonal</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">x</span>;<span class="id" title="var">x</span>;<span class="id" title="var">idpath</span>).<br/>

<br/>
</div>

<div class="doc">
The fiber of the diagonal is a path-space in the fiber. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_diagonal</span> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">hfiber</span> (<span class="id" title="var">diagonal</span> <span class="id" title="var">f</span>) <span class="id" title="var">p</span> &lt;~&gt;  ((<span class="id" title="var">p</span>.1 ; <span class="id" title="var">p</span>.2.2) = (<span class="id" title="var">p</span>.2.1 ; <span class="id" title="var">idpath</span>) :&gt; <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> (<span class="id" title="var">f</span> <span class="id" title="var">p</span>.2.1)).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x1</span> [<span class="id" title="var">x2</span> <span class="id" title="var">p</span>]]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_functor_sigma_id</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1)); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_sigma_assoc'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_contr_sigma</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_inverse</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Symmetry of the pullback 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_pullback_symm</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
: <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> &lt;~&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_sigma_symm</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">b</span> = <span class="id" title="var">g</span> <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_inverse</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Pullback over <span class="inlinecode"><span class="id" title="var">Unit</span></span> is equivalent to a product. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_pullback_unit_prod</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>)<br/>
: <span class="id" title="var">Pullback</span> (<span class="id" title="var">const_tt</span> <span class="id" title="var">A</span>) (<span class="id" title="var">const_tt</span> <span class="id" title="var">B</span>) &lt;~&gt; <span class="id" title="var">A</span> * <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simple</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_adjointify</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> [<span class="id" title="var">b</span> <span class="id" title="var">_</span>]]; <span class="id" title="tactic">exact</span> (<span class="id" title="var">a</span> , <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>]; <span class="id" title="tactic">exact</span> (<span class="id" title="var">a</span> ; <span class="id" title="var">b</span> ; 1).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">b</span>]; <span class="id" title="tactic">exact</span> 1.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> [<span class="id" title="var">b</span> <span class="id" title="var">p</span>]]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">path_sigma'</span> <span class="id" title="var">_</span> 1); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">path_sigma'</span> <span class="id" title="var">_</span> 1); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_contr</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The property of a given commutative square being a pullback 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">IsPullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">pullback_corec</span> <span class="id" title="var">p</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_ispullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">ip</span> : <span class="id" title="var">IsPullback</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">A</span> &lt;~&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pullback_corec</span> <span class="id" title="var">p</span>) <span class="id" title="var">ip</span>.<br/>

<br/>
</div>

<div class="doc">
This is equivalent to the transposed square being a pullback. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ispullback_symm</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span> == <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>) (<span class="id" title="var">pb</span> : <span class="id" title="var">IsPullback</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; (<span class="id" title="var">p</span> <span class="id" title="var">a</span>)^))<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">cancelL_isequiv</span> (<span class="id" title="var">equiv_pullback_symm</span> <span class="id" title="var">g</span> <span class="id" title="var">k</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pb</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The pullback of the projections <span class="inlinecode">{<span class="id" title="var">d</span>:<span class="id" title="var">D</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">d</span>}</span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">D</span></span> <span class="inlinecode">&lt;-</span> <span class="inlinecode">{<span class="id" title="var">d</span>:<span class="id" title="var">D</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">d</span>}</span> is equivalent to <span class="inlinecode">{<span class="id" title="var">d</span>:<span class="id" title="var">D</span></span> <span class="inlinecode">&amp;</span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">d</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">d</span>}</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ispullback_sigprod</span> {<span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">D</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span>:{<span class="id" title="var">d</span>:<span class="id" title="var">D</span> &amp; <span class="id" title="var">P</span> <span class="id" title="var">d</span> * <span class="id" title="var">Q</span> <span class="id" title="var">d</span>} =&gt; 1%<span class="id" title="var">path</span> : (<span class="id" title="var">z</span>.1;<span class="id" title="var">fst</span> <span class="id" title="var">z</span>.2).1 = (<span class="id" title="var">z</span>.1;<span class="id" title="var">snd</span> <span class="id" title="var">z</span>.2).1).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">isequiv_adjointify</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[<span class="id" title="var">d1</span> <span class="id" title="var">p</span>] [[<span class="id" title="var">d2</span> <span class="id" title="var">q</span>] <span class="id" title="var">e</span>]]; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">d1</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span>, <span class="id" title="var">e</span>^ # <span class="id" title="var">q</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[<span class="id" title="var">d1</span> <span class="id" title="var">p</span>] [[<span class="id" title="var">d2</span> <span class="id" title="var">q</span>] <span class="id" title="var">e</span>]]; <span class="id" title="tactic">unfold</span> <span class="id" title="var">pullback_corec</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">d</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>]]; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_sigprod_pullback</span> {<span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">D</span> -&gt; <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;: {<span class="id" title="var">d</span>:<span class="id" title="var">D</span> &amp; <span class="id" title="var">P</span> <span class="id" title="var">d</span> * <span class="id" title="var">Q</span> <span class="id" title="var">d</span>} &lt;~&gt; <span class="id" title="var">Pullback</span> (@<span class="id" title="var">pr1</span> <span class="id" title="var">D</span> <span class="id" title="var">P</span>) (@<span class="id" title="var">pr1</span> <span class="id" title="var">D</span> <span class="id" title="var">Q</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">ispullback_sigprod</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>).<br/>

<br/>
</div>

<div class="doc">
For any commutative square, the fiber of the fibers is equivalent to the fiber of the "gap map" <span class="inlinecode"><span class="id" title="var">pullback_corec</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_pullback_corec</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">C</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">k</span> <span class="id" title="var">b</span> = <span class="id" title="var">g</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">hfiber</span> (<span class="id" title="var">pullback_corec</span> <span class="id" title="var">p</span>) (<span class="id" title="var">b</span>; <span class="id" title="var">c</span>; <span class="id" title="var">q</span>) &lt;~&gt; <span class="id" title="var">hfiber</span> (<span class="id" title="var">functor_hfiber</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>) (<span class="id" title="var">c</span>; <span class="id" title="var">q</span>^).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hfiber</span>, <span class="id" title="var">functor_hfiber</span>, <span class="id" title="var">functor_sigma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_sigma_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">p0</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">transport_sigma'</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">oE</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">p1</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">transport_paths_Fr</span>, !<span class="id" title="var">transport_paths_Fl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_ap</span> (<span class="id" title="var">equiv_path_inverse</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>)); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_concat_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">inv_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^). <span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerL</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">inv_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^). <span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerL</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">inv_V</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
If the induced maps on fibers are equivalences, then a square is a pullback. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ispullback_isequiv_functor_hfiber</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">e</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>:<span class="id" title="var">B</span>, <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">functor_hfiber</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsPullback</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_contr_map</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">contr_equiv'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">hfiber_pullback_corec</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Conversely, if the square is a pullback then the induced maps on fibers are equivalences. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isequiv_functor_hfiber_ispullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">e</span> : <span class="id" title="var">IsPullback</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>:<span class="id" title="var">B</span>, <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">functor_hfiber</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_from_functor_sigma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsPullback</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">isequiv_commsq'</span>.<br/>
&nbsp;&nbsp;4: <span class="id" title="tactic">exact</span> (<span class="id" title="var">equiv_fibration_replacement</span> <span class="id" title="var">f</span>)^-1%<span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">Pullback</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>).<br/>
&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">pullback_corec</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> (<span class="id" title="var">functor_sigma</span> <span class="id" title="var">idmap</span>); <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">functor_sigma</span> <span class="id" title="var">idmap</span>); <span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inverse</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> [<span class="id" title="var">y</span> <span class="id" title="var">q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">path_sigma'</span> <span class="id" title="var">_</span> <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">path_sigma'</span> <span class="id" title="var">_</span> <span class="id" title="var">idpath</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span>^ @ (<span class="id" title="var">inv_Vp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">concat_1p</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The pullback of a map along another one 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_along</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
: <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">B</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">pr1</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;f ^*" := (<span class="id" title="var">pullback_along</span> <span class="id" title="var">f</span>) : <span class="id" title="var">function_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_pullback_along</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">b</span>:<span class="id" title="var">B</span>)<br/>
: <span class="id" title="var">hfiber</span> (<span class="id" title="var">f</span> ^* <span class="id" title="var">g</span>) <span class="id" title="var">b</span> &lt;~&gt; <span class="id" title="var">hfiber</span> <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_functor_sigma_id</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> =&gt; <span class="id" title="var">equiv_path_inverse</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">make_equiv_contr_basedpaths</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
And the dual sort of pullback 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_along'</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>)<br/>
: <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> -&gt; <span class="id" title="var">C</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="var">z</span>.2.1.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">pullback_along'</span> / .<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;g ^*'" := (<span class="id" title="var">pullback_along'</span> <span class="id" title="var">g</span>) : <span class="id" title="var">function_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_pullback_along'</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">c</span>:<span class="id" title="var">C</span>)<br/>
: <span class="id" title="var">hfiber</span> (<span class="id" title="var">g</span> ^*' <span class="id" title="var">f</span>) <span class="id" title="var">c</span> &lt;~&gt; <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">make_equiv_contr_basedpaths</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
A version where <span class="inlinecode"><span class="id" title="var">g</span></span> is pointed, but we unbundle the pointed condition to avoid importing pointed types. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_pullback_along_pointed</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} {<span class="id" title="var">c</span> : <span class="id" title="var">C</span>} {<span class="id" title="var">a</span> : <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">g</span> <span class="id" title="var">c</span> = <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">hfiber</span> (<span class="id" title="var">g</span> ^*' <span class="id" title="var">f</span>) <span class="id" title="var">c</span> &lt;~&gt; <span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">hfiber_pullback_along'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> (<span class="id" title="var">equiv_functor_hfiber2</span> (<span class="id" title="var">h</span>:=<span class="id" title="var">equiv_idmap</span>) (<span class="id" title="var">k</span>:=<span class="id" title="var">equiv_idmap</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Functor_Pullback</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">A1</span> <span class="id" title="var">B1</span> <span class="id" title="var">C1</span> <span class="id" title="var">A2</span> <span class="id" title="var">B2</span> <span class="id" title="var">C2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f1</span> : <span class="id" title="var">B1</span> -&gt; <span class="id" title="var">A1</span>) (<span class="id" title="var">g1</span> : <span class="id" title="var">C1</span> -&gt; <span class="id" title="var">A1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f2</span> : <span class="id" title="var">B2</span> -&gt; <span class="id" title="var">A2</span>) (<span class="id" title="var">g2</span> : <span class="id" title="var">C2</span> -&gt; <span class="id" title="var">A2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">A1</span> -&gt; <span class="id" title="var">A2</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">B1</span> -&gt; <span class="id" title="var">B2</span>) (<span class="id" title="var">l</span> : <span class="id" title="var">C1</span> -&gt; <span class="id" title="var">C2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">f2</span> <span class="id" title="var">o</span> <span class="id" title="var">k</span> == <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">f1</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">g2</span> <span class="id" title="var">o</span> <span class="id" title="var">l</span> == <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">g1</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">functor_pullback</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">f1</span> <span class="id" title="var">g1</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">f2</span> <span class="id" title="var">g2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">functor_sigma</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">b1</span> =&gt; (<span class="id" title="var">functor_sigma</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">c1</span> <span class="id" title="var">e1</span> =&gt; <span class="id" title="var">p</span> <span class="id" title="var">b1</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">h</span> <span class="id" title="var">e1</span> @ (<span class="id" title="var">q</span> <span class="id" title="var">c1</span>)^))).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber_functor_pullback</span> (<span class="id" title="var">z</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">f2</span> <span class="id" title="var">g2</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">hfiber</span> <span class="id" title="var">functor_pullback</span> <span class="id" title="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">Pullback</span> (<span class="id" title="var">transport</span> (<span class="id" title="var">hfiber</span> <span class="id" title="var">h</span>) <span class="id" title="var">z</span>.2.2 <span class="id" title="var">o</span> <span class="id" title="var">functor_hfiber</span> (<span class="id" title="var">k</span> := <span class="id" title="var">f2</span>) <span class="id" title="var">p</span> <span class="id" title="var">z</span>.1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">functor_hfiber</span> <span class="id" title="var">q</span> <span class="id" title="var">z</span>.2.1).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b2</span> [<span class="id" title="var">c2</span> <span class="id" title="var">e2</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">hfiber_functor_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">b1</span> <span class="id" title="var">e1</span>]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> (<span class="id" title="var">transport_sigma'</span> <span class="id" title="var">e1</span>^ (<span class="id" title="var">c2</span>; <span class="id" title="var">e2</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">hfiber_functor_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">c1</span> <span class="id" title="var">e3</span>]; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">e3</span>^ # <span class="id" title="var">e</span>) (<span class="id" title="var">transport_paths_Fl</span> <span class="id" title="var">e1</span>^ <span class="id" title="var">e2</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> (<span class="id" title="var">transport_paths_Fr</span> <span class="id" title="var">e3</span>^ <span class="id" title="var">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">functor_hfiber</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_l</span> (<span class="id" title="var">transport_sigma'</span> <span class="id" title="var">e2</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">e0</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_l</span> (<span class="id" title="var">transport_paths_Fl</span> <span class="id" title="var">e0</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_l</span> (<span class="id" title="var">whiskerL</span> (<span class="id" title="var">ap</span> <span class="id" title="var">h</span> <span class="id" title="var">e0</span>)^ (<span class="id" title="var">transport_paths_r</span> <span class="id" title="var">e2</span> <span class="id" title="var">_</span>)) <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_moveR_Vp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_l</span> (<span class="id" title="var">concat_pp_p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_moveR_Vp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_r</span> (<span class="id" title="var">concat_pp_p</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_moveL_pM</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">abstract</span> (<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">ap_V</span>, <span class="id" title="var">inv_V</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_path_inverse</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Functor_Pullback</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">EquivPullback</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">A'</span> <span class="id" title="var">B'</span> <span class="id" title="var">C'</span> <span class="id" title="var">f'</span> <span class="id" title="var">g'</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eA</span> : <span class="id" title="var">A</span> &lt;~&gt; <span class="id" title="var">A'</span>) (<span class="id" title="var">eB</span> : <span class="id" title="var">B</span> &lt;~&gt; <span class="id" title="var">B'</span>) (<span class="id" title="var">eC</span> : <span class="id" title="var">C</span> &lt;~&gt; <span class="id" title="var">C'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">f'</span> <span class="id" title="var">o</span> <span class="id" title="var">eB</span> == <span class="id" title="var">eA</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>) (<span class="id" title="var">q</span> :  <span class="id" title="var">g'</span> <span class="id" title="var">o</span> <span class="id" title="var">eC</span> == <span class="id" title="var">eA</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equiv_pullback</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> &lt;~&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">f'</span> <span class="id" title="var">g'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Pullback</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">equiv_functor_sigma'</span> <span class="id" title="var">eB</span>); <span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">equiv_functor_sigma'</span> <span class="id" title="var">eC</span>); <span class="id" title="tactic">intro</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_l</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_concat_r</span> (<span class="id" title="var">q</span> <span class="id" title="var">_</span>)^ <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_ap'</span> <span class="id" title="var">eA</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">EquivPullback</span>.<br/>

<br/>
</div>

<div class="doc">
Pullbacks commute with sigmas 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <span class="id" title="var">PullbackSigma</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="keyword">Type</span>} {<span class="id" title="var">B</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="keyword">Type</span>} {<span class="id" title="var">C</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">Z</span> -&gt; <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">B</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">A</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">C</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">A</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_sigma_pullback</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: {<span class="id" title="var">p</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> &amp; <span class="id" title="var">Pullback</span> (<span class="id" title="var">transport</span> <span class="id" title="var">A</span> <span class="id" title="var">p</span>.2.2 <span class="id" title="var">o</span> <span class="id" title="var">r</span> <span class="id" title="var">p</span>.1) (<span class="id" title="var">s</span> <span class="id" title="var">p</span>.2.1)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">Pullback</span> (<span class="id" title="var">functor_sigma</span> <span class="id" title="var">f</span> <span class="id" title="var">r</span>) (<span class="id" title="var">functor_sigma</span> <span class="id" title="var">g</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_functor_sigma_id</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equiv_functor_sigma_id</span> <span class="id" title="var">_</span>) <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">equiv_path_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">make_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">PullbackSigma</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1194"></a><h2 class="section">Paths in pullbacks</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_pullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;: { <span class="id" title="var">p</span> : <span class="id" title="var">x</span>.1 = <span class="id" title="var">y</span>.1 &amp; { <span class="id" title="var">q</span> : <span class="id" title="var">x</span>.2.1 = <span class="id" title="var">y</span>.2.1 &amp; <span class="id" title="var">PathSquare</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) (<span class="id" title="var">ap</span> <span class="id" title="var">g</span> <span class="id" title="var">q</span>) <span class="id" title="var">x</span>.2.2 <span class="id" title="var">y</span>.2.2 } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">y</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">equiv_path_from_contr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">exists</span> <span class="id" title="var">idpath</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">idpath</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">sq_refl_v</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">b</span> [<span class="id" title="var">c</span> <span class="id" title="var">p</span>]]; <span class="id" title="tactic">unfold</span> <span class="id" title="var">Pullback</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">contr_sigsig</span> <span class="id" title="var">b</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">contr_sigsig</span> <span class="id" title="var">c</span> (<span class="id" title="var">idpath</span> <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">contr_equiv'</span> {<span class="id" title="var">p'</span> : <span class="id" title="var">f</span> <span class="id" title="var">b</span> = <span class="id" title="var">g</span> <span class="id" title="var">c</span> &amp; <span class="id" title="var">p</span> = <span class="id" title="var">p'</span>}).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">p'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sq_1G</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Maps into pullbacks are determined by their composites with the projections, and a coherence.  This can also be proved directly.  With <span class="inlinecode"><span class="id" title="var">Funext</span></span>, we could also prove an equivalence analogous to <span class="inlinecode"><span class="id" title="var">equiv_path_pullback_rec_hset</span></span> below.  Not sure of the best name for this version. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pullback_homotopic</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">k</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p1</span> : <span class="id" title="var">pullback_pr1</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">pullback_pr1</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p2</span> : <span class="id" title="var">pullback_pr2</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">pullback_pr2</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">q</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, (<span class="id" title="var">ap</span> <span class="id" title="var">k</span>) (<span class="id" title="var">p1</span> <span class="id" title="var">a</span>) @ (<span class="id" title="var">h</span> <span class="id" title="var">a</span>).2.2 = (<span class="id" title="var">f</span> <span class="id" title="var">a</span>).2.2 @ (<span class="id" title="var">ap</span> <span class="id" title="var">g</span>) (<span class="id" title="var">p2</span> <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">f</span> == <span class="id" title="var">h</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_pullback</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">p1</span> <span class="id" title="var">a</span>). <span class="id" title="tactic">exists</span> (<span class="id" title="var">p2</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">sq_path</span>, <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
When <span class="inlinecode"><span class="id" title="var">A</span></span> is a set, the <span class="inlinecode"><span class="id" title="var">PathSquare</span></span> becomes trivial. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_pullback_hset</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>} `{<span class="id" title="var">IsHSet</span> <span class="id" title="var">A</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">x</span>.1 = <span class="id" title="var">y</span>.1) * (<span class="id" title="var">x</span>.2.1 = <span class="id" title="var">y</span>.2.1) &lt;~&gt; (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_path_pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>^-1%<span class="id" title="var">equiv</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_sigma_prod</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">pq</span> =&gt; <span class="id" title="var">PathSquare</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">fst</span> <span class="id" title="var">pq</span>)) (<span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">snd</span> <span class="id" title="var">pq</span>)) (<span class="id" title="var">x</span>.2).2 (<span class="id" title="var">y</span>.2).2)).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">equiv_sigma_contr</span>. <span class="comment">(*&nbsp;Uses&nbsp;<span class="inlinecode"><span class="id" title="var">istrunc_sq</span></span>.&nbsp;*)</span><br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equiv_path_pullback_rec_hset</span> `{<span class="id" title="var">Funext</span>} {<span class="id" title="var">A</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">IsHSet</span> <span class="id" title="var">Z</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Z</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">Z</span>) (<span class="id" title="var">phi</span> <span class="id" title="var">psi</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;: ((<span class="id" title="var">pullback_pr1</span> <span class="id" title="var">o</span> <span class="id" title="var">phi</span> == <span class="id" title="var">pullback_pr1</span> <span class="id" title="var">o</span> <span class="id" title="var">psi</span>) * (<span class="id" title="var">pullback_pr2</span> <span class="id" title="var">o</span> <span class="id" title="var">phi</span> == <span class="id" title="var">pullback_pr2</span> <span class="id" title="var">o</span> <span class="id" title="var">psi</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; (<span class="id" title="var">phi</span> == <span class="id" title="var">psi</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_prod_coind</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">equiv_functor_forall_id</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_pullback_hset</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The 3x3 Lemma 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pullback3x3</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">A00</span> <span class="id" title="var">A02</span> <span class="id" title="var">A04</span> <span class="id" title="var">A20</span> <span class="id" title="var">A22</span> <span class="id" title="var">A24</span> <span class="id" title="var">A40</span> <span class="id" title="var">A42</span> <span class="id" title="var">A44</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f01</span> : <span class="id" title="var">A00</span> -&gt; <span class="id" title="var">A02</span>) (<span class="id" title="var">f03</span> : <span class="id" title="var">A04</span> -&gt; <span class="id" title="var">A02</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f10</span> : <span class="id" title="var">A00</span> -&gt; <span class="id" title="var">A20</span>) (<span class="id" title="var">f12</span> : <span class="id" title="var">A02</span> -&gt; <span class="id" title="var">A22</span>) (<span class="id" title="var">f14</span> : <span class="id" title="var">A04</span> -&gt; <span class="id" title="var">A24</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f21</span> : <span class="id" title="var">A20</span> -&gt; <span class="id" title="var">A22</span>) (<span class="id" title="var">f23</span> : <span class="id" title="var">A24</span> -&gt; <span class="id" title="var">A22</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f30</span> : <span class="id" title="var">A40</span> -&gt; <span class="id" title="var">A20</span>) (<span class="id" title="var">f32</span> : <span class="id" title="var">A42</span> -&gt; <span class="id" title="var">A22</span>) (<span class="id" title="var">f34</span> : <span class="id" title="var">A44</span> -&gt; <span class="id" title="var">A24</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f41</span> : <span class="id" title="var">A40</span> -&gt; <span class="id" title="var">A42</span>) (<span class="id" title="var">f43</span> : <span class="id" title="var">A44</span> -&gt; <span class="id" title="var">A42</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H11</span> : <span class="id" title="var">f12</span> <span class="id" title="var">o</span> <span class="id" title="var">f01</span> == <span class="id" title="var">f21</span> <span class="id" title="var">o</span> <span class="id" title="var">f10</span>) (<span class="id" title="var">H13</span> : <span class="id" title="var">f12</span> <span class="id" title="var">o</span> <span class="id" title="var">f03</span> == <span class="id" title="var">f23</span> <span class="id" title="var">o</span> <span class="id" title="var">f14</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H31</span> : <span class="id" title="var">f32</span> <span class="id" title="var">o</span> <span class="id" title="var">f41</span> == <span class="id" title="var">f21</span> <span class="id" title="var">o</span> <span class="id" title="var">f30</span>) (<span class="id" title="var">H33</span> : <span class="id" title="var">f32</span> <span class="id" title="var">o</span> <span class="id" title="var">f43</span> == <span class="id" title="var">f23</span> <span class="id" title="var">o</span> <span class="id" title="var">f34</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">fX1</span> := <span class="id" title="var">functor_pullback</span> <span class="id" title="var">f10</span> <span class="id" title="var">f30</span> <span class="id" title="var">f12</span> <span class="id" title="var">f32</span> <span class="id" title="var">f21</span> <span class="id" title="var">f01</span> <span class="id" title="var">f41</span> <span class="id" title="var">H11</span> <span class="id" title="var">H31</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">fX3</span> := <span class="id" title="var">functor_pullback</span> <span class="id" title="var">f14</span> <span class="id" title="var">f34</span> <span class="id" title="var">f12</span> <span class="id" title="var">f32</span> <span class="id" title="var">f23</span> <span class="id" title="var">f03</span> <span class="id" title="var">f43</span> <span class="id" title="var">H13</span> <span class="id" title="var">H33</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">f1X</span> := <span class="id" title="var">functor_pullback</span> <span class="id" title="var">f01</span> <span class="id" title="var">f03</span> <span class="id" title="var">f21</span> <span class="id" title="var">f23</span> <span class="id" title="var">f12</span> <span class="id" title="var">f10</span> <span class="id" title="var">f14</span> (<span class="id" title="tactic">symmetry</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H11</span>) (<span class="id" title="tactic">symmetry</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H13</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">f3X</span> := <span class="id" title="var">functor_pullback</span> <span class="id" title="var">f41</span> <span class="id" title="var">f43</span> <span class="id" title="var">f21</span> <span class="id" title="var">f23</span> <span class="id" title="var">f32</span> <span class="id" title="var">f30</span> <span class="id" title="var">f34</span> (<span class="id" title="tactic">symmetry</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H31</span>) (<span class="id" title="tactic">symmetry</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H33</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">pullback3x3</span> : <span class="id" title="var">Pullback</span> <span class="id" title="var">fX1</span> <span class="id" title="var">fX3</span> &lt;~&gt; <span class="id" title="var">Pullback</span> <span class="id" title="var">f1X</span> <span class="id" title="var">f3X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,3:<span class="id" title="tactic">do</span> 2 (<span class="id" title="var">rapply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intro</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1:<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_pullback</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1:<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_pullback</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 4 (<span class="id" title="var">rapply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intro</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">sq_tr</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">sq_move_14</span>^-1 <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">sq_move_31</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">sq_move_24</span>^-1 <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">sq_move_23</span>^-1 <span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 2 <span class="id" title="var">inv_V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">make_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pullback3x3</span>.<br/>

<br/>
</div>

<div class="doc">
Pasting for pullbacks (or 2-pullbacks lemma) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Pasting</span>.<br/>

<br/>
</div>

<div class="doc">
Given the following diagram where the right square is a pullback square, then the outer square is a pullback square if and only if the left square is a pullback. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="comment">(*&nbsp;A&nbsp;--k--&gt;&nbsp;B&nbsp;--l--&gt;&nbsp;C<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;&nbsp;comm&nbsp;&nbsp;g&nbsp;&nbsp;comm&nbsp;&nbsp;h<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;--i--&gt;&nbsp;Y&nbsp;--j--&gt;&nbsp;Z&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">k</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">l</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">C</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">X</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">Y</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">Z</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">i</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Y</span>} {<span class="id" title="var">j</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">Z</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="var">i</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">k</span>) (<span class="id" title="var">K</span> : <span class="id" title="var">j</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span> == <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">l</span>) {<span class="id" title="var">e1</span> : <span class="id" title="var">IsPullback</span> <span class="id" title="var">K</span>}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">ispullback_pasting_left</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> (<span class="id" title="var">comm_square_comp'</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span>) -&gt; <span class="id" title="var">IsPullback</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ispullback_isequiv_functor_hfiber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">e1'</span> := <span class="id" title="var">isequiv_functor_hfiber_ispullback</span> <span class="id" title="var">_</span> <span class="id" title="var">e1</span> (<span class="id" title="var">i</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">e2'</span> := <span class="id" title="var">isequiv_functor_hfiber_ispullback</span> <span class="id" title="var">_</span> <span class="id" title="var">e2</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">isequiv_commsq'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;7: <span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_idmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4: <span class="id" title="tactic">apply</span> (<span class="id" title="var">functor_hfiber_compose</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">ispullback_pasting_outer</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> <span class="id" title="var">H</span> -&gt; <span class="id" title="var">IsPullback</span> (<span class="id" title="var">comm_square_comp'</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">e2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ispullback_isequiv_functor_hfiber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">e1'</span> := <span class="id" title="var">isequiv_functor_hfiber_ispullback</span> <span class="id" title="var">_</span> <span class="id" title="var">e1</span> (<span class="id" title="var">i</span> <span class="id" title="var">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">e2'</span> := <span class="id" title="var">isequiv_functor_hfiber_ispullback</span> <span class="id" title="var">_</span> <span class="id" title="var">e2</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">isequiv_commsq'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;9: <span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_idmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;4: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> (<span class="id" title="var">functor_hfiber_compose</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pasting</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>