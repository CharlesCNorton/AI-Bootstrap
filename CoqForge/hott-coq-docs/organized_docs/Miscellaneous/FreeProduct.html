<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>FreeProduct</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library FreeProduct</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Basics</span> <span class="id" title="keyword">Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Cubical.DPath</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Spaces.List.Core</span> <span class="id" title="var">Spaces.List.Theory</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Colimits.Pushout</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Truncations.Core</span> <span class="id" title="var">Truncations.SeparatedTrunc</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Algebra.Groups.Group</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">WildCat</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">mc_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">mc_mult_scope</span>.<br/>

<br/>
</div>

<div class="doc">
In this file we define the amalgamated free product of a span of group homomorphisms as a HIT. 
<div class="paragraph"> </div>

 We wish to define the amalgamated free product of a span of group homomorphisms f : G -&gt; H, g : G -&gt; K as the following HIT:

<div class="paragraph"> </div>

  HIT M(f,g)
   | amal_eta : list (H + K) -&gt; M(f,g)
   | mu_H : forall (x y : list (H + K)) (h1 h2 : H),
      amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inl</span></span> <span class="inlinecode"><span class="id" title="var">h1</span>,</span> <span class="inlinecode"><span class="id" title="var">inl</span></span> <span class="inlinecode"><span class="id" title="var">h2</span></span> ++ y) = amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inl</span></span> <span class="inlinecode">(<span class="id" title="var">h1</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">h2</span>)</span> ++ y)
   | mu_K : forall (x y : list (H + K)) (k1 k2 : K),
      amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inr</span></span> <span class="inlinecode"><span class="id" title="var">k1</span>,</span> <span class="inlinecode"><span class="id" title="var">inr</span></span> <span class="inlinecode"><span class="id" title="var">k2</span></span> ++ y) = amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inr</span></span> <span class="inlinecode">(<span class="id" title="var">k1</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">k2</span>)</span> ++ y)
   | tau : forall (x y : list (H + K)) (z : G),
      amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inl</span></span> <span class="inlinecode">(<span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">z</span>)</span> ++ y) = amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inr</span></span> <span class="inlinecode">(<span class="id" title="var">g</span></span> <span class="inlinecode"><span class="id" title="var">z</span>)</span> ++ y)
   | omega_H : forall (x y : list (H + K)),
      amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inl</span></span> <span class="inlinecode"><span class="id" title="var">mon_unit</span></span> ++ y) = amal_eta (x ++ y)
   | omega_K : forall (x y : list (H + K)),
      amal_eta (x ++ <span class="inlinecode"><span class="id" title="var">inr</span></span> <span class="inlinecode"><span class="id" title="var">mon_unit</span></span> ++ y) = amal_eta (x ++ y).

<div class="paragraph"> </div>

  We will build this HIT up sucessively out of coequalizers. 
<div class="paragraph"> </div>

 We will call M <span class="inlinecode"><span class="id" title="var">amal_type</span></span> and prefix all the constructors with <span class="inlinecode"><span class="id" title="var">amal_</span></span> (for amalgmated free product). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">FreeProduct</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span> : <span class="id" title="var">Group</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">G</span> <span class="id" title="var">K</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">Words</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">list</span> (<span class="id" title="var">H</span> + <span class="id" title="var">K</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Fixpoint</span> <span class="id" title="var">word_inverse</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Words</span>) : <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">xs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h</span>|<span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> ((<span class="id" title="var">word_inverse</span> <span class="id" title="var">xs</span>) ++ [<span class="id" title="var">inl</span> (- <span class="id" title="var">h</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> ((<span class="id" title="var">word_inverse</span> <span class="id" title="var">xs</span>) ++ [<span class="id" title="var">inr</span> (- <span class="id" title="var">k</span>)]).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Inversion changes order of concatenation. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">word_inverse_ww</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">word_inverse</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>) = <span class="id" title="var">word_inverse</span> <span class="id" title="var">y</span> ++ <span class="id" title="var">word_inverse</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">xs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">app_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="var">rhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">app_assoc</span>; <span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
There are five source types for the path constructors. We will construct this HIT as the colimit of five forks going into <span class="inlinecode"><span class="id" title="var">Words</span></span>. We can bundle up this colimit as a single coequalizer. 
<div class="paragraph"> </div>

 Source types of path constructors 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">pc1</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Words</span> * <span class="id" title="var">H</span> * <span class="id" title="var">H</span> * <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">pc2</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Words</span> * <span class="id" title="var">K</span> * <span class="id" title="var">K</span> * <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">pc3</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Words</span> * <span class="id" title="var">G</span> * <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">pc4</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Words</span> * <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">pc5</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Words</span> * <span class="id" title="var">Words</span>.<br/>

<br/>
</div>

<div class="doc">
End points of the first path constructor 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m1</span> : <span class="id" title="var">pc1</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[[<span class="id" title="var">x</span> <span class="id" title="var">h1</span>] <span class="id" title="var">h2</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">inl</span> <span class="id" title="var">h1</span> :: [<span class="id" title="var">inl</span> <span class="id" title="var">h2</span>]) ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m1'</span> : <span class="id" title="var">pc1</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[[<span class="id" title="var">x</span> <span class="id" title="var">h1</span>] <span class="id" title="var">h2</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">h1</span> * <span class="id" title="var">h2</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
End points of the second path construct 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m2</span> : <span class="id" title="var">pc2</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[[<span class="id" title="var">x</span> <span class="id" title="var">k1</span>] <span class="id" title="var">k2</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">inr</span> <span class="id" title="var">k1</span> :: [<span class="id" title="var">inr</span> <span class="id" title="var">k2</span>]) ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m2'</span> : <span class="id" title="var">pc2</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[[<span class="id" title="var">x</span> <span class="id" title="var">k1</span>] <span class="id" title="var">k2</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">k1</span> * <span class="id" title="var">k2</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
End points of the third path constructor 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m3</span> : <span class="id" title="var">pc3</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[<span class="id" title="var">x</span> <span class="id" title="var">z</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m3'</span> : <span class="id" title="var">pc3</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[<span class="id" title="var">x</span> <span class="id" title="var">z</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
End points of the fourth path constructor 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m4</span> : <span class="id" title="var">pc4</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m4'</span> : <span class="id" title="var">pc4</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
End points of the fifth path constructor 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m5</span> : <span class="id" title="var">pc5</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">m5'</span> : <span class="id" title="var">pc5</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We can then define maps going into words consisting of the corresponding endpoints of the path constructors. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">map1</span> : <span class="id" title="var">pc1</span> + <span class="id" title="var">pc2</span> + <span class="id" title="var">pc3</span> + <span class="id" title="var">pc4</span> + <span class="id" title="var">pc5</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[[[<span class="id" title="var">x</span>|<span class="id" title="var">x</span>]|<span class="id" title="var">x</span>]|<span class="id" title="var">x</span>]|<span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m1</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m2</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m3</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m4</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m5</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Definition</span> <span class="id" title="var">map2</span> : <span class="id" title="var">pc1</span> + <span class="id" title="var">pc2</span> + <span class="id" title="var">pc3</span> + <span class="id" title="var">pc4</span> + <span class="id" title="var">pc5</span> -&gt; <span class="id" title="var">Words</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[[[<span class="id" title="var">x</span>|<span class="id" title="var">x</span>]|<span class="id" title="var">x</span>]|<span class="id" title="var">x</span>]|<span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m1'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m2'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m3'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m4'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">m5'</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Finally we can define our type as the 0-truncation of the coequalizer of these maps 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_type</span> : <span class="id" title="keyword">Type</span> := <span class="id" title="var">Tr</span> 0 (<span class="id" title="var">Coeq</span> <span class="id" title="var">map1</span> <span class="id" title="var">map2</span>).<br/>

<br/>
</div>

<div class="doc">
We can define the constructors 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_eta</span> : <span class="id" title="var">Words</span> -&gt; <span class="id" title="var">amal_type</span> := <span class="id" title="var">tr</span> <span class="id" title="var">o</span> <span class="id" title="var">coeq</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_mu_H</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">cons</span> (<span class="id" title="var">inl</span> <span class="id" title="var">h1</span>) [<span class="id" title="var">inl</span> <span class="id" title="var">h2</span>]) ++ <span class="id" title="var">y</span>) = <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">h1</span> * <span class="id" title="var">h2</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">amal_eta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_Tr</span>, <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">cglue</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">x</span>,<span class="id" title="var">h1</span>,<span class="id" title="var">h2</span>,<span class="id" title="var">y</span>)))))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_mu_K</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">k1</span> <span class="id" title="var">k2</span> : <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">cons</span> (<span class="id" title="var">inr</span> <span class="id" title="var">k1</span>) [<span class="id" title="var">inr</span> <span class="id" title="var">k2</span>]) ++ <span class="id" title="var">y</span>) = <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">k1</span> * <span class="id" title="var">k2</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">amal_eta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_Tr</span>, <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">cglue</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">x</span>,<span class="id" title="var">k1</span>,<span class="id" title="var">k2</span>,<span class="id" title="var">y</span>)))))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_tau</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">G</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>) = <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">amal_eta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_Tr</span>, <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">cglue</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">x</span>,<span class="id" title="var">z</span>,<span class="id" title="var">y</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_omega_H</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>) = <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">amal_eta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_Tr</span>, <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">cglue</span> (<span class="id" title="var">inl</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>)))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_omega_K</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>) = <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">amal_eta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_Tr</span>, <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">cglue</span> (<span class="id" title="var">inr</span> (<span class="id" title="var">x</span>,<span class="id" title="var">y</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Now we can derive the dependent eliminator 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_type_ind</span> (<span class="id" title="var">P</span> : <span class="id" title="var">amal_type</span> -&gt; <span class="id" title="keyword">Type</span>) `{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">IsHSet</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">e</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">w</span>, <span class="id" title="var">P</span> (<span class="id" title="var">amal_eta</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">mh</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">H</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DPath</span> <span class="id" title="var">P</span> (<span class="id" title="var">amal_mu_H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">inl</span> <span class="id" title="var">h1</span> :: [<span class="id" title="var">inl</span> <span class="id" title="var">h2</span>]) ++ <span class="id" title="var">y</span>)) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">h1</span> * <span class="id" title="var">h2</span>)] ++ <span class="id" title="var">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">mk</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">k1</span> <span class="id" title="var">k2</span> : <span class="id" title="var">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DPath</span> <span class="id" title="var">P</span> (<span class="id" title="var">amal_mu_K</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">inr</span> <span class="id" title="var">k1</span> :: [<span class="id" title="var">inr</span> <span class="id" title="var">k2</span>]) ++ <span class="id" title="var">y</span>)) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">k1</span> * <span class="id" title="var">k2</span>)] ++ <span class="id" title="var">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">G</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DPath</span> <span class="id" title="var">P</span> (<span class="id" title="var">amal_tau</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>)) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">oh</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DPath</span> <span class="id" title="var">P</span> (<span class="id" title="var">amal_omega_H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>)) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ok</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">DPath</span> <span class="id" title="var">P</span> (<span class="id" title="var">amal_omega_K</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>)) (<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Trunc_ind</span>; [<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Coeq_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [ [ [ [<span class="id" title="var">a</span> | <span class="id" title="var">a</span> ] | <span class="id" title="var">a</span>] | <span class="id" title="var">a</span> ] | <span class="id" title="var">a</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">x</span> <span class="id" title="var">h1</span>] <span class="id" title="var">h2</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dp_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">mh</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [[[<span class="id" title="var">x</span> <span class="id" title="var">k1</span>] <span class="id" title="var">k2</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dp_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">mk</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">x</span> <span class="id" title="var">z</span>] <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dp_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dp_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">oh</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">dp_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">ok</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_type_ind_hprop</span> (<span class="id" title="var">P</span> : <span class="id" title="var">amal_type</span> -&gt; <span class="id" title="keyword">Type</span>) `{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">IsHProp</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">e</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">w</span>, <span class="id" title="var">P</span> (<span class="id" title="var">amal_eta</span> <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_ishprop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
From which we can derive the non-dependent eliminator / recursion principle 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_type_rec</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Type</span>) `{<span class="id" title="var">IsHSet</span> <span class="id" title="var">P</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">Words</span> -&gt; <span class="id" title="var">P</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eh</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">h1</span> <span class="id" title="var">h2</span> : <span class="id" title="var">H</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">cons</span> (<span class="id" title="var">inl</span> <span class="id" title="var">h1</span>) [<span class="id" title="var">inl</span> <span class="id" title="var">h2</span>]) ++ <span class="id" title="var">y</span>) = <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">h1</span> * <span class="id" title="var">h2</span>)] ++ <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ek</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">k1</span> <span class="id" title="var">k2</span> : <span class="id" title="var">K</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ (<span class="id" title="var">cons</span> (<span class="id" title="var">inr</span> <span class="id" title="var">k1</span>) [<span class="id" title="var">inr</span> <span class="id" title="var">k2</span>]) ++ <span class="id" title="var">y</span>) = <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">k1</span> * <span class="id" title="var">k2</span>)] ++ <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">t</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>) (<span class="id" title="var">z</span> : <span class="id" title="var">G</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>) = <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">oh</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>), <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>) = <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ok</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">Words</span>), <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">y</span>) = <span class="id" title="var">e</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">amal_type</span> -&gt; <span class="id" title="var">P</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">amal_type_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">dp_const</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">eh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">ek</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">oh</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ok</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Now for the group structure 
<div class="paragraph"> </div>

 The group operation is concatenation of the underlying list. Most of the work is spent showing that it respects the path constructors. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">sgop_amal_type</span> : <span class="id" title="var">SgOp</span> <span class="id" title="var">amal_type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="var">revert</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_rec</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">revert</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_rec</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">z</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_mu_H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">z</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_mu_K</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">w</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_tau</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_K</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>; <span class="id" title="var">revert</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ ((<span class="id" title="var">inl</span> <span class="id" title="var">h1</span> :: [<span class="id" title="var">inl</span> <span class="id" title="var">h2</span>]) ++ <span class="id" title="var">y</span>)) ++ <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">h1</span> * <span class="id" title="var">h2</span>)] ++ <span class="id" title="var">y</span>) ++ <span class="id" title="var">z</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_mu_H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>; <span class="id" title="var">revert</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ ((<span class="id" title="var">inr</span> <span class="id" title="var">k1</span> :: [<span class="id" title="var">inr</span> <span class="id" title="var">k2</span>]) ++ <span class="id" title="var">y</span>)) ++ <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">k1</span> * <span class="id" title="var">k2</span>)] ++ <span class="id" title="var">y</span>) ++ <span class="id" title="var">z</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_mu_K</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>; <span class="id" title="var">revert</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>) ++ <span class="id" title="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">z</span>)] ++ <span class="id" title="var">y</span>) ++ <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_tau</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">z</span>; <span class="id" title="var">revert</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ [<span class="id" title="var">inl</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">z</span>) ++ <span class="id" title="var">w</span>) = <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ <span class="id" title="var">z</span>) ++ <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span> <span class="id" title="var">z</span>; <span class="id" title="var">revert</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ [<span class="id" title="var">inr</span> <span class="id" title="var">mon_unit</span>] ++ <span class="id" title="var">z</span>) ++ <span class="id" title="var">w</span>) = <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">x</span> ++ <span class="id" title="var">z</span>) ++ <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> (<span class="id" title="var">ap</span> (<span class="id" title="var">app</span> <span class="id" title="var">x</span>) <span class="id" title="var">_</span>)^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_K</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The identity element is the empty list 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">monunit_amal_type</span> : <span class="id" title="var">MonUnit</span> <span class="id" title="var">amal_type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">amal_eta</span> <span class="id" title="var">nil</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">negate_amal_type</span> : <span class="id" title="var">Negate</span> <span class="id" title="var">amal_type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">amal_eta</span> (<span class="id" title="var">word_inverse</span> <span class="id" title="var">w</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">refine</span> (<span class="id" title="var">word_inverse_ww</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">s</span> ++ <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">word_inverse_ww</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (<span class="id" title="var">word_inverse_ww</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; [<span class="id" title="var">s</span>])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">negate_sg_op</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_mu_H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">refine</span> (<span class="id" title="var">word_inverse_ww</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">s</span> ++ <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">word_inverse_ww</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (<span class="id" title="var">word_inverse_ww</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; [<span class="id" title="var">s</span>])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">negate_sg_op</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_mu_K</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">refine</span> (<span class="id" title="var">word_inverse_ww</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">s</span> ++ <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="var">cbn</span>; <span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; [<span class="id" title="var">s</span>])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,2: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">grp_homo_inv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_tau</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">word_inverse_ww</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">s</span> ++ <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">word_inverse_ww</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_mon_unit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_H</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">hnf</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3: <span class="id" title="tactic">apply</span> <span class="id" title="var">word_inverse_ww</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">s</span> ++ <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">word_inverse_ww</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span> <span class="id" title="var">_</span>^ @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">negate_mon_unit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_K</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">associative_sgop_m</span> : <span class="id" title="var">Associative</span> <span class="id" title="var">sg_op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">z</span>; <span class="id" title="var">revert</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">y</span>; <span class="id" title="var">revert</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">leftidentity_sgop_amal_type</span> : <span class="id" title="var">LeftIdentity</span> <span class="id" title="var">sg_op</span> <span class="id" title="var">mon_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">rightidentity_sgop_amal_type</span> : <span class="id" title="var">RightIdentity</span> <span class="id" title="var">sg_op</span> <span class="id" title="var">mon_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">amal_eta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">app_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">amal_eta_word_concat_Vw</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Words</span>) : <span class="id" title="var">amal_eta</span> (<span class="id" title="var">word_inverse</span> <span class="id" title="var">x</span> ++ <span class="id" title="var">x</span>) = <span class="id" title="var">mon_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">xs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h</span>|<span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> (<span class="id" title="var">word_inverse</span> ([<span class="id" title="var">inl</span> <span class="id" title="var">h</span>] ++ <span class="id" title="var">xs</span>) ++ [<span class="id" title="var">inl</span> <span class="id" title="var">h</span>] ++ <span class="id" title="var">xs</span>) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">word_inverse_ww</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">amal_mu_H</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">left_inverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">amal_omega_H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> (<span class="id" title="var">word_inverse</span> ([<span class="id" title="var">inr</span> <span class="id" title="var">k</span>] ++ <span class="id" title="var">xs</span>) ++ [<span class="id" title="var">inr</span> <span class="id" title="var">k</span>] ++ <span class="id" title="var">xs</span>) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">word_inverse_ww</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">amal_mu_K</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">left_inverse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">amal_omega_K</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHxs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">amal_eta_word_concat_wV</span> (<span class="id" title="var">x</span> : <span class="id" title="var">Words</span>) : <span class="id" title="var">amal_eta</span> (<span class="id" title="var">x</span> ++ <span class="id" title="var">word_inverse</span> <span class="id" title="var">x</span>) = <span class="id" title="var">mon_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">xs</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h</span>|<span class="id" title="var">k</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ([<span class="id" title="var">inl</span> <span class="id" title="var">h</span>]) * <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">xs</span> ++ <span class="id" title="var">word_inverse</span> <span class="id" title="var">xs</span>)) * <span class="id" title="var">amal_eta</span> ([<span class="id" title="var">inl</span> (- <span class="id" title="var">h</span>)]) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rightidentity_sgop_amal_type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">app_nil</span> (<span class="id" title="var">cons</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> (([<span class="id" title="var">inl</span> <span class="id" title="var">h</span>] ++ [<span class="id" title="var">inl</span> (- <span class="id" title="var">h</span>)]) ++ <span class="id" title="var">nil</span>) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> (<span class="id" title="var">nil</span> ++ [<span class="id" title="var">inl</span> <span class="id" title="var">h</span>] ++ [<span class="id" title="var">inl</span> (- <span class="id" title="var">h</span>)] ++ <span class="id" title="var">nil</span>) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">amal_mu_H</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> ++ <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; [<span class="id" title="var">x</span>])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">right_inverse</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> ([<span class="id" title="var">inr</span> <span class="id" title="var">k</span>]) * <span class="id" title="var">amal_eta</span> ((<span class="id" title="var">xs</span> ++ <span class="id" title="var">word_inverse</span> <span class="id" title="var">xs</span>)) * <span class="id" title="var">amal_eta</span> ([<span class="id" title="var">inr</span> (-<span class="id" title="var">k</span>)]) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHxs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">rightidentity_sgop_amal_type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">app_nil</span> (<span class="id" title="var">cons</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> (([<span class="id" title="var">inr</span> <span class="id" title="var">k</span>] ++ [<span class="id" title="var">inr</span> (- <span class="id" title="var">k</span>)]) ++ <span class="id" title="var">nil</span>) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">amal_eta</span> (<span class="id" title="var">nil</span> ++ [<span class="id" title="var">inr</span> <span class="id" title="var">k</span>] ++ [<span class="id" title="var">inr</span> (- <span class="id" title="var">k</span>)] ++ <span class="id" title="var">nil</span>) = <span class="id" title="var">mon_unit</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">amal_mu_K</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> ++ <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; [<span class="id" title="var">x</span>])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">right_inverse</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_omega_K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">leftinverse_sgop_amal_type</span> : <span class="id" title="var">LeftInverse</span> <span class="id" title="var">sg_op</span> <span class="id" title="var">negate</span> <span class="id" title="var">mon_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_eta_word_concat_Vw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">rightinverse_sgop_amal_type</span> : <span class="id" title="var">RightInverse</span> <span class="id" title="var">sg_op</span> <span class="id" title="var">negate</span> <span class="id" title="var">mon_unit</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">amal_eta_word_concat_wV</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">AmalgamatedFreeProduct</span> : <span class="id" title="var">Group</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">Build_Group</span> <span class="id" title="var">amal_type</span>); <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Using foldr. It's important that we use foldr as foldl is near impossible to reason about. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">AmalgamatedFreeProduct_rec'</span> (<span class="id" title="var">X</span> : <span class="id" title="var">Group</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">X</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">K</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">AmalgamatedFreeProduct</span> -&gt; <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_rec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">fold_right</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">l</span>|<span class="id" title="var">r</span>] <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">h</span> <span class="id" title="var">l</span> * <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">k</span> <span class="id" title="var">r</span> * <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">mon_unit</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>; <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">fold_right_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">simple_associativity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">grp_homo_op</span> <span class="id" title="var">h</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>; <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">fold_right_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">simple_associativity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">grp_homo_op</span> <span class="id" title="var">k</span> <span class="id" title="var">k1</span> <span class="id" title="var">k2</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>; <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">fold_right_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">f_ap</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">fold_right_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">grp_homo_unit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">left_identity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">hnf</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> ?<span class="id" title="var">fold_right_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f_ap</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">grp_homo_unit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">left_identity</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">issemigrouppreserving_AmalgamatedFreeProduct_rec'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">X</span> : <span class="id" title="var">Group</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">X</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">K</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsSemiGroupPreserving</span> (<span class="id" title="var">AmalgamatedFreeProduct_rec'</span> <span class="id" title="var">X</span> <span class="id" title="var">h</span> <span class="id" title="var">k</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">y</span>; <span class="id" title="var">revert</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">fold_right_app</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">s</span> := (<span class="id" title="var">fold_right</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">X0</span> : <span class="id" title="var">H</span> + <span class="id" title="var">K</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">X0</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">inl</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">X</span> =&gt; <span class="id" title="var">h</span> <span class="id" title="var">l</span> * <span class="id" title="var">x0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">inr</span> <span class="id" title="var">r</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">x0</span> : <span class="id" title="var">X</span> =&gt; <span class="id" title="var">k</span> <span class="id" title="var">r</span> * <span class="id" title="var">x0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <span class="id" title="var">mon_unit</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">left_identity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">simple_associativity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">AmalgamatedFreeProduct_rec</span> (<span class="id" title="var">X</span> : <span class="id" title="var">Group</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">X</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">K</span> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">AmalgamatedFreeProduct</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_GroupHomomorphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="var">srapply</span> (<span class="id" title="var">AmalgamatedFreeProduct_rec'</span> <span class="id" title="var">X</span> <span class="id" title="var">h</span> <span class="id" title="var">k</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_inl</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">AmalgamatedFreeProduct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_GroupHomomorphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">amal_eta</span> [<span class="id" title="var">inl</span> <span class="id" title="var">x</span>]). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">app_nil</span> [<span class="id" title="var">inl</span> (<span class="id" title="var">x</span> * <span class="id" title="var">y</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">amal_mu_H</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">amal_inr</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">K</span> <span class="id" title="var">AmalgamatedFreeProduct</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_GroupHomomorphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">amal_eta</span> [<span class="id" title="var">inr</span> <span class="id" title="var">x</span>]). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">app_nil</span> [<span class="id" title="var">inr</span> (<span class="id" title="var">x</span> * <span class="id" title="var">y</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">amal_mu_K</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">equiv_amalgamatedfreeproduct_rec</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">X</span> : <span class="id" title="var">Group</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: {<span class="id" title="var">h</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">X</span> &amp; {<span class="id" title="var">k</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">K</span> <span class="id" title="var">X</span> &amp; <span class="id" title="var">h</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span> }}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">AmalgamatedFreeProduct</span> <span class="id" title="var">X</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">equiv_adjointify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">intros</span> [<span class="id" title="var">h</span> [<span class="id" title="var">k</span> <span class="id" title="var">p</span>]]; <span class="id" title="tactic">exact</span> (<span class="id" title="var">AmalgamatedFreeProduct_rec</span> <span class="id" title="var">X</span> <span class="id" title="var">h</span> <span class="id" title="var">k</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">grp_homo_compose</span> <span class="id" title="var">r</span> <span class="id" title="var">amal_inl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">grp_homo_compose</span> <span class="id" title="var">r</span> <span class="id" title="var">amal_inr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">app_nil</span> [<span class="id" title="var">inl</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">app_nil</span> [<span class="id" title="var">inr</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">amal_tau</span> <span class="id" title="var">nil</span> <span class="id" title="var">nil</span> <span class="id" title="var">x</span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_grouphomomorphism</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_ind_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">x</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">x</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">symmetry</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">grp_homo_op</span> <span class="id" title="var">r</span> (<span class="id" title="var">amal_eta</span> [<span class="id" title="var">_</span>]) (<span class="id" title="var">amal_eta</span> <span class="id" title="var">x</span>)). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">hkp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> (<span class="id" title="var">equiv_ap'</span> (<span class="id" title="var">equiv_sigma_prod</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">hk</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">X</span> * <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">K</span> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; <span class="id" title="var">fst</span> <span class="id" title="var">hk</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">snd</span> <span class="id" title="var">hk</span> <span class="id" title="var">o</span> <span class="id" title="var">g</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1%<span class="id" title="var">equiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">path_sigma_hprop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">hkp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">h</span> [<span class="id" title="var">k</span> <span class="id" title="var">p</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">path_prod</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_grouphomomorphism</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">right_identity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">FreeProduct</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">amal_eta</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>} <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">FreeProduct</span> (<span class="id" title="var">G</span> <span class="id" title="var">H</span> : <span class="id" title="var">Group</span>) : <span class="id" title="var">Group</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">AmalgamatedFreeProduct</span> <span class="id" title="var">grp_trivial</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span> (<span class="id" title="var">grp_trivial_rec</span> <span class="id" title="var">_</span>) (<span class="id" title="var">grp_trivial_rec</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">freeproduct_inl</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span> : <span class="id" title="var">Group</span>} : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">G</span> (<span class="id" title="var">FreeProduct</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">amal_inl</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">freeproduct_inr</span> {<span class="id" title="var">G</span> <span class="id" title="var">H</span> : <span class="id" title="var">Group</span>} : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> (<span class="id" title="var">FreeProduct</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">amal_inr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">FreeProduct_rec</span> (<span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span> : <span class="id" title="var">Group</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">G</span> <span class="id" title="var">K</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">GroupHomomorphism</span> (<span class="id" title="var">FreeProduct</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) <span class="id" title="var">K</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> (<span class="id" title="var">AmalgamatedFreeProduct_rec</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">_</span> @ (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">_</span>)^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_freeproduct_rec</span> `{<span class="id" title="var">funext</span> : <span class="id" title="var">Funext</span>} (<span class="id" title="var">G</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span> : <span class="id" title="var">Group</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">G</span> <span class="id" title="var">K</span>) * (<span class="id" title="var">GroupHomomorphism</span> <span class="id" title="var">H</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&lt;~&gt; <span class="id" title="var">GroupHomomorphism</span> (<span class="id" title="var">FreeProduct</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>) <span class="id" title="var">K</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_amalgamatedfreeproduct_rec</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <span class="id" title="var">K</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>^-1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_sigma_prod0</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_functor_sigma_id</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equiv_sigma_contr</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">contr_forall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">apply</span> <span class="id" title="var">contr_inhab_prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">tr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">_</span> @ (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">_</span>)^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
The freeproduct is the coproduct in the category of groups. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">hasbinarycoproducts</span> : <span class="id" title="var">HasBinaryCoproducts</span> <span class="id" title="var">Group</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">Build_BinaryCoproduct</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">FreeProduct</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">freeproduct_inl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">freeproduct_inr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">FreeProduct_rec</span> <span class="id" title="var">G</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Z</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">right_identity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Z</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">right_identity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">Z</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">amal_type_ind_hprop</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">gh</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">exact</span> (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">_</span> @ (<span class="id" title="var">grp_homo_unit</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> (<span class="id" title="var">f</span> (<span class="id" title="var">amal_eta</span> [<span class="id" title="var">gh</span>] * <span class="id" title="var">amal_eta</span> <span class="id" title="var">w</span>) = <span class="id" title="var">g</span> (<span class="id" title="var">amal_eta</span> [<span class="id" title="var">gh</span>] * <span class="id" title="var">amal_eta</span> <span class="id" title="var">w</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">grp_homo_op_agree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">IHw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">gh</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">g'</span> | <span class="id" title="var">h</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">g'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">exact</span> (<span class="id" title="var">q</span> <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>