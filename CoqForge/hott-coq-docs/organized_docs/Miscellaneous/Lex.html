<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Lex</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Lex</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span> <span class="id" title="var">HoTT.Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HFiber</span> <span class="id" title="var">Limits.Pullback</span> <span class="id" title="var">Factorization</span> <span class="id" title="var">Truncations.Core</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Modality</span> <span class="id" title="var">Accessible</span> <span class="id" title="var">Modalities.Localization</span> <span class="id" title="var">Descent</span> <span class="id" title="var">Separated</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">subuniverse_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1222"></a><h1 class="section">Lex modalities</h1>

<div class="paragraph"> </div>

 A lex modality is one that preserves finite limits, or equivalently pullbacks.  Many equivalent characterizations of this can be found in Theorem 3.1 of RSS.

<div class="paragraph"> </div>

We choose as our definition that a lex modality to be a reflective subuniverse such that <span class="inlinecode"><span class="id" title="var">O</span></span> <span class="inlinecode">&lt;&lt;&lt;</span> <span class="inlinecode"><span class="id" title="var">O</span></span>, which is close to (but not quite the same as) RSS Theorem 3.1 (xiii).

<div class="paragraph"> </div>

Note that since this includes <span class="inlinecode"><span class="id" title="var">O</span></span> <span class="inlinecode">&lt;&lt;</span> <span class="inlinecode"><span class="id" title="var">O</span></span> as a precondition, such an <span class="inlinecode"><span class="id" title="var">O</span></span> must indeed be a modality (and since modalities coerce to reflective subuniverses, in the following notation <span class="inlinecode"><span class="id" title="var">O</span></span> could be either an element of <span class="inlinecode"><span class="id" title="var">ReflectiveSubuniverse</span></span> or of <span class="inlinecode"><span class="id" title="var">Modality</span></span>). 
</div>
<div class="code">
<span class="id" title="keyword">Notation</span> <span class="id" title="var">Lex</span> <span class="id" title="var">O</span> := (<span class="id" title="var">O</span> &lt;&lt;&lt; <span class="id" title="var">O</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab1223"></a><h2 class="section">Properties of lex modalities</h2>

<div class="paragraph"> </div>

 We now show that lex modalities have all the other properties from RSS Theorem 3.1 (which are equivalent to lex-ness).  All of them are simple specializations of properties from <span class="inlinecode"><span class="id" title="var">Descent.v</span></span> to the case <span class="inlinecode"><span class="id" title="var">O'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">O</span></span> (although in the general case they are not known to be equivalent). 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <span class="id" title="var">LexModality</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">O</span> : <span class="id" title="var">Modality</span>) `{<span class="id" title="var">Lex</span> <span class="id" title="var">O</span>}.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (i) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isconnected_paths</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_isconnected_paths</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (iii) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">conn_map_lex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Y</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">Y</span>, <span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">X</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_conn_map_isconnected</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (iv) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isequiv_mapino_isconnected</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Y</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">Y</span>, <span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">X</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span>) `{<span class="id" title="var">MapIn</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsEquiv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_isequiv_mapino_isconnected</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (vi) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">conn_map_functor_hfiber</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">h</span>, <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">k</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> (<span class="id" title="var">functor_hfiber</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_conn_map_functor_hfiber</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">p</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (vii) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">ispullback_connmap_mapino_commsq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>} {<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>} {<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="var">O_inverts</span> <span class="id" title="var">O</span> <span class="id" title="var">h</span>, <span class="id" title="var">O_inverts</span> <span class="id" title="var">O</span> <span class="id" title="var">k</span>, <span class="id" title="var">MapIn</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span>, <span class="id" title="var">MapIn</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_ispullback_connmap_mapino</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (viii) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">conn_map_functor_hfiber_to_O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Y</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> (<span class="id" title="var">functor_hfiber</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span>)^) <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_conn_map_functor_hfiber_to_O</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isequiv_O_functor_hfiber</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">O_functor_hfiber</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">isequiv_O_rec_O_inverts</span> <span class="id" title="var">O</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">O_inverts_conn_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">conn_map_homotopic</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O</span> (<span class="id" title="var">functor_hfiber</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>)^) <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">functor_hfiber</span>, <span class="id" title="var">functor_sigma</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerR</span>, <span class="id" title="var">inv_V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_O_functor_hfiber</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">hfiber</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>) &lt;~&gt; <span class="id" title="var">hfiber</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">O_functor_hfiber</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>) <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (ix) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isequiv_path_O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">X</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">path_OO</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">isequiv_path_OO</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_O</span> {<span class="id" title="var">X</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>) &lt;~&gt; (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">X</span> <span class="id" title="var">x</span> = <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">X</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_path_OO</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_O_to_O</span> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">equiv_path_O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="var">o</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>)) == @<span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">X</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">equiv_path_O</span>, <span class="id" title="var">equiv_path_OO</span>, <span class="id" title="var">path_OO</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">O_rec_beta</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (x).  This justifies the term "left exact". 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">O_inverts_functor_pullback_to_O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O_inverts</span> <span class="id" title="var">O</span> (<span class="id" title="var">functor_pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_inverts_functor_pullback_to_O</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_O_pullback</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">O</span> (<span class="id" title="var">Pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) &lt;~&gt; <span class="id" title="var">Pullback</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">equiv_O_rec_O_inverts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">O</span> (<span class="id" title="var">functor_pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">O_functor_pullback</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsPullback</span> (<span class="id" title="var">O_functor_square</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">pullback_commsq</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsPullback</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> (<span class="id" title="var">isequiv_homotopic</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">O_rec</span> (<span class="id" title="var">functor_pullback</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_O_rec_O_inverts</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">O_indpaths</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">etransitivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">intro</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">O_rec_beta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">snrapply</span> <span class="id" title="var">pullback_homotopic</span>; <span class="id" title="tactic">intros</span> [<span class="id" title="var">b</span> [<span class="id" title="var">c</span> <span class="id" title="var">e</span>]]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">change</span> (<span class="id" title="var">to</span> (<span class="id" title="var">modality_subuniv</span> <span class="id" title="var">O</span>)) <span class="id" title="keyword">with</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">nrapply</span> (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">nrapply</span> (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">O</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">long_path_scope</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">concat_p_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs</span> <span class="id" title="var">nrapply</span> (<span class="id" title="var">concat_p_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> @@ 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">to_O_natural_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">O_functor_square</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">O_functor_homotopy_beta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> 6 <span class="id" title="var">concat_pp_p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">apply</span> <span class="id" title="var">whiskerL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">concat_pp_p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_pM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">inv_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rhs_V</span> <span class="id" title="var">nrapply</span> <span class="id" title="var">inv_Vp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">ap</span> <span class="id" title="var">inverse</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrapply</span> <span class="id" title="var">to_O_natural_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">long_path_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">diagonal_O_functor</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">diagonal</span> (<span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) == <span class="id" title="var">equiv_O_pullback</span> <span class="id" title="var">f</span> <span class="id" title="var">f</span> <span class="id" title="var">o</span> <span class="id" title="var">O_functor</span> <span class="id" title="var">O</span> (<span class="id" title="var">diagonal</span> <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">O_indpaths</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">ap</span> <span class="id" title="var">_</span> (<span class="id" title="var">to_O_natural</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>))^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">O_rec_beta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">diagonal</span>, <span class="id" title="var">functor_pullback</span>, <span class="id" title="var">functor_sigma</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">ap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_pV</span>; <span class="id" title="tactic">exact</span> (<span class="id" title="var">concat_1p_p1</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (xi) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">cancelL_conn_map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Y</span> <span class="id" title="var">X</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`{<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>)} `{<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">OO_cancelL_conn_map</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (xii) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">conn_map_O_inverts</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) `{<span class="id" title="var">O_inverts</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">conn_map_OO_inverts</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (xiii) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">modal_over_connected_isconst_lex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) `{<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) `{<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">O</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: {<span class="id" title="var">Q</span> : <span class="id" title="keyword">Type</span> &amp; <span class="id" title="var">In</span> <span class="id" title="var">O</span> <span class="id" title="var">Q</span> * <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Q</span> &lt;~&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="var">O_inverts_isconnected</span> <span class="id" title="var">O</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span>:<span class="id" title="var">A</span> =&gt; <span class="id" title="var">tt</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">OO_descend_O_inverts</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span>:<span class="id" title="var">A</span> =&gt; <span class="id" title="var">tt</span>) <span class="id" title="var">P</span> <span class="id" title="var">tt</span>); <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">OO_descend_O_inverts_inO</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>; <span class="id" title="var">nrapply</span> <span class="id" title="var">OO_descend_O_inverts_beta</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.11 (iii): in the accessible case, the universe is modal. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">inO_typeO_lex</span> `{<span class="id" title="var">Univalence</span>} `{<span class="id" title="var">IsAccRSU</span> <span class="id" title="var">O</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">In</span> (<span class="id" title="var">lift_accrsu</span> <span class="id" title="var">O</span>) (<span class="id" title="var">Type_</span> <span class="id" title="var">O</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
Part of RSS Corollary 3.9: lex modalities preserve <span class="inlinecode"><span class="id" title="var">n</span></span>-types for all <span class="inlinecode"><span class="id" title="var">n</span></span>.  This is definitely not equivalent to lex-ness, since it is true for the truncation modalities that are not lex.  But it is also not true of all modalities; e.g. the shape modality in a cohesive topos can take 0-types to <span class="inlinecode"><span class="id" title="var">oo</span></span>-types.  With a little more work, this can probably be proven without <span class="inlinecode"><span class="id" title="var">Funext</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">istrunc_O_lex</span> `{<span class="id" title="var">Funext</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>} {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} `{<span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">O</span> <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">A</span>; <span class="id" title="var">simple_induction</span> <span class="id" title="var">n</span> <span class="id" title="var">n</span> <span class="id" title="var">IHn</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> ?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. </div>

<div class="doc">
Already proven for all modalities. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_S</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">O_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>)) <span class="id" title="var">_</span>); <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">O_ind</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">IsTrunc</span> <span class="id" title="var">n</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>)) <span class="id" title="var">_</span>); <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">istrunc_equiv_istrunc</span> <span class="id" title="var">_</span> (<span class="id" title="var">equiv_path_O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">LexModality</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1224"></a><h2 class="section">Equivalent characterizations of lex-ness</h2>

<div class="paragraph"> </div>

 We will not prove that *all* of the above properties from RSS Theorem 3.1 are equivalent to lex-ness, but we will do it for some of them. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">ImpliesLex</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">O</span> : <span class="id" title="var">Modality</span>}.<br/>

<br/>
</div>

<div class="doc">
RSS 3.1 (xiii) implies lexness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_modal_over_connected_isconst</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">A_isC</span> : <span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P_inO</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">O</span> (<span class="id" title="var">P</span> <span class="id" title="var">x</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Q</span> : <span class="id" title="keyword">Type</span> &amp; <span class="id" title="var">In</span> <span class="id" title="var">O</span> <span class="id" title="var">Q</span> * <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">Q</span> &lt;~&gt; <span class="id" title="var">P</span> <span class="id" title="var">x</span>})<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span>; <span class="id" title="var">unshelve</span> <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">P_inO</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>:<span class="id" title="tactic">pose</span> (<span class="id" title="var">Q</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">z</span>:<span class="id" title="var">O</span> <span class="id" title="var">A</span> =&gt; <span class="id" title="var">H</span> (<span class="id" title="var">hfiber</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) <span class="id" title="var">z</span>) <span class="id" title="var">_</span> (<span class="id" title="var">P</span> <span class="id" title="var">o</span> <span class="id" title="var">pr1</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; (<span class="id" title="var">Q</span> <span class="id" title="var">z</span>).1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="var">fst</span> (<span class="id" title="var">Q</span> <span class="id" title="var">z</span>).2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">Q</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span>)).2 (<span class="id" title="var">x</span>;1)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS 3.11 (iii), the universe is modal, implies lex-ness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_inO_typeO</span> `{<span class="id" title="var">IsAccRSU</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">In</span> (<span class="id" title="var">lift_accrsu</span> <span class="id" title="var">O</span>) (<span class="id" title="var">Type_</span> <span class="id" title="var">O</span>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">O_lex_leq_inO_TypeO</span> <span class="id" title="var">O</span> <span class="id" title="var">O</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (xi) implies lex-ness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_cancelL_conn_map</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">cancel</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">Y</span> <span class="id" title="var">X</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Y</span> -&gt; <span class="id" title="var">X</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">X</span> -&gt; <span class="id" title="var">Z</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> (<span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>)) -&gt; (<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_from_modal_over_connected_isconst</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="var">O</span> {<span class="id" title="var">x</span>:<span class="id" title="var">A</span> &amp; <span class="id" title="var">P</span> <span class="id" title="var">x</span>}); <span class="id" title="tactic">split</span>; [ <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> | <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">symmetry</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="var">x</span> ; <span class="id" title="var">p</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">isequiv_conn_map_ino</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span>). 1-2:<span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">conn_map_fiber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nrefine</span> (<span class="id" title="var">cancel</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">z</span>:{<span class="id" title="var">x</span>:<span class="id" title="var">A</span> &amp; <span class="id" title="var">O</span> {<span class="id" title="var">x</span> : <span class="id" title="var">A</span> &amp; <span class="id" title="var">P</span> <span class="id" title="var">x</span>}} =&gt; <span class="id" title="var">z</span>.2) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">clear</span> <span class="id" title="var">cancel</span>; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isconnected_equiv'</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hfiber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_adjointify</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; ((<span class="id" title="var">x</span> ; <span class="id" title="var">z</span>) ; 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">y</span>.1.1) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [[<span class="id" title="var">x</span> <span class="id" title="var">y</span>] []]; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (iii) implies lex-ness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_conn_map_lex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) -&gt; (<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_from_cancelL_conn_map</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Y</span> <span class="id" title="var">X</span> <span class="id" title="var">Z</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">gfc</span> <span class="id" title="var">gc</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">h</span> := @<span class="id" title="var">functor_hfiber</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> <span class="id" title="var">X</span> <span class="id" title="var">Z</span> (<span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span>) <span class="id" title="var">g</span> <span class="id" title="var">f</span> <span class="id" title="var">idmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; 1%<span class="id" title="var">path</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">cc</span> := <span class="id" title="var">H</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">h</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">gfc</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">gc</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isconnected_equiv'</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">cc</span> (<span class="id" title="var">x</span>;1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hfiber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">h</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">functor_hfiber</span>, <span class="id" title="var">functor_sigma</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_sigma_assoc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_functor_sigma_id</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2:<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_sigma</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_sigma_symm</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_sigma_contr</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">contr_equiv'</span> { <span class="id" title="var">p</span> : <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">y</span>) = <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">y</span>) &amp; <span class="id" title="var">p</span> = 1%<span class="id" title="var">path</span> } <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_concat_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span> @ <span class="id" title="var">ap_idmap</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (i) implies lex-ness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_isconnected_paths</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">Ac</span> : <span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_from_conn_map_lex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">Ac</span> <span class="id" title="var">Bc</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">isconnected_sigma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (iv) implies lex-ness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_isequiv_ismodal_isconnected_types</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) -&gt; (<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> <span class="id" title="var">B</span>) -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MapIn</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) -&gt; <span class="id" title="var">IsEquiv</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_from_conn_map_lex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">AC</span> <span class="id" title="var">BC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">conn_map_homotopic</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">fact_factors</span> (<span class="id" title="var">image</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">conn_map_compose</span>; [ <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">conn_map_isequiv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>; [ | <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> | <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isconnected_conn_map_to_unit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">cancelR_conn_map</span> <span class="id" title="var">O</span> (<span class="id" title="var">factor1</span> (<span class="id" title="var">image</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>)) (<span class="id" title="var">const_tt</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
RSS Theorem 3.1 (vii) implies lex-ness 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_from_ispullback_connmap_mapino_commsq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">C</span> -&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">C</span>) (<span class="id" title="var">k</span> : <span class="id" title="var">B</span> -&gt; <span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span>) -&gt; (<span class="id" title="var">IsConnMap</span> <span class="id" title="var">O</span> <span class="id" title="var">g</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">MapIn</span> <span class="id" title="var">O</span> <span class="id" title="var">h</span>) -&gt; (<span class="id" title="var">MapIn</span> <span class="id" title="var">O</span> <span class="id" title="var">k</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <span class="id" title="var">k</span> <span class="id" title="var">o</span> <span class="id" title="var">f</span> == <span class="id" title="var">g</span> <span class="id" title="var">o</span> <span class="id" title="var">h</span>), <span class="id" title="var">IsPullback</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_from_isequiv_ismodal_isconnected_types</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">AC</span> <span class="id" title="var">BC</span> <span class="id" title="var">fM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">A</span> <span class="id" title="var">Unit</span> <span class="id" title="var">B</span> <span class="id" title="var">Unit</span> (<span class="id" title="var">const_tt</span> <span class="id" title="var">_</span>) (<span class="id" title="var">const_tt</span> <span class="id" title="var">_</span>) <span class="id" title="var">f</span> <span class="id" title="var">idmap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">IsPullback</span>, <span class="id" title="var">pullback_corec</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<span class="id" title="var">isequiv_compose</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span>.2.1) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Pullback</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<span class="id" title="var">isequiv_compose</span> <span class="id" title="var">_</span> {<span class="id" title="var">b</span>:<span class="id" title="var">Unit</span> &amp; <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">functor_sigma</span> <span class="id" title="var">idmap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="var">pr1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">pr2</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (@<span class="id" title="var">isequiv_compose</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">equiv_sigma_prod0</span> <span class="id" title="var">Unit</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">snd</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">equiv_isequiv</span> (<span class="id" title="var">prod_unit_l</span> <span class="id" title="var">B</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">ImpliesLex</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1225"></a><h2 class="section">Lex reflective subuniverses</h2>

<div class="paragraph"> </div>

 A reflective subuniverse that preserves fibers is in fact a modality (and hence lex). 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ismodality_isequiv_O_functor_hfiber</span> (<span class="id" title="var">O</span> : <span class="id" title="var">ReflectiveSubuniverse</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span> : <span class="id" title="keyword">forall</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">B</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IsEquiv</span> (<span class="id" title="var">O_functor_hfiber</span> <span class="id" title="var">O</span> <span class="id" title="var">f</span> <span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsModality</span> <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A'</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">reflectsD_from_inO_sigma</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">B</span> <span class="id" title="var">B_inO</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">A</span> := <span class="id" title="var">O</span> <span class="id" title="var">A'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">g</span> := <span class="id" title="var">O_rec</span> <span class="id" title="var">pr1</span> : <span class="id" title="var">O</span> {<span class="id" title="var">x</span> : <span class="id" title="var">A</span> &amp; <span class="id" title="var">B</span> <span class="id" title="var">x</span>} -&gt; <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">transparent</span> <span class="id" title="tactic">assert</span> (<span class="id" title="var">p</span> : (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">g</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span>.1)).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">g</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">O_rec_beta</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">inO_isequiv_to_O</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">isequiv_contr_map</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">snrefine</span> (<span class="id" title="var">contr_equiv'</span> <span class="id" title="var">_</span> (<span class="id" title="var">hfiber_hfiber_compose_map</span> <span class="id" title="var">_</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">contr_map_isequiv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hfiber_compose_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">transparent</span> <span class="id" title="tactic">assert</span> (<span class="id" title="var">h</span> : (<span class="id" title="var">hfiber</span> (@<span class="id" title="var">pr1</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) &lt;~&gt; <span class="id" title="var">hfiber</span> <span class="id" title="var">g</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>))).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_to_O</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">O_functor_hfiber</span> <span class="id" title="var">O</span> (@<span class="id" title="var">pr1</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">hfiber</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_functor_sigma_id</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> <span class="id" title="var">oE</span> (<span class="id" title="var">equiv_moveR_equiv_V</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_concat_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_equiv_V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">g</span>, <span class="id" title="var">O_functor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">O_indpaths</span>; <span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">q</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">_</span> @ (<span class="id" title="var">O_rec_beta</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ap</span>, <span class="id" title="var">O_rec_beta</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isequiv_homotopic</span> (<span class="id" title="var">h</span> <span class="id" title="var">oE</span> <span class="id" title="var">equiv_hfiber_homotopic</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [[<span class="id" title="var">a</span> <span class="id" title="var">b</span>] <span class="id" title="var">q</span>]; <span class="id" title="var">cbn</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">O_functor_hfiber</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">O_rec_beta</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">functor_sigma</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">path_sigma'</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">O_indpaths_beta</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">moveL_equiv_V</span>, <span class="id" title="var">moveR_equiv_V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">long_path_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Opaque</span> <span class="id" title="var">eissect</span>. <span class="comment">(*&nbsp;work&nbsp;around&nbsp;bug&nbsp;4533&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Even&nbsp;though&nbsp;https://github.com/coq/coq/issues/4533&nbsp;is&nbsp;closed,&nbsp;this&nbsp;is&nbsp;still&nbsp;needed.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">ap_pp</span>, !<span class="id" title="var">concat_p_pp</span>, !<span class="id" title="var">ap_V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">to_O_natural</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pV_p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_V</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_Vp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- !(<span class="id" title="var">ap_compose</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>)^-1).<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> @<span class="id" title="var">concat_A1p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Transparent</span> <span class="id" title="var">eissect</span>. <span class="comment">(*&nbsp;work&nbsp;around&nbsp;bug&nbsp;4533&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">long_path_scope</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1226"></a><h2 class="section">Lexness via generators</h2>

<div class="paragraph"> </div>

 Here the characterization of when an accessible presentation yields a lex modality from Anel-Biederman-Finster-Joyal ("Higher Sheaves and Left-Exact Localizations of -Topoi", arXiv:2101.02791): it's enough for path spaces of the generators to be connected. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_gen</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">O</span> : <span class="id" title="var">Modality</span>) `{<span class="id" title="var">IsAccModality</span> <span class="id" title="var">O</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lexgen</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">i</span> : <span class="id" title="var">ngen_indices</span> (<span class="id" title="var">acc_ngen</span> <span class="id" title="var">O</span>)) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">ngen_type</span> (<span class="id" title="var">acc_ngen</span> <span class="id" title="var">O</span>) <span class="id" title="var">i</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IsConnected</span> <span class="id" title="var">O</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;: <span class="id" title="var">Lex</span> <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">srapply</span> <span class="id" title="var">lex_from_inO_typeO</span>; [ <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> | <span class="id" title="tactic">intros</span> <span class="id" title="var">i</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">ooextendable_TypeO_from_extension</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>; <span class="id" title="var">srefine</span> (<span class="id" title="var">_</span>;<span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;1:<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">exists</span> (<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>); <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">wc</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>, <span class="id" title="var">P</span> <span class="id" title="var">y</span> &lt;~&gt; <span class="id" title="var">P</span> <span class="id" title="var">z</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>.<br/>
</div>

<div class="doc">
Here we use the hypothesis <span class="inlinecode"><span class="id" title="var">lexgen</span></span> (typeclass inference finds it automatically). 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">pr1</span> (<span class="id" title="var">isconnected_elim</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (@<span class="id" title="var">equiv_transport</span> <span class="id" title="var">_</span> <span class="id" title="var">P</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>))). }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_TypeO</span>, <span class="id" title="var">path_universe_uncurried</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_adjointify</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">u</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">wc</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ((<span class="id" title="var">wc</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>)^-1 <span class="id" title="var">u</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">u</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">eisretr</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_forall</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_equiv_M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">isconnected_elim</span> <span class="id" title="var">O</span> <span class="id" title="var">_</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> =&gt; (<span class="id" title="var">wc</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)^-1 (<span class="id" title="var">f</span> <span class="id" title="var">y</span>))) <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> <span class="id" title="var">p</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">p</span> <span class="id" title="var">x</span> @ (<span class="id" title="var">p</span> <span class="id" title="var">y</span>)^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1227"></a><h2 class="section">n-fold separation</h2>

<div class="paragraph"> </div>

 A type is <span class="inlinecode"><span class="id" title="var">n</span></span>-<span class="inlinecode"><span class="id" title="var">O</span></span>-separated, for n &gt;= -2, if all its (n+2)-fold iterated identity types are <span class="inlinecode"><span class="id" title="var">O</span></span>-modal.  Inductively, this means that it is (-2)-O-separated if it is O-modal, and (n+1)-O-separated if its identity types are n-O-separated. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">nSep</span> (<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>) (<span class="id" title="var">O</span> : <span class="id" title="var">Subuniverse</span>) : <span class="id" title="var">Subuniverse</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| -2 =&gt; <span class="id" title="var">O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">n</span>.+1 =&gt; <span class="id" title="var">Sep</span> (<span class="id" title="var">nSep</span> <span class="id" title="var">n</span> <span class="id" title="var">O</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The reason for indexing this notion by a <span class="inlinecode"><span class="id" title="var">trunc_index</span></span> rather than a <span class="inlinecode"><span class="id" title="var">nat</span></span> is that when O is lex, a type is n-O-separated if and only if its O-unit is an n-truncated map. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">nsep_iff_trunc_to_O</span> (<span class="id" title="var">n</span> : <span class="id" title="var">trunc_index</span>) (<span class="id" title="var">O</span> : <span class="id" title="var">Modality</span>) `{<span class="id" title="var">Lex</span> <span class="id" title="var">O</span>} (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">In</span> (<span class="id" title="var">nSep</span> <span class="id" title="var">n</span> <span class="id" title="var">O</span>) <span class="id" title="var">A</span> &lt;-&gt; <span class="id" title="var">IsTruncMap</span> <span class="id" title="var">n</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">revert</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>]; <span class="id" title="tactic">intros</span> <span class="id" title="var">A</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">intros</span> ?.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">contr_map_isequiv</span>; <span class="id" title="var">rapply</span> <span class="id" title="var">isequiv_to_O_inO</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> (<span class="id" title="var">inO_equiv_inO</span> (<span class="id" title="var">O</span> <span class="id" title="var">A</span>) (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>)^-1).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">istruncmap_from_ap</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">i</span> := <span class="id" title="var">fst</span> (<span class="id" title="var">IHn</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istruncmap_mapinO_tr</span>, (<span class="id" title="var">mapinO_homotopic</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">equiv_path_O_to_O</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">IHn</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">i</span> := <span class="id" title="var">istruncmap_ap</span> <span class="id" title="var">n</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">mapinO_tr_istruncmap</span> <span class="id" title="tactic">in</span> <span class="id" title="var">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istruncmap_mapinO_tr</span>, (<span class="id" title="var">mapinO_homotopic</span> <span class="id" title="var">_</span> ((<span class="id" title="var">equiv_path_O</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)^-1 <span class="id" title="var">o</span> (@<span class="id" title="var">ap</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">to</span> <span class="id" title="var">O</span> <span class="id" title="var">A</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_equiv_V</span>; <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_O_to_O</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">mapinO_isequiv</span>. <span class="comment">(*&nbsp;This&nbsp;speeds&nbsp;up&nbsp;the&nbsp;next&nbsp;line.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rapply</span> <span class="id" title="var">mapinO_compose</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>