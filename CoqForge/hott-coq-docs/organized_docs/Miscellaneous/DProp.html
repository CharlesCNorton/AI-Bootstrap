<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>DProp</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library DProp</h1>

<div class="code">
</div>

<div class="doc">
<a id="lab1780"></a><h1 class="section">Decidable propositions</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">HoTT.Basics</span> <span class="id" title="var">HoTT.Types</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">TruncType</span> <span class="id" title="var">HProp</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Truncations.Core</span> <span class="id" title="var">Modalities.ReflectiveSubuniverse</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">path_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1781"></a><h2 class="section">Definitions</h2>

<div class="paragraph"> </div>

 A decidable proposition is, morally speaking, an HProp that is decidable.  However, we only require that it be an HProp under the additional assumption of <span class="inlinecode"><span class="id" title="var">Funext</span></span>; this enables decidable propositions to usually be used without <span class="inlinecode"><span class="id" title="var">Funext</span></span> hypotheses. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">DProp</span> := {<br/>
&nbsp;&nbsp;<span class="id" title="var">dprop_type</span> : <span class="id" title="keyword">Type</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">ishprop_dprop</span> : <span class="id" title="var">Funext</span> -&gt; <span class="id" title="var">IsHProp</span> <span class="id" title="var">dprop_type</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">dec_dprop</span> : <span class="id" title="var">Decidable</span> <span class="id" title="var">dprop_type</span><br/>
}.<br/>

<br/>
</div>

<div class="doc">
A fancier definition, which would have the property that negation is judgmentally involutive, would be

<div class="paragraph"> </div>

<pre>
Record DProp :=
  { dprop_holds : Type ;
    ishprop_holds : Funext -&gt; IsHProp dprop_holds ;
    dprop_denies : Type ;
    ishprop_denies : Funext -&gt; IsHProp dprop_denies ;
    holds_or_denies : dprop_holds + dprop_denies ;
    denies_or_holds : dprop_denies + dprop_holds ;
    not_holds_and_denies : dprop_holds -&gt; dprop_denies -&gt; Empty
  }.
</pre>

<div class="paragraph"> </div>

At some point we may want to go that route, but it would be more work.  In particualar, <span class="inlinecode"><span class="id" title="keyword">Instance</span></span>s of <span class="inlinecode"><span class="id" title="var">Decidable</span></span> wouldn't be automatically computed for us, and the characterization of the homotopy type of <span class="inlinecode"><span class="id" title="var">DProp</span></span> itself would be a lot harder. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">dprop_type</span> : <span class="id" title="var">DProp</span> &gt;-&gt; <span class="id" title="var">Sortclass</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">ishprop_dprop</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">dec_dprop</span>.<br/>

<br/>
</div>

<div class="doc">
Sometimes, however, we have decidable props that are hprops without funext, and we want to remember that. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">DHProp</span> :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">dhprop_hprop</span> : <span class="id" title="var">HProp</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dec_dhprop</span> : <span class="id" title="var">Decidable</span> <span class="id" title="var">dhprop_hprop</span><br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">dhprop_hprop</span> : <span class="id" title="var">DHProp</span> &gt;-&gt; <span class="id" title="var">HProp</span>.<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">dec_dhprop</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dhprop_to_dprop</span> : <span class="id" title="var">DHProp</span> -&gt; <span class="id" title="var">DProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">P</span> =&gt; <span class="id" title="var">Build_DProp</span> <span class="id" title="var">P</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">_</span>) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">dhprop_to_dprop</span> : <span class="id" title="var">DHProp</span> &gt;-&gt; <span class="id" title="var">DProp</span>.<br/>

<br/>
</div>

<div class="doc">
In particular, <span class="inlinecode"><span class="id" title="var">True</span></span> and <span class="inlinecode"><span class="id" title="var">False</span></span> are always hprops. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">True</span> : <span class="id" title="var">DHProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DHProp</span> <span class="id" title="var">Unit_hp</span> (<span class="id" title="var">inl</span> <span class="id" title="var">tt</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">False</span> : <span class="id" title="var">DHProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DHProp</span> <span class="id" title="var">False_hp</span> (<span class="id" title="var">inr</span> <span class="id" title="var">idmap</span>).<br/>

<br/>
</div>

<div class="doc">
Decidable props can be coerced to <span class="inlinecode"><span class="id" title="var">Bool</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dprop_to_bool</span> (<span class="id" title="var">P</span> : <span class="id" title="var">DProp</span>) : <span class="id" title="var">Bool</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">if</span> <span class="id" title="var">dec</span> <span class="id" title="var">P</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">dprop_to_bool</span> : <span class="id" title="var">DProp</span> &gt;-&gt; <span class="id" title="var">Bool</span>.<br/>

<br/>
</div>

<div class="doc">
And back again, but we don't declare that as a coercion. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">bool_to_dhprop</span> (<span class="id" title="var">b</span> : <span class="id" title="var">Bool</span>) : <span class="id" title="var">DHProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">True</span> <span class="id" title="keyword">else</span> <span class="id" title="var">False</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1782"></a><h2 class="section">The type of decidable props</h2>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issig_dprop</span><br/>
&nbsp;&nbsp;: { <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span> &amp; { <span class="id" title="var">_</span> : <span class="id" title="var">Funext</span> -&gt; <span class="id" title="var">IsHProp</span> <span class="id" title="var">X</span> &amp; <span class="id" title="var">Decidable</span> <span class="id" title="var">X</span> } } &lt;~&gt; <span class="id" title="var">DProp</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">issig</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_dprop</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DProp</span>)<br/>
: (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="keyword">Type</span>) &lt;~&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">DProp</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">P</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">P</span> <span class="id" title="var">hP</span> <span class="id" title="var">dP</span>]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Q</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Q</span> <span class="id" title="var">hQ</span> <span class="id" title="var">dQ</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (((<span class="id" title="var">equiv_ap'</span> <span class="id" title="var">issig_dprop</span>^-1 <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">equiv_ap'</span> (<span class="id" title="var">equiv_sigma_assoc'</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="id" title="var">P</span>;<span class="id" title="var">hP</span>);<span class="id" title="var">dP</span>) ((<span class="id" title="var">Q</span>;<span class="id" title="var">hQ</span>);<span class="id" title="var">dQ</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_path_sigma_hprop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">oE</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> [<span class="id" title="var">X</span> <span class="id" title="var">hX</span>]; <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">equiv_path_sigma_hprop</span> (<span class="id" title="var">P</span>;<span class="id" title="var">hP</span>) (<span class="id" title="var">Q</span>;<span class="id" title="var">hQ</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_dprop</span> `{<span class="id" title="var">Funext</span>} {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DProp</span>}<br/>
: (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="keyword">Type</span>) -&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">DProp</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">equiv_path_dprop</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">issig_dhprop</span><br/>
&nbsp;&nbsp;: { <span class="id" title="var">X</span> : <span class="id" title="var">HProp</span> &amp; <span class="id" title="var">Decidable</span> <span class="id" title="var">X</span> } &lt;~&gt; <span class="id" title="var">DHProp</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">issig</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_dhprop'</span> `{<span class="id" title="var">Funext</span>} (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>)<br/>
: (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">HProp</span>) &lt;~&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">DHProp</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">P</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">P</span> <span class="id" title="var">dP</span>]. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Q</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Q</span> <span class="id" title="var">dQ</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (((<span class="id" title="var">equiv_ap'</span> <span class="id" title="var">issig_dhprop</span>^-1 <span class="id" title="var">_</span> <span class="id" title="var">_</span>)^-1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">oE</span> <span class="id" title="var">_</span>); <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> ((<span class="id" title="var">equiv_path_sigma_hprop</span> (<span class="id" title="var">P</span>; <span class="id" title="var">dP</span>) (<span class="id" title="var">Q</span>; <span class="id" title="var">dQ</span>))).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_path_dhprop</span> `{<span class="id" title="var">Univalence</span>} (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>)<br/>
: (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="keyword">Type</span>) &lt;~&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">DHProp</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">eq_type_hprop</span> : (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="keyword">Type</span>) &lt;~&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">HProp</span>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_trunctype'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">eq_hprop_dhprop</span> : (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">HProp</span>) &lt;~&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">DHProp</span>)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_path_dhprop'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">eq_hprop_dhprop</span> <span class="id" title="var">oE</span> <span class="id" title="var">eq_type_hprop</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_dhprop</span> `{<span class="id" title="var">Univalence</span>} {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>}<br/>
: (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="keyword">Type</span>) -&gt; (<span class="id" title="var">P</span> = <span class="id" title="var">Q</span> :&gt; <span class="id" title="var">DHProp</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">equiv_path_dhprop</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">ishset_dprop</span> `{<span class="id" title="var">Univalence</span>} : <span class="id" title="var">IsHSet</span> <span class="id" title="var">DProp</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">istrunc_S</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">istrunc_equiv_istrunc</span> <span class="id" title="var">_</span> (<span class="id" title="var">n</span> := -1) (<span class="id" title="var">equiv_path_dprop</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isequiv_dprop_to_bool</span> `{<span class="id" title="var">Univalence</span>}<br/>
: <span class="id" title="var">IsEquiv</span> <span class="id" title="var">dprop_to_bool</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">isequiv_adjointify</span> <span class="id" title="var">dprop_to_bool</span> <span class="id" title="var">bool_to_dhprop</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> []; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">dprop_to_bool</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> <span class="id" title="var">P</span>); <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">path_dprop</span>, <span class="id" title="var">path_universe_uncurried</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">if_hprop_then_equiv_Unit</span>; [ <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> | <span class="id" title="tactic">assumption</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">if_not_hprop_then_equiv_Empty</span>; [ <span class="id" title="tactic">exact</span> <span class="id" title="var">_</span> | <span class="id" title="tactic">assumption</span> ].<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_dprop_to_bool</span> `{<span class="id" title="var">Univalence</span>}<br/>
: <span class="id" title="var">DProp</span> &lt;~&gt; <span class="id" title="var">Bool</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_Equiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dprop_to_bool</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1783"></a><h2 class="section">Operations</h2>

<div class="paragraph"> </div>

 We define the logical operations on decidable hprops to be the operations on ordinary hprops, with decidability carrying over.  For the operations which preserve hprops without funext, we define separate versions that act on <span class="inlinecode"><span class="id" title="var">DHProp</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dand</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">DProp</span>) : <span class="id" title="var">DProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DProp</span> (<span class="id" title="var">b1</span> * <span class="id" title="var">b2</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dhand</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">DHProp</span>) : <span class="id" title="var">DHProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DHProp</span> (<span class="id" title="var">Build_HProp</span> (<span class="id" title="var">b1</span> * <span class="id" title="var">b2</span>)) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dor</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">DProp</span>) : <span class="id" title="var">DProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DProp</span> (<span class="id" title="var">hor</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dhor</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">DHProp</span>) : <span class="id" title="var">DHProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DHProp</span> (<span class="id" title="var">Build_HProp</span> (<span class="id" title="var">hor</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>)) <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dneg</span> (<span class="id" title="var">b</span> : <span class="id" title="var">DProp</span>) : <span class="id" title="var">DProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DProp</span> (~<span class="id" title="var">b</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dimpl</span> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <span class="id" title="var">DProp</span>) : <span class="id" title="var">DProp</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">Build_DProp</span> (<span class="id" title="var">b1</span> -&gt; <span class="id" title="var">b2</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Declare Scope</span> <span class="id" title="var">dprop_scope</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">dprop_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dprop</span>.<br/>
<span class="id" title="keyword">Bind Scope</span> <span class="id" title="var">dprop_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">DProp</span>.<br/>
<span class="id" title="keyword">Declare Scope</span> <span class="id" title="var">dhprop_scope</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">dhprop_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Bind Scope</span> <span class="id" title="var">dhprop_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">DHProp</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;&amp;&amp;" := <span class="id" title="var">dand</span> : <span class="id" title="var">dprop_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;&amp;&amp;" := <span class="id" title="var">dhand</span> : <span class="id" title="var">dhprop_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;||" := <span class="id" title="var">dor</span> : <span class="id" title="var">dprop_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;||" := <span class="id" title="var">dhor</span> : <span class="id" title="var">dhprop_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;-&gt;" := <span class="id" title="var">dimpl</span> : <span class="id" title="var">dprop_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;!! P" := (<span class="id" title="var">dneg</span> <span class="id" title="var">P</span>) : <span class="id" title="var">dprop_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">dprop_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab1784"></a><h2 class="section">Computation</h2>

<div class="paragraph"> </div>

 In order to be able to "compute" with <span class="inlinecode"><span class="id" title="var">DProp</span></span>s like booleans, we define a couple of typeclasses. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> : <span class="id" title="var">DProp</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dprop_istrue</span> : <span class="id" title="var">P</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> : <span class="id" title="var">DProp</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dprop_isfalse</span> : ~ <span class="id" title="var">P</span>.<br/>

<br/>
</div>

<div class="doc">
Note that we are not using <span class="inlinecode"><span class="id" title="keyword">Typeclasses</span></span> <span class="inlinecode"><span class="id" title="keyword">Strict</span></span> <span class="inlinecode"><span class="id" title="var">Resolution</span></span> for <span class="inlinecode"><span class="id" title="var">IsTrue</span></span> and <span class="inlinecode"><span class="id" title="var">IsFalse</span></span>; this enables us to write simply <span class="inlinecode"><span class="id" title="var">dprop_istrue</span></span> as a proof of some true dprop, and Coq will infer from context what the dprop is that we're proving. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">true_istrue</span> : <span class="id" title="var">IsTrue</span> <span class="id" title="var">True</span> := <span class="id" title="var">tt</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">false_isfalse</span> : <span class="id" title="var">IsFalse</span> <span class="id" title="var">False</span> := <span class="id" title="var">idmap</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dand_true_true</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">P</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> &amp;&amp; <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_istrue</span>, <span class="id" title="var">dprop_istrue</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dand_false_l</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> &amp;&amp; <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dand_false_r</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> &amp;&amp; <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dhand_true_true</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">P</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> &amp;&amp; <span class="id" title="var">Q</span>)%<span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
</div>

<div class="doc">
We have to give <span class="inlinecode"><span class="id" title="var">P</span></span> as an explicit argument here.  This is apparently because with two <span class="inlinecode"><span class="id" title="var">IsTrue</span></span> instances in the context, when we write simply <span class="inlinecode"><span class="id" title="var">dprop_istrue</span></span>, Coq guesses one of them during typeclass resolution, and isn't willing to backtrack once it realizes that that choice fails to be what's needed to solve the goal.  Coq currently seems to consistently guess <span class="inlinecode"><span class="id" title="var">Q</span></span> rather than <span class="inlinecode"><span class="id" title="var">P</span></span>, so that we don't have to give the argument <span class="inlinecode"><span class="id" title="var">Q</span></span> to the second call to <span class="inlinecode"><span class="id" title="var">dprop_istrue</span></span>; but rather than depend on such behavior, we give both arguments explicitly.  (The problem doesn't arise with <span class="inlinecode"><span class="id" title="var">dand_true_true</span></span> because in that case, unification, which fires before typeclass search, is able to guess that the argument must be <span class="inlinecode"><span class="id" title="var">P</span></span>.) 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (@<span class="id" title="var">dprop_istrue</span> <span class="id" title="var">P</span> <span class="id" title="var">_</span>, @<span class="id" title="var">dprop_istrue</span> <span class="id" title="var">Q</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dhand_false_l</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> &amp;&amp; <span class="id" title="var">Q</span>)%<span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dhand_false_r</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> &amp;&amp; <span class="id" title="var">Q</span>)%<span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dor_true_l</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> || <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">tr</span> (<span class="id" title="var">inl</span> <span class="id" title="var">Q</span> <span class="id" title="var">dprop_istrue</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dor_true_r</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> || <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">tr</span> (<span class="id" title="var">inr</span> <span class="id" title="var">P</span> <span class="id" title="var">dprop_istrue</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dor_false_false</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">P</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> || <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">pq</span>. <span class="id" title="var">strip_truncations</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">pq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span>|<span class="id" title="var">q</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dhor_true_l</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> || <span class="id" title="var">Q</span>)%<span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">tr</span> (<span class="id" title="var">inl</span> <span class="id" title="var">Q</span> <span class="id" title="var">dprop_istrue</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dhor_true_r</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> || <span class="id" title="var">Q</span>)%<span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">tr</span> (<span class="id" title="var">inr</span> <span class="id" title="var">P</span> <span class="id" title="var">dprop_istrue</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dhor_false_false</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">DHProp</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">P</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> || <span class="id" title="var">Q</span>)%<span class="id" title="var">dhprop</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">pq</span>. <span class="id" title="var">strip_truncations</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">pq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">p</span>|<span class="id" title="var">q</span>].<br/>
</div>

<div class="doc">
See comment in the proof of <span class="inlinecode"><span class="id" title="var">dhand_true_true</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (@<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">P</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (@<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">Q</span> <span class="id" title="var">_</span> <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dneg_true</span> {<span class="id" title="var">P</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsFalse</span> (!! <span class="id" title="var">P</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">np</span>; <span class="id" title="tactic">exact</span> (<span class="id" title="var">np</span> <span class="id" title="var">dprop_istrue</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dneg_false</span> {<span class="id" title="var">P</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsTrue</span> (!! <span class="id" title="var">P</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">dprop_isfalse</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dimpl_true_r</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> -&gt; <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">dprop_istrue</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dimpl_false_l</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">P</span>}<br/>
: <span class="id" title="var">IsTrue</span> (<span class="id" title="var">P</span> -&gt; <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">elim</span> (<span class="id" title="var">dprop_isfalse</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">dimpl_true_false</span> {<span class="id" title="var">P</span> <span class="id" title="var">Q</span>} `{<span class="id" title="var">IsTrue</span> <span class="id" title="var">P</span>} `{<span class="id" title="var">IsFalse</span> <span class="id" title="var">Q</span>}<br/>
: <span class="id" title="var">IsFalse</span> (<span class="id" title="var">P</span> -&gt; <span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">dprop_isfalse</span> (<span class="id" title="var">f</span> <span class="id" title="var">dprop_istrue</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">path_dec</span> (<span class="id" title="var">A</span> :<span class="id" title="keyword">Type</span>) `{<span class="id" title="var">IsHProp</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">Decidable</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">Univalence</span>} : <span class="id" title="var">A</span> = <span class="id" title="var">is_inl</span> (<span class="id" title="var">dec</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">path_universe_uncurried</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">equiv_iff_hprop_uncurried</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> <span class="id" title="var">A</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">dec</span> <span class="id" title="var">A</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [].<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>